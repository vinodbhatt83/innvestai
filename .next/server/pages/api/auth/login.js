"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/login";
exports.ids = ["pages/api/auth/login"];
exports.modules = {

/***/ "(api-node)/./lib/auth.js":
/*!*********************!*\
  !*** ./lib/auth.js ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   accountManager: () => (/* binding */ accountManager),\n/* harmony export */   auth: () => (/* binding */ auth),\n/* harmony export */   clientAccountManager: () => (/* binding */ clientAccountManager),\n/* harmony export */   clientAuth: () => (/* binding */ clientAuth)\n/* harmony export */ });\n// lib/auth.js\n// Declare variables to hold modules\nlet bcrypt;\nlet uuidv4;\nlet queryFn;\nlet poolObj;\n// Only initialize on the server\nif (true) {\n    try {\n        // Server-side imports\n        bcrypt = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n        const { v4 } = __webpack_require__(/*! uuid */ \"uuid\");\n        uuidv4 = v4;\n        // Import database functions - using dynamic import to avoid webpack issues\n        const dbModule = __webpack_require__(/*! ./db.js */ \"(api-node)/./lib/db.js\");\n        queryFn = dbModule.query;\n        poolObj = dbModule.pool;\n    } catch (error) {\n        console.error('Error initializing auth module:', error);\n        // Provide fallbacks if imports fail\n        bcrypt = {\n            hash: async ()=>'hash-function-not-available',\n            compare: async ()=>false\n        };\n        uuidv4 = ()=>'uuid-function-not-available';\n        queryFn = async ()=>{\n            throw new Error('Database query function not available');\n        };\n        poolObj = {\n            query: async ()=>{\n                throw new Error('Database pool not available');\n            }\n        };\n    }\n} else {}\n// Simple session-based authentication\nconst auth = {\n    // Create a hashed password\n    async hashPassword (password) {\n        // Can run on client or server, but only does real work on server\n        if (false) {}\n        return await bcrypt.hash(password, 10);\n    },\n    // Compare password with hash\n    async comparePassword (password, hash) {\n        // Can run on client or server, but only does real work on server\n        if (false) {}\n        return await bcrypt.compare(password, hash);\n    },\n    // Find user by email - server only\n    async findUserByEmail (email) {\n        // Ensure we're running on the server\n        if (false) {}\n        try {\n            const result = await queryFn(`SELECT u.*, a.account_name, a.is_active as account_is_active, r.role_name \n         FROM users u\n         JOIN accounts a ON u.account_id = a.account_id\n         JOIN roles r ON u.role_id = r.role_id\n         WHERE u.email = $1`, [\n                email\n            ]);\n            return result.rows[0] || null;\n        } catch (error) {\n            console.error('Error finding user by email:', error);\n            throw error;\n        }\n    },\n    // Find user by ID - server only\n    async findUserById (userId) {\n        // Ensure we're running on the server\n        if (false) {}\n        try {\n            const result = await queryFn(`SELECT u.*, a.account_name, a.is_active as account_is_active, r.role_name, r.permissions\n         FROM users u\n         JOIN accounts a ON u.account_id = a.account_id\n         JOIN roles r ON u.role_id = r.role_id\n         WHERE u.user_id = $1`, [\n                userId\n            ]);\n            return result.rows[0] || null;\n        } catch (error) {\n            console.error('Error finding user by ID:', error);\n            throw error;\n        }\n    },\n    // Create a new session - server only\n    async createSession (userId) {\n        // Ensure we're running on the server\n        if (false) {}\n        const sessionToken = uuidv4();\n        const expiresAt = new Date();\n        expiresAt.setDate(expiresAt.getDate() + 7); // 7 days expiration\n        try {\n            await queryFn('INSERT INTO sessions (user_id, session_token, expires_at) VALUES ($1, $2, $3)', [\n                userId,\n                sessionToken,\n                expiresAt\n            ]);\n            return sessionToken;\n        } catch (error) {\n            console.error('Error creating session:', error);\n            throw error;\n        }\n    },\n    // Verify a session token - server only\n    async verifySession (sessionToken) {\n        // Ensure we're running on the server\n        if (false) {}\n        console.log('verifySession called with token', {\n            tokenLength: sessionToken ? sessionToken.length : 0,\n            tokenPrefix: sessionToken ? sessionToken.substring(0, 8) + '...' : 'none'\n        });\n        try {\n            const result = await queryFn(`SELECT u.*, s.session_id, s.expires_at, a.account_name, a.is_active as account_is_active, r.role_name, r.permissions\n         FROM sessions s\n         JOIN users u ON s.user_id = u.user_id\n         JOIN accounts a ON u.account_id = a.account_id\n         JOIN roles r ON u.role_id = r.role_id\n         WHERE s.session_token = $1 AND s.expires_at > NOW()`, [\n                sessionToken\n            ]);\n            console.log('verifySession query result', {\n                found: result.rowCount > 0,\n                userData: result.rowCount > 0 ? {\n                    user_id: result.rows[0].user_id,\n                    email: result.rows[0].email,\n                    account_id: result.rows[0].account_id,\n                    is_account_admin: result.rows[0].is_account_admin,\n                    account_name: result.rows[0].account_name,\n                    role_name: result.rows[0].role_name\n                } : null\n            });\n            // Add standard property names for consistency\n            if (result.rowCount > 0) {\n                const user = result.rows[0];\n                // Map database field names to the camelCase format expected by frontend\n                user.id = user.user_id;\n                user.firstName = user.first_name;\n                user.lastName = user.last_name;\n                user.accountId = user.account_id;\n                user.isAdmin = user.is_account_admin;\n                user.accountName = user.account_name;\n            }\n            return result.rows[0] || null;\n        } catch (error) {\n            console.error('Error verifying session:', error);\n            throw error;\n        }\n    },\n    // Invalidate a session - server only\n    async invalidateSession (sessionToken) {\n        // Ensure we're running on the server\n        if (false) {}\n        try {\n            await queryFn('DELETE FROM sessions WHERE session_token = $1', [\n                sessionToken\n            ]);\n            return true;\n        } catch (error) {\n            console.error('Error invalidating session:', error);\n            throw error;\n        }\n    },\n    // Create a password reset token - server only\n    async createPasswordResetToken (userId) {\n        // Ensure we're running on the server\n        if (false) {}\n        const token = uuidv4();\n        const expiresAt = new Date();\n        expiresAt.setHours(expiresAt.getHours() + 24); // 24 hours expiration\n        try {\n            await queryFn('INSERT INTO password_reset_tokens (user_id, token, expires_at) VALUES ($1, $2, $3)', [\n                userId,\n                token,\n                expiresAt\n            ]);\n            return token;\n        } catch (error) {\n            console.error('Error creating password reset token:', error);\n            throw error;\n        }\n    },\n    // Verify a password reset token - server only\n    async verifyResetToken (token) {\n        // Ensure we're running on the server\n        if (false) {}\n        try {\n            const result = await queryFn('SELECT * FROM password_reset_tokens WHERE token = $1 AND expires_at > NOW()', [\n                token\n            ]);\n            return result.rows[0] || null;\n        } catch (error) {\n            console.error('Error verifying reset token:', error);\n            throw error;\n        }\n    },\n    // Reset password - server only\n    async resetPassword (token, newPassword) {\n        // Ensure we're running on the server\n        if (false) {}\n        try {\n            const tokenRecord = await this.verifyResetToken(token);\n            if (!tokenRecord) {\n                return {\n                    success: false,\n                    error: 'Invalid or expired token'\n                };\n            }\n            const passwordHash = await this.hashPassword(newPassword);\n            // Update password\n            await queryFn('UPDATE users SET password_hash = $1, updated_at = NOW() WHERE user_id = $2', [\n                passwordHash,\n                tokenRecord.user_id\n            ]);\n            // Delete the token\n            await queryFn('DELETE FROM password_reset_tokens WHERE token_id = $1', [\n                tokenRecord.token_id\n            ]);\n            return {\n                success: true\n            };\n        } catch (error) {\n            console.error('Error resetting password:', error);\n            throw error;\n        }\n    }\n};\n// Account management - all methods are server-only\nconst accountManager = {\n    // Create a new account with admin user\n    async createAccount (accountData, userData) {\n        // Ensure we're running on the server\n        if (false) {}\n        try {\n            // Start a transaction\n            await queryFn('BEGIN');\n            // Create account\n            const accountResult = await queryFn('INSERT INTO accounts (account_name, account_domain, plan_id, billing_email) VALUES ($1, $2, $3, $4) RETURNING *', [\n                accountData.accountName,\n                accountData.accountDomain || null,\n                accountData.planId || 1,\n                accountData.billingEmail\n            ]);\n            const account = accountResult.rows[0];\n            // Hash password\n            const passwordHash = await auth.hashPassword(userData.password);\n            // Create admin user (role_id 1 = Admin)\n            const userResult = await queryFn(`INSERT INTO users (account_id, email, password_hash, first_name, last_name, role_id, is_account_admin) \n         VALUES ($1, $2, $3, $4, $5, 1, TRUE) RETURNING *`, [\n                account.account_id,\n                userData.email,\n                passwordHash,\n                userData.firstName,\n                userData.lastName\n            ]);\n            const admin = userResult.rows[0];\n            // Commit transaction\n            await queryFn('COMMIT');\n            return {\n                account,\n                admin\n            };\n        } catch (error) {\n            // Rollback transaction on error\n            await queryFn('ROLLBACK');\n            console.error('Error creating account:', error);\n            throw error;\n        }\n    }\n};\n// Create mock implementations for client-side use\nconst createMockAuth = ()=>{\n    const mockAuth = {\n        // Mock implementations that are safe to use on the client\n        async hashPassword (password) {\n            if (true) {\n                // When running on the server, use the real implementation\n                return auth.hashPassword(password);\n            }\n            // On client, just return a placeholder (real hashing happens server-side)\n            console.warn('hashPassword called on client, real hashing will happen server-side');\n            return `mock-hash-${password.length}`;\n        },\n        async comparePassword (password, hash) {\n            if (true) {\n                // When running on the server, use the real implementation\n                return auth.comparePassword(password, hash);\n            }\n            // On client, just return a placeholder (real comparison happens server-side)\n            console.warn('comparePassword called on client, real comparison will happen server-side');\n            return false;\n        },\n        // These methods should be called via API endpoints on the client\n        async findUserByEmail () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async findUserById () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async createSession () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async verifySession () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async invalidateSession () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async createPasswordResetToken () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async verifyResetToken () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async resetPassword () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        }\n    };\n    return mockAuth;\n};\n// Create a mock account manager for client-side use\nconst createMockAccountManager = ()=>{\n    const mockAccountManager = {\n        // All methods should be called via API endpoints on the client\n        async createAccount () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async getAccountUsers () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async createUser () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async updateUser () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        },\n        async updateAccount () {\n            throw new Error('This method should be called via an API endpoint on client-side');\n        }\n    };\n    return mockAccountManager;\n};\n// Export the appropriate implementations based on environment\nconst clientAuth =  false ? 0 : auth;\nconst clientAccountManager =  false ? 0 : accountManager;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUlQLE1BQU07UUFDbEI7UUFFQSxNQUFNVztZQUNKLE1BQU0sSUFBSVgsTUFBTTtRQUNsQjtRQUVBLE1BQU1hO1lBQ0osTUFBTSxJQUFJYixNQUFNO1FBQ2xCO1FBRUEsTUFBTW1CO1lBQ0osTUFBTSxJQUFJbkIsTUFBTTtRQUNsQjtRQUVBLE1BQU15QztZQUNKLE1BQU0sSUFBSXpDLE1BQU07UUFDbEI7UUFFQSxNQUFNMEM7WUFDSixNQUFNLElBQUkxQyxNQUFNO1FBQ2xCO1FBRUEsTUFBTThDO1lBQ0osTUFBTSxJQUFJOUMsTUFBTTtRQUNsQjtRQUVBLE1BQU0rQztZQUNKLE1BQU0sSUFBSS9DLE1BQU07UUFDbEI7SUFDRjtJQUVBLE9BQU9nRTtBQUNUO0FBRUEsb0RBQW9EO0FBQ3BELE1BQU1DLDJCQUEyQjtJQUMvQixNQUFNQyxxQkFBcUI7UUFDekIsK0RBQStEO1FBQy9ELE1BQU1aO1lBQ0osTUFBTSxJQUFJdEQsTUFBTTtRQUNsQjtRQUVBLE1BQU1tRTtZQUNKLE1BQU0sSUFBSW5FLE1BQU07UUFDbEI7UUFFQSxNQUFNb0U7WUFDSixNQUFNLElBQUlwRSxNQUFNO1FBQ2xCO1FBRUEsTUFBTXFFO1lBQ0osTUFBTSxJQUFJckUsTUFBTTtRQUNsQjtRQUVBLE1BQU1zRTtZQUNKLE1BQU0sSUFBSXRFLE1BQU07UUFDbEI7SUFDRjtJQUVBLE9BQU9rRTtBQUNUO0FBRUEsOERBQThEO0FBQ3ZELE1BQU1LLGFBQWEsTUFBNkIsR0FBR1IsQ0FBZ0JBLEdBQUc5RCxLQUFLO0FBQzNFLE1BQU11RSx1QkFBdUIsTUFBNkIsR0FBR1AsQ0FBMEJBLEdBQUdaLGVBQWUiLCJzb3VyY2VzIjpbIkM6XFx2aW5vZFxccHJvamVjdHNcXGlubnZlc3RcXFBPQ1xcaW5udmVzdGFpXFxsaWJcXGF1dGguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL2F1dGguanNcclxuXHJcbi8vIERlY2xhcmUgdmFyaWFibGVzIHRvIGhvbGQgbW9kdWxlc1xyXG5sZXQgYmNyeXB0O1xyXG5sZXQgdXVpZHY0O1xyXG5sZXQgcXVlcnlGbjtcclxubGV0IHBvb2xPYmo7XHJcblxyXG4vLyBPbmx5IGluaXRpYWxpemUgb24gdGhlIHNlcnZlclxyXG5pZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gU2VydmVyLXNpZGUgaW1wb3J0c1xyXG4gICAgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKTtcclxuICAgIGNvbnN0IHsgdjQgfSA9IHJlcXVpcmUoJ3V1aWQnKTtcclxuICAgIHV1aWR2NCA9IHY0O1xyXG4gICAgXHJcbiAgICAvLyBJbXBvcnQgZGF0YWJhc2UgZnVuY3Rpb25zIC0gdXNpbmcgZHluYW1pYyBpbXBvcnQgdG8gYXZvaWQgd2VicGFjayBpc3N1ZXNcclxuICAgIGNvbnN0IGRiTW9kdWxlID0gcmVxdWlyZSgnLi9kYi5qcycpO1xyXG4gICAgcXVlcnlGbiA9IGRiTW9kdWxlLnF1ZXJ5O1xyXG4gICAgcG9vbE9iaiA9IGRiTW9kdWxlLnBvb2w7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBhdXRoIG1vZHVsZTonLCBlcnJvcik7XHJcbiAgICBcclxuICAgIC8vIFByb3ZpZGUgZmFsbGJhY2tzIGlmIGltcG9ydHMgZmFpbFxyXG4gICAgYmNyeXB0ID0ge1xyXG4gICAgICBoYXNoOiBhc3luYyAoKSA9PiAnaGFzaC1mdW5jdGlvbi1ub3QtYXZhaWxhYmxlJyxcclxuICAgICAgY29tcGFyZTogYXN5bmMgKCkgPT4gZmFsc2VcclxuICAgIH07XHJcbiAgICB1dWlkdjQgPSAoKSA9PiAndXVpZC1mdW5jdGlvbi1ub3QtYXZhaWxhYmxlJztcclxuICAgIHF1ZXJ5Rm4gPSBhc3luYyAoKSA9PiB7IHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcXVlcnkgZnVuY3Rpb24gbm90IGF2YWlsYWJsZScpOyB9O1xyXG4gICAgcG9vbE9iaiA9IHsgcXVlcnk6IGFzeW5jICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBwb29sIG5vdCBhdmFpbGFibGUnKTsgfSB9O1xyXG4gIH1cclxufSBlbHNlIHtcclxuICAvLyBDbGllbnQtc2lkZSBzdHVic1xyXG4gIGJjcnlwdCA9IHtcclxuICAgIGhhc2g6IGFzeW5jICgpID0+ICdjbGllbnQtc2lkZS1zdHViLWhhc2gnLFxyXG4gICAgY29tcGFyZTogYXN5bmMgKCkgPT4gZmFsc2VcclxuICB9O1xyXG4gIHV1aWR2NCA9ICgpID0+ICdjbGllbnQtc2lkZS1zdHViLXV1aWQnO1xyXG4gIHF1ZXJ5Rm4gPSBhc3luYyAoKSA9PiB7IHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcXVlcmllcyBjYW5ub3QgYmUgZXhlY3V0ZWQgb24gdGhlIGNsaWVudCBzaWRlJyk7IH07XHJcbiAgcG9vbE9iaiA9IHsgcXVlcnk6IGFzeW5jICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBwb29sIGNhbm5vdCBiZSB1c2VkIG9uIHRoZSBjbGllbnQgc2lkZScpOyB9IH07XHJcbn1cclxuXHJcbi8vIFNpbXBsZSBzZXNzaW9uLWJhc2VkIGF1dGhlbnRpY2F0aW9uXHJcbmV4cG9ydCBjb25zdCBhdXRoID0ge1xyXG4gIC8vIENyZWF0ZSBhIGhhc2hlZCBwYXNzd29yZFxyXG4gIGFzeW5jIGhhc2hQYXNzd29yZChwYXNzd29yZCkge1xyXG4gICAgLy8gQ2FuIHJ1biBvbiBjbGllbnQgb3Igc2VydmVyLCBidXQgb25seSBkb2VzIHJlYWwgd29yayBvbiBzZXJ2ZXJcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ2hhc2hQYXNzd29yZCBjYWxsZWQgb24gY2xpZW50LCByZWFsIGhhc2hpbmcgd2lsbCBoYXBwZW4gc2VydmVyLXNpZGUnKTtcclxuICAgICAgcmV0dXJuIGBtb2NrLWhhc2gtJHtwYXNzd29yZC5sZW5ndGh9YDtcclxuICAgIH1cclxuICAgIHJldHVybiBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTApO1xyXG4gIH0sXHJcblxyXG4gIC8vIENvbXBhcmUgcGFzc3dvcmQgd2l0aCBoYXNoXHJcbiAgYXN5bmMgY29tcGFyZVBhc3N3b3JkKHBhc3N3b3JkLCBoYXNoKSB7XHJcbiAgICAvLyBDYW4gcnVuIG9uIGNsaWVudCBvciBzZXJ2ZXIsIGJ1dCBvbmx5IGRvZXMgcmVhbCB3b3JrIG9uIHNlcnZlclxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignY29tcGFyZVBhc3N3b3JkIGNhbGxlZCBvbiBjbGllbnQsIHJlYWwgY29tcGFyaXNvbiB3aWxsIGhhcHBlbiBzZXJ2ZXItc2lkZScpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIGhhc2gpO1xyXG4gIH0sXHJcblxyXG4gIC8vIEZpbmQgdXNlciBieSBlbWFpbCAtIHNlcnZlciBvbmx5XHJcbiAgYXN5bmMgZmluZFVzZXJCeUVtYWlsKGVtYWlsKSB7XHJcbiAgICAvLyBFbnN1cmUgd2UncmUgcnVubmluZyBvbiB0aGUgc2VydmVyXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBvbiB0aGUgc2VydmVyIHNpZGUnKTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeUZuKFxyXG4gICAgICAgIGBTRUxFQ1QgdS4qLCBhLmFjY291bnRfbmFtZSwgYS5pc19hY3RpdmUgYXMgYWNjb3VudF9pc19hY3RpdmUsIHIucm9sZV9uYW1lIFxyXG4gICAgICAgICBGUk9NIHVzZXJzIHVcclxuICAgICAgICAgSk9JTiBhY2NvdW50cyBhIE9OIHUuYWNjb3VudF9pZCA9IGEuYWNjb3VudF9pZFxyXG4gICAgICAgICBKT0lOIHJvbGVzIHIgT04gdS5yb2xlX2lkID0gci5yb2xlX2lkXHJcbiAgICAgICAgIFdIRVJFIHUuZW1haWwgPSAkMWAsXHJcbiAgICAgICAgW2VtYWlsXVxyXG4gICAgICApO1xyXG5cclxuICAgICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGw7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmaW5kaW5nIHVzZXIgYnkgZW1haWw6JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICAvLyBGaW5kIHVzZXIgYnkgSUQgLSBzZXJ2ZXIgb25seVxyXG4gIGFzeW5jIGZpbmRVc2VyQnlJZCh1c2VySWQpIHtcclxuICAgIC8vIEVuc3VyZSB3ZSdyZSBydW5uaW5nIG9uIHRoZSBzZXJ2ZXJcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgZnVuY3Rpb24gY2FuIG9ubHkgYmUgY2FsbGVkIG9uIHRoZSBzZXJ2ZXIgc2lkZScpO1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5Rm4oXHJcbiAgICAgICAgYFNFTEVDVCB1LiosIGEuYWNjb3VudF9uYW1lLCBhLmlzX2FjdGl2ZSBhcyBhY2NvdW50X2lzX2FjdGl2ZSwgci5yb2xlX25hbWUsIHIucGVybWlzc2lvbnNcclxuICAgICAgICAgRlJPTSB1c2VycyB1XHJcbiAgICAgICAgIEpPSU4gYWNjb3VudHMgYSBPTiB1LmFjY291bnRfaWQgPSBhLmFjY291bnRfaWRcclxuICAgICAgICAgSk9JTiByb2xlcyByIE9OIHUucm9sZV9pZCA9IHIucm9sZV9pZFxyXG4gICAgICAgICBXSEVSRSB1LnVzZXJfaWQgPSAkMWAsXHJcbiAgICAgICAgW3VzZXJJZF1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmluZGluZyB1c2VyIGJ5IElEOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy8gQ3JlYXRlIGEgbmV3IHNlc3Npb24gLSBzZXJ2ZXIgb25seVxyXG4gIGFzeW5jIGNyZWF0ZVNlc3Npb24odXNlcklkKSB7XHJcbiAgICAvLyBFbnN1cmUgd2UncmUgcnVubmluZyBvbiB0aGUgc2VydmVyXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBvbiB0aGUgc2VydmVyIHNpZGUnKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZXNzaW9uVG9rZW4gPSB1dWlkdjQoKTtcclxuICAgIGNvbnN0IGV4cGlyZXNBdCA9IG5ldyBEYXRlKCk7XHJcbiAgICBleHBpcmVzQXQuc2V0RGF0ZShleHBpcmVzQXQuZ2V0RGF0ZSgpICsgNyk7IC8vIDcgZGF5cyBleHBpcmF0aW9uXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgcXVlcnlGbihcclxuICAgICAgICAnSU5TRVJUIElOVE8gc2Vzc2lvbnMgKHVzZXJfaWQsIHNlc3Npb25fdG9rZW4sIGV4cGlyZXNfYXQpIFZBTFVFUyAoJDEsICQyLCAkMyknLFxyXG4gICAgICAgIFt1c2VySWQsIHNlc3Npb25Ub2tlbiwgZXhwaXJlc0F0XVxyXG4gICAgICApO1xyXG5cclxuICAgICAgcmV0dXJuIHNlc3Npb25Ub2tlbjtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHNlc3Npb246JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9LFxyXG4gIC8vIFZlcmlmeSBhIHNlc3Npb24gdG9rZW4gLSBzZXJ2ZXIgb25seVxyXG4gIGFzeW5jIHZlcmlmeVNlc3Npb24oc2Vzc2lvblRva2VuKSB7XHJcbiAgICAvLyBFbnN1cmUgd2UncmUgcnVubmluZyBvbiB0aGUgc2VydmVyXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBvbiB0aGUgc2VydmVyIHNpZGUnKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZygndmVyaWZ5U2Vzc2lvbiBjYWxsZWQgd2l0aCB0b2tlbicsIHsgXHJcbiAgICAgIHRva2VuTGVuZ3RoOiBzZXNzaW9uVG9rZW4gPyBzZXNzaW9uVG9rZW4ubGVuZ3RoIDogMCxcclxuICAgICAgdG9rZW5QcmVmaXg6IHNlc3Npb25Ub2tlbiA/IHNlc3Npb25Ub2tlbi5zdWJzdHJpbmcoMCwgOCkgKyAnLi4uJyA6ICdub25lJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnlGbihcclxuICAgICAgICBgU0VMRUNUIHUuKiwgcy5zZXNzaW9uX2lkLCBzLmV4cGlyZXNfYXQsIGEuYWNjb3VudF9uYW1lLCBhLmlzX2FjdGl2ZSBhcyBhY2NvdW50X2lzX2FjdGl2ZSwgci5yb2xlX25hbWUsIHIucGVybWlzc2lvbnNcclxuICAgICAgICAgRlJPTSBzZXNzaW9ucyBzXHJcbiAgICAgICAgIEpPSU4gdXNlcnMgdSBPTiBzLnVzZXJfaWQgPSB1LnVzZXJfaWRcclxuICAgICAgICAgSk9JTiBhY2NvdW50cyBhIE9OIHUuYWNjb3VudF9pZCA9IGEuYWNjb3VudF9pZFxyXG4gICAgICAgICBKT0lOIHJvbGVzIHIgT04gdS5yb2xlX2lkID0gci5yb2xlX2lkXHJcbiAgICAgICAgIFdIRVJFIHMuc2Vzc2lvbl90b2tlbiA9ICQxIEFORCBzLmV4cGlyZXNfYXQgPiBOT1coKWAsXHJcbiAgICAgICAgW3Nlc3Npb25Ub2tlbl1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCd2ZXJpZnlTZXNzaW9uIHF1ZXJ5IHJlc3VsdCcsIHtcclxuICAgICAgICBmb3VuZDogcmVzdWx0LnJvd0NvdW50ID4gMCxcclxuICAgICAgICB1c2VyRGF0YTogcmVzdWx0LnJvd0NvdW50ID4gMCA/IHtcclxuICAgICAgICAgIHVzZXJfaWQ6IHJlc3VsdC5yb3dzWzBdLnVzZXJfaWQsXHJcbiAgICAgICAgICBlbWFpbDogcmVzdWx0LnJvd3NbMF0uZW1haWwsXHJcbiAgICAgICAgICBhY2NvdW50X2lkOiByZXN1bHQucm93c1swXS5hY2NvdW50X2lkLFxyXG4gICAgICAgICAgaXNfYWNjb3VudF9hZG1pbjogcmVzdWx0LnJvd3NbMF0uaXNfYWNjb3VudF9hZG1pbixcclxuICAgICAgICAgIGFjY291bnRfbmFtZTogcmVzdWx0LnJvd3NbMF0uYWNjb3VudF9uYW1lLFxyXG4gICAgICAgICAgcm9sZV9uYW1lOiByZXN1bHQucm93c1swXS5yb2xlX25hbWVcclxuICAgICAgICB9IDogbnVsbFxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIEFkZCBzdGFuZGFyZCBwcm9wZXJ0eSBuYW1lcyBmb3IgY29uc2lzdGVuY3lcclxuICAgICAgaWYgKHJlc3VsdC5yb3dDb3VudCA+IDApIHtcclxuICAgICAgICBjb25zdCB1c2VyID0gcmVzdWx0LnJvd3NbMF07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTWFwIGRhdGFiYXNlIGZpZWxkIG5hbWVzIHRvIHRoZSBjYW1lbENhc2UgZm9ybWF0IGV4cGVjdGVkIGJ5IGZyb250ZW5kXHJcbiAgICAgICAgdXNlci5pZCA9IHVzZXIudXNlcl9pZDtcclxuICAgICAgICB1c2VyLmZpcnN0TmFtZSA9IHVzZXIuZmlyc3RfbmFtZTtcclxuICAgICAgICB1c2VyLmxhc3ROYW1lID0gdXNlci5sYXN0X25hbWU7XHJcbiAgICAgICAgdXNlci5hY2NvdW50SWQgPSB1c2VyLmFjY291bnRfaWQ7XHJcbiAgICAgICAgdXNlci5pc0FkbWluID0gdXNlci5pc19hY2NvdW50X2FkbWluO1xyXG4gICAgICAgIHVzZXIuYWNjb3VudE5hbWUgPSB1c2VyLmFjY291bnRfbmFtZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGw7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB2ZXJpZnlpbmcgc2Vzc2lvbjonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vIEludmFsaWRhdGUgYSBzZXNzaW9uIC0gc2VydmVyIG9ubHlcclxuICBhc3luYyBpbnZhbGlkYXRlU2Vzc2lvbihzZXNzaW9uVG9rZW4pIHtcclxuICAgIC8vIEVuc3VyZSB3ZSdyZSBydW5uaW5nIG9uIHRoZSBzZXJ2ZXJcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgZnVuY3Rpb24gY2FuIG9ubHkgYmUgY2FsbGVkIG9uIHRoZSBzZXJ2ZXIgc2lkZScpO1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHF1ZXJ5Rm4oJ0RFTEVURSBGUk9NIHNlc3Npb25zIFdIRVJFIHNlc3Npb25fdG9rZW4gPSAkMScsIFtzZXNzaW9uVG9rZW5dKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbnZhbGlkYXRpbmcgc2Vzc2lvbjonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vIENyZWF0ZSBhIHBhc3N3b3JkIHJlc2V0IHRva2VuIC0gc2VydmVyIG9ubHlcclxuICBhc3luYyBjcmVhdGVQYXNzd29yZFJlc2V0VG9rZW4odXNlcklkKSB7XHJcbiAgICAvLyBFbnN1cmUgd2UncmUgcnVubmluZyBvbiB0aGUgc2VydmVyXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBvbiB0aGUgc2VydmVyIHNpZGUnKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0b2tlbiA9IHV1aWR2NCgpO1xyXG4gICAgY29uc3QgZXhwaXJlc0F0ID0gbmV3IERhdGUoKTtcclxuICAgIGV4cGlyZXNBdC5zZXRIb3VycyhleHBpcmVzQXQuZ2V0SG91cnMoKSArIDI0KTsgLy8gMjQgaG91cnMgZXhwaXJhdGlvblxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHF1ZXJ5Rm4oXHJcbiAgICAgICAgJ0lOU0VSVCBJTlRPIHBhc3N3b3JkX3Jlc2V0X3Rva2VucyAodXNlcl9pZCwgdG9rZW4sIGV4cGlyZXNfYXQpIFZBTFVFUyAoJDEsICQyLCAkMyknLFxyXG4gICAgICAgIFt1c2VySWQsIHRva2VuLCBleHBpcmVzQXRdXHJcbiAgICAgICk7XHJcblxyXG4gICAgICByZXR1cm4gdG9rZW47XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBwYXNzd29yZCByZXNldCB0b2tlbjonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vIFZlcmlmeSBhIHBhc3N3b3JkIHJlc2V0IHRva2VuIC0gc2VydmVyIG9ubHlcclxuICBhc3luYyB2ZXJpZnlSZXNldFRva2VuKHRva2VuKSB7XHJcbiAgICAvLyBFbnN1cmUgd2UncmUgcnVubmluZyBvbiB0aGUgc2VydmVyXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBvbiB0aGUgc2VydmVyIHNpZGUnKTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeUZuKFxyXG4gICAgICAgICdTRUxFQ1QgKiBGUk9NIHBhc3N3b3JkX3Jlc2V0X3Rva2VucyBXSEVSRSB0b2tlbiA9ICQxIEFORCBleHBpcmVzX2F0ID4gTk9XKCknLFxyXG4gICAgICAgIFt0b2tlbl1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdmVyaWZ5aW5nIHJlc2V0IHRva2VuOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy8gUmVzZXQgcGFzc3dvcmQgLSBzZXJ2ZXIgb25seVxyXG4gIGFzeW5jIHJlc2V0UGFzc3dvcmQodG9rZW4sIG5ld1Bhc3N3b3JkKSB7XHJcbiAgICAvLyBFbnN1cmUgd2UncmUgcnVubmluZyBvbiB0aGUgc2VydmVyXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBvbiB0aGUgc2VydmVyIHNpZGUnKTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB0b2tlblJlY29yZCA9IGF3YWl0IHRoaXMudmVyaWZ5UmVzZXRUb2tlbih0b2tlbik7XHJcblxyXG4gICAgICBpZiAoIXRva2VuUmVjb3JkKSB7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBvciBleHBpcmVkIHRva2VuJyB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCB0aGlzLmhhc2hQYXNzd29yZChuZXdQYXNzd29yZCk7XHJcblxyXG4gICAgICAvLyBVcGRhdGUgcGFzc3dvcmRcclxuICAgICAgYXdhaXQgcXVlcnlGbihcclxuICAgICAgICAnVVBEQVRFIHVzZXJzIFNFVCBwYXNzd29yZF9oYXNoID0gJDEsIHVwZGF0ZWRfYXQgPSBOT1coKSBXSEVSRSB1c2VyX2lkID0gJDInLFxyXG4gICAgICAgIFtwYXNzd29yZEhhc2gsIHRva2VuUmVjb3JkLnVzZXJfaWRdXHJcbiAgICAgICk7XHJcblxyXG4gICAgICAvLyBEZWxldGUgdGhlIHRva2VuXHJcbiAgICAgIGF3YWl0IHF1ZXJ5Rm4oJ0RFTEVURSBGUk9NIHBhc3N3b3JkX3Jlc2V0X3Rva2VucyBXSEVSRSB0b2tlbl9pZCA9ICQxJywgW3Rva2VuUmVjb3JkLnRva2VuX2lkXSk7XHJcblxyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXNldHRpbmcgcGFzc3dvcmQ6JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG4vLyBBY2NvdW50IG1hbmFnZW1lbnQgLSBhbGwgbWV0aG9kcyBhcmUgc2VydmVyLW9ubHlcclxuZXhwb3J0IGNvbnN0IGFjY291bnRNYW5hZ2VyID0ge1xyXG4gIC8vIENyZWF0ZSBhIG5ldyBhY2NvdW50IHdpdGggYWRtaW4gdXNlclxyXG4gIGFzeW5jIGNyZWF0ZUFjY291bnQoYWNjb3VudERhdGEsIHVzZXJEYXRhKSB7XHJcbiAgICAvLyBFbnN1cmUgd2UncmUgcnVubmluZyBvbiB0aGUgc2VydmVyXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGZ1bmN0aW9uIGNhbiBvbmx5IGJlIGNhbGxlZCBvbiB0aGUgc2VydmVyIHNpZGUnKTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBTdGFydCBhIHRyYW5zYWN0aW9uXHJcbiAgICAgIGF3YWl0IHF1ZXJ5Rm4oJ0JFR0lOJyk7XHJcblxyXG4gICAgICAvLyBDcmVhdGUgYWNjb3VudFxyXG4gICAgICBjb25zdCBhY2NvdW50UmVzdWx0ID0gYXdhaXQgcXVlcnlGbihcclxuICAgICAgICAnSU5TRVJUIElOVE8gYWNjb3VudHMgKGFjY291bnRfbmFtZSwgYWNjb3VudF9kb21haW4sIHBsYW5faWQsIGJpbGxpbmdfZW1haWwpIFZBTFVFUyAoJDEsICQyLCAkMywgJDQpIFJFVFVSTklORyAqJyxcclxuICAgICAgICBbYWNjb3VudERhdGEuYWNjb3VudE5hbWUsIGFjY291bnREYXRhLmFjY291bnREb21haW4gfHwgbnVsbCwgYWNjb3VudERhdGEucGxhbklkIHx8IDEsIGFjY291bnREYXRhLmJpbGxpbmdFbWFpbF1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhY2NvdW50UmVzdWx0LnJvd3NbMF07XHJcblxyXG4gICAgICAvLyBIYXNoIHBhc3N3b3JkXHJcbiAgICAgIGNvbnN0IHBhc3N3b3JkSGFzaCA9IGF3YWl0IGF1dGguaGFzaFBhc3N3b3JkKHVzZXJEYXRhLnBhc3N3b3JkKTtcclxuXHJcbiAgICAgIC8vIENyZWF0ZSBhZG1pbiB1c2VyIChyb2xlX2lkIDEgPSBBZG1pbilcclxuICAgICAgY29uc3QgdXNlclJlc3VsdCA9IGF3YWl0IHF1ZXJ5Rm4oXHJcbiAgICAgICAgYElOU0VSVCBJTlRPIHVzZXJzIChhY2NvdW50X2lkLCBlbWFpbCwgcGFzc3dvcmRfaGFzaCwgZmlyc3RfbmFtZSwgbGFzdF9uYW1lLCByb2xlX2lkLCBpc19hY2NvdW50X2FkbWluKSBcclxuICAgICAgICAgVkFMVUVTICgkMSwgJDIsICQzLCAkNCwgJDUsIDEsIFRSVUUpIFJFVFVSTklORyAqYCxcclxuICAgICAgICBbYWNjb3VudC5hY2NvdW50X2lkLCB1c2VyRGF0YS5lbWFpbCwgcGFzc3dvcmRIYXNoLCB1c2VyRGF0YS5maXJzdE5hbWUsIHVzZXJEYXRhLmxhc3ROYW1lXVxyXG4gICAgICApO1xyXG5cclxuICAgICAgY29uc3QgYWRtaW4gPSB1c2VyUmVzdWx0LnJvd3NbMF07XHJcblxyXG4gICAgICAvLyBDb21taXQgdHJhbnNhY3Rpb25cclxuICAgICAgYXdhaXQgcXVlcnlGbignQ09NTUlUJyk7XHJcblxyXG4gICAgICByZXR1cm4geyBhY2NvdW50LCBhZG1pbiB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gUm9sbGJhY2sgdHJhbnNhY3Rpb24gb24gZXJyb3JcclxuICAgICAgYXdhaXQgcXVlcnlGbignUk9MTEJBQ0snKTtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgYWNjb3VudDonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vIFJlbWFpbmluZyBhY2NvdW50IG1hbmFnZXIgbWV0aG9kcyAodHJ1bmNhdGVkIGZvciBicmV2aXR5KVxyXG4gIC8vIFRoZSBwYXR0ZXJuIHdvdWxkIGJlIHRoZSBzYW1lIC0gdXNpbmcgcXVlcnlGbiBhbmQgcHJvcGVyIGVycm9yIGhhbmRsaW5nXHJcbn07XHJcblxyXG4vLyBDcmVhdGUgbW9jayBpbXBsZW1lbnRhdGlvbnMgZm9yIGNsaWVudC1zaWRlIHVzZVxyXG5jb25zdCBjcmVhdGVNb2NrQXV0aCA9ICgpID0+IHtcclxuICBjb25zdCBtb2NrQXV0aCA9IHtcclxuICAgIC8vIE1vY2sgaW1wbGVtZW50YXRpb25zIHRoYXQgYXJlIHNhZmUgdG8gdXNlIG9uIHRoZSBjbGllbnRcclxuICAgIGFzeW5jIGhhc2hQYXNzd29yZChwYXNzd29yZCkge1xyXG4gICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAvLyBXaGVuIHJ1bm5pbmcgb24gdGhlIHNlcnZlciwgdXNlIHRoZSByZWFsIGltcGxlbWVudGF0aW9uXHJcbiAgICAgICAgcmV0dXJuIGF1dGguaGFzaFBhc3N3b3JkKHBhc3N3b3JkKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gT24gY2xpZW50LCBqdXN0IHJldHVybiBhIHBsYWNlaG9sZGVyIChyZWFsIGhhc2hpbmcgaGFwcGVucyBzZXJ2ZXItc2lkZSlcclxuICAgICAgY29uc29sZS53YXJuKCdoYXNoUGFzc3dvcmQgY2FsbGVkIG9uIGNsaWVudCwgcmVhbCBoYXNoaW5nIHdpbGwgaGFwcGVuIHNlcnZlci1zaWRlJyk7XHJcbiAgICAgIHJldHVybiBgbW9jay1oYXNoLSR7cGFzc3dvcmQubGVuZ3RofWA7XHJcbiAgICB9LFxyXG5cclxuICAgIGFzeW5jIGNvbXBhcmVQYXNzd29yZChwYXNzd29yZCwgaGFzaCkge1xyXG4gICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAvLyBXaGVuIHJ1bm5pbmcgb24gdGhlIHNlcnZlciwgdXNlIHRoZSByZWFsIGltcGxlbWVudGF0aW9uXHJcbiAgICAgICAgcmV0dXJuIGF1dGguY29tcGFyZVBhc3N3b3JkKHBhc3N3b3JkLCBoYXNoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gT24gY2xpZW50LCBqdXN0IHJldHVybiBhIHBsYWNlaG9sZGVyIChyZWFsIGNvbXBhcmlzb24gaGFwcGVucyBzZXJ2ZXItc2lkZSlcclxuICAgICAgY29uc29sZS53YXJuKCdjb21wYXJlUGFzc3dvcmQgY2FsbGVkIG9uIGNsaWVudCwgcmVhbCBjb21wYXJpc29uIHdpbGwgaGFwcGVuIHNlcnZlci1zaWRlJyk7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gVGhlc2UgbWV0aG9kcyBzaG91bGQgYmUgY2FsbGVkIHZpYSBBUEkgZW5kcG9pbnRzIG9uIHRoZSBjbGllbnRcclxuICAgIGFzeW5jIGZpbmRVc2VyQnlFbWFpbCgpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIHZpYSBhbiBBUEkgZW5kcG9pbnQgb24gY2xpZW50LXNpZGUnKTtcclxuICAgIH0sXHJcblxyXG4gICAgYXN5bmMgZmluZFVzZXJCeUlkKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhc3luYyBjcmVhdGVTZXNzaW9uKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhc3luYyB2ZXJpZnlTZXNzaW9uKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhc3luYyBpbnZhbGlkYXRlU2Vzc2lvbigpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIHZpYSBhbiBBUEkgZW5kcG9pbnQgb24gY2xpZW50LXNpZGUnKTtcclxuICAgIH0sXHJcblxyXG4gICAgYXN5bmMgY3JlYXRlUGFzc3dvcmRSZXNldFRva2VuKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhc3luYyB2ZXJpZnlSZXNldFRva2VuKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhc3luYyByZXNldFBhc3N3b3JkKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHJldHVybiBtb2NrQXV0aDtcclxufTtcclxuXHJcbi8vIENyZWF0ZSBhIG1vY2sgYWNjb3VudCBtYW5hZ2VyIGZvciBjbGllbnQtc2lkZSB1c2VcclxuY29uc3QgY3JlYXRlTW9ja0FjY291bnRNYW5hZ2VyID0gKCkgPT4ge1xyXG4gIGNvbnN0IG1vY2tBY2NvdW50TWFuYWdlciA9IHtcclxuICAgIC8vIEFsbCBtZXRob2RzIHNob3VsZCBiZSBjYWxsZWQgdmlhIEFQSSBlbmRwb2ludHMgb24gdGhlIGNsaWVudFxyXG4gICAgYXN5bmMgY3JlYXRlQWNjb3VudCgpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIHZpYSBhbiBBUEkgZW5kcG9pbnQgb24gY2xpZW50LXNpZGUnKTtcclxuICAgIH0sXHJcblxyXG4gICAgYXN5bmMgZ2V0QWNjb3VudFVzZXJzKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhc3luYyBjcmVhdGVVc2VyKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhc3luYyB1cGRhdGVVc2VyKCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfSxcclxuXHJcbiAgICBhc3luYyB1cGRhdGVBY2NvdW50KCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgdmlhIGFuIEFQSSBlbmRwb2ludCBvbiBjbGllbnQtc2lkZScpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHJldHVybiBtb2NrQWNjb3VudE1hbmFnZXI7XHJcbn07XHJcblxyXG4vLyBFeHBvcnQgdGhlIGFwcHJvcHJpYXRlIGltcGxlbWVudGF0aW9ucyBiYXNlZCBvbiBlbnZpcm9ubWVudFxyXG5leHBvcnQgY29uc3QgY2xpZW50QXV0aCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gY3JlYXRlTW9ja0F1dGgoKSA6IGF1dGg7XHJcbmV4cG9ydCBjb25zdCBjbGllbnRBY2NvdW50TWFuYWdlciA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gY3JlYXRlTW9ja0FjY291bnRNYW5hZ2VyKCkgOiBhY2NvdW50TWFuYWdlcjsiXSwibmFtZXMiOlsiYmNyeXB0IiwidXVpZHY0IiwicXVlcnlGbiIsInBvb2xPYmoiLCJyZXF1aXJlIiwidjQiLCJkYk1vZHVsZSIsInF1ZXJ5IiwicG9vbCIsImVycm9yIiwiY29uc29sZSIsImhhc2giLCJjb21wYXJlIiwiRXJyb3IiLCJhdXRoIiwiaGFzaFBhc3N3b3JkIiwicGFzc3dvcmQiLCJ3YXJuIiwibGVuZ3RoIiwiY29tcGFyZVBhc3N3b3JkIiwiZmluZFVzZXJCeUVtYWlsIiwiZW1haWwiLCJyZXN1bHQiLCJyb3dzIiwiZmluZFVzZXJCeUlkIiwidXNlcklkIiwiY3JlYXRlU2Vzc2lvbiIsInNlc3Npb25Ub2tlbiIsImV4cGlyZXNBdCIsIkRhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsInZlcmlmeVNlc3Npb24iLCJsb2ciLCJ0b2tlbkxlbmd0aCIsInRva2VuUHJlZml4Iiwic3Vic3RyaW5nIiwiZm91bmQiLCJyb3dDb3VudCIsInVzZXJEYXRhIiwidXNlcl9pZCIsImFjY291bnRfaWQiLCJpc19hY2NvdW50X2FkbWluIiwiYWNjb3VudF9uYW1lIiwicm9sZV9uYW1lIiwidXNlciIsImlkIiwiZmlyc3ROYW1lIiwiZmlyc3RfbmFtZSIsImxhc3ROYW1lIiwibGFzdF9uYW1lIiwiYWNjb3VudElkIiwiaXNBZG1pbiIsImFjY291bnROYW1lIiwiaW52YWxpZGF0ZVNlc3Npb24iLCJjcmVhdGVQYXNzd29yZFJlc2V0VG9rZW4iLCJ0b2tlbiIsInNldEhvdXJzIiwiZ2V0SG91cnMiLCJ2ZXJpZnlSZXNldFRva2VuIiwicmVzZXRQYXNzd29yZCIsIm5ld1Bhc3N3b3JkIiwidG9rZW5SZWNvcmQiLCJzdWNjZXNzIiwicGFzc3dvcmRIYXNoIiwidG9rZW5faWQiLCJhY2NvdW50TWFuYWdlciIsImNyZWF0ZUFjY291bnQiLCJhY2NvdW50RGF0YSIsImFjY291bnRSZXN1bHQiLCJhY2NvdW50RG9tYWluIiwicGxhbklkIiwiYmlsbGluZ0VtYWlsIiwiYWNjb3VudCIsInVzZXJSZXN1bHQiLCJhZG1pbiIsImNyZWF0ZU1vY2tBdXRoIiwibW9ja0F1dGgiLCJjcmVhdGVNb2NrQWNjb3VudE1hbmFnZXIiLCJtb2NrQWNjb3VudE1hbmFnZXIiLCJnZXRBY2NvdW50VXNlcnMiLCJjcmVhdGVVc2VyIiwidXBkYXRlVXNlciIsInVwZGF0ZUFjY291bnQiLCJjbGllbnRBdXRoIiwiY2xpZW50QWNjb3VudE1hbmFnZXIiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./lib/auth.js\n");

/***/ }),

/***/ "(api-node)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pool: () => (/* binding */ pool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n// lib/db.js\n// Initialize query and pool as null\nlet pool = null;\nlet query = null;\n// Only run this code on the server\nif (true) {\n    try {\n        // Server-side code - import pg using require to avoid webpack issues\n        const { Pool } = __webpack_require__(/*! pg */ \"pg\");\n        // Create a database connection pool\n        pool =  false ? 0 : new Pool({\n            user: process.env.DB_USER || 'postgres',\n            host: process.env.DB_HOST || 'localhost',\n            database: process.env.DB_NAME || 'innvestai',\n            password: process.env.DB_PASSWORD || 'Temp@123',\n            port: parseInt(process.env.DB_PORT || '5432')\n        });\n        // Define the query function\n        query = async (text, params)=>{\n            try {\n                const start = Date.now();\n                const res = await pool.query(text, params);\n                const duration = Date.now() - start;\n                // Log query performance in development\n                if (true) {\n                    console.log('Executed query', {\n                        text,\n                        duration,\n                        rows: res.rowCount\n                    });\n                }\n                return res;\n            } catch (error) {\n                console.error('Database query error:', error);\n                throw error;\n            }\n        };\n        // Setup event handlers for the pool\n        pool.on('error', (err)=>{\n            console.error('Unexpected database error:', err);\n        // Don't crash the server on connection errors\n        });\n        console.log('Database module initialized on server');\n    } catch (error) {\n        console.error('Failed to initialize database module:', error);\n        // Create non-functional stubs if initialization fails\n        pool = {\n            query: ()=>{\n                throw new Error('Database pool not initialized');\n            },\n            on: ()=>{}\n        };\n        query = async ()=>{\n            throw new Error('Database query function not initialized');\n        };\n    }\n} else {}\n// Next.js supports ES modules by default\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL2xpYi9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLFlBQVk7QUFFWixvQ0FBb0M7QUFDcEMsSUFBSUEsT0FBTztBQUNYLElBQUlDLFFBQVE7QUFFWixtQ0FBbUM7QUFDbkMsSUFBSSxJQUE2QixFQUFFO0lBQ2pDLElBQUk7UUFDRixxRUFBcUU7UUFDckUsTUFBTSxFQUFFQyxJQUFJLEVBQUUsR0FBR0MsbUJBQU9BLENBQUMsY0FBSTtRQUU3QixvQ0FBb0M7UUFDcENILE9BQU9JLE1BQXFDLEdBQ3hDLENBS0UsR0FDRixJQUFJRixLQUFLO1lBQ1BRLE1BQU1OLFFBQVFFLEdBQUcsQ0FBQ0ssT0FBTyxJQUFJO1lBQzdCQyxNQUFNUixRQUFRRSxHQUFHLENBQUNPLE9BQU8sSUFBSTtZQUM3QkMsVUFBVVYsUUFBUUUsR0FBRyxDQUFDUyxPQUFPLElBQUk7WUFDakNDLFVBQVVaLFFBQVFFLEdBQUcsQ0FBQ1csV0FBVyxJQUFJO1lBQ3JDQyxNQUFNQyxTQUFTZixRQUFRRSxHQUFHLENBQUNjLE9BQU8sSUFBSTtRQUN4QztRQUVKLDRCQUE0QjtRQUM1Qm5CLFFBQVEsT0FBT29CLE1BQU1DO1lBQ25CLElBQUk7Z0JBQ0YsTUFBTUMsUUFBUUMsS0FBS0MsR0FBRztnQkFDdEIsTUFBTUMsTUFBTSxNQUFNMUIsS0FBS0MsS0FBSyxDQUFDb0IsTUFBTUM7Z0JBQ25DLE1BQU1LLFdBQVdILEtBQUtDLEdBQUcsS0FBS0Y7Z0JBRTlCLHVDQUF1QztnQkFDdkMsSUFBSW5CLElBQXFDLEVBQUU7b0JBQ3pDd0IsUUFBUUMsR0FBRyxDQUFDLGtCQUFrQjt3QkFBRVI7d0JBQU1NO3dCQUFVRyxNQUFNSixJQUFJSyxRQUFRO29CQUFDO2dCQUNyRTtnQkFFQSxPQUFPTDtZQUNULEVBQUUsT0FBT00sT0FBTztnQkFDZEosUUFBUUksS0FBSyxDQUFDLHlCQUF5QkE7Z0JBQ3ZDLE1BQU1BO1lBQ1I7UUFDRjtRQUVBLG9DQUFvQztRQUNwQ2hDLEtBQUtpQyxFQUFFLENBQUMsU0FBUyxDQUFDQztZQUNoQk4sUUFBUUksS0FBSyxDQUFDLDhCQUE4QkU7UUFDNUMsOENBQThDO1FBQ2hEO1FBRUFOLFFBQVFDLEdBQUcsQ0FBQztJQUNkLEVBQUUsT0FBT0csT0FBTztRQUNkSixRQUFRSSxLQUFLLENBQUMseUNBQXlDQTtRQUV2RCxzREFBc0Q7UUFDdERoQyxPQUFPO1lBQ0xDLE9BQU87Z0JBQVEsTUFBTSxJQUFJa0MsTUFBTTtZQUFrQztZQUNqRUYsSUFBSSxLQUFPO1FBQ2I7UUFFQWhDLFFBQVE7WUFBYyxNQUFNLElBQUlrQyxNQUFNO1FBQTRDO0lBQ3BGO0FBQ0YsT0FBTyxFQVlOO0FBRUQseUNBQXlDO0FBQ2xCIiwic291cmNlcyI6WyJDOlxcdmlub2RcXHByb2plY3RzXFxpbm52ZXN0XFxQT0NcXGlubnZlc3RhaVxcbGliXFxkYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvZGIuanNcclxuXHJcbi8vIEluaXRpYWxpemUgcXVlcnkgYW5kIHBvb2wgYXMgbnVsbFxyXG5sZXQgcG9vbCA9IG51bGw7XHJcbmxldCBxdWVyeSA9IG51bGw7XHJcblxyXG4vLyBPbmx5IHJ1biB0aGlzIGNvZGUgb24gdGhlIHNlcnZlclxyXG5pZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gU2VydmVyLXNpZGUgY29kZSAtIGltcG9ydCBwZyB1c2luZyByZXF1aXJlIHRvIGF2b2lkIHdlYnBhY2sgaXNzdWVzXHJcbiAgICBjb25zdCB7IFBvb2wgfSA9IHJlcXVpcmUoJ3BnJyk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgZGF0YWJhc2UgY29ubmVjdGlvbiBwb29sXHJcbiAgICBwb29sID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyBcclxuICAgICAgPyBuZXcgUG9vbCh7XHJcbiAgICAgICAgICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwsXHJcbiAgICAgICAgICBzc2w6IHtcclxuICAgICAgICAgICAgcmVqZWN0VW5hdXRob3JpemVkOiBmYWxzZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgIDogbmV3IFBvb2woe1xyXG4gICAgICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuREJfVVNFUiB8fCAncG9zdGdyZXMnLFxyXG4gICAgICAgICAgaG9zdDogcHJvY2Vzcy5lbnYuREJfSE9TVCB8fCAnbG9jYWxob3N0JyxcclxuICAgICAgICAgIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5EQl9OQU1FIHx8ICdpbm52ZXN0YWknLCAvLyBVc2UgYnVpbHQtaW4gcG9zdGdyZXMgZGF0YWJhc2VcclxuICAgICAgICAgIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCAnVGVtcEAxMjMnLFxyXG4gICAgICAgICAgcG9ydDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfUE9SVCB8fCAnNTQzMicpLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIC8vIERlZmluZSB0aGUgcXVlcnkgZnVuY3Rpb25cclxuICAgIHF1ZXJ5ID0gYXN5bmMgKHRleHQsIHBhcmFtcykgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBwb29sLnF1ZXJ5KHRleHQsIHBhcmFtcyk7XHJcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnQ7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTG9nIHF1ZXJ5IHBlcmZvcm1hbmNlIGluIGRldmVsb3BtZW50XHJcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdFeGVjdXRlZCBxdWVyeScsIHsgdGV4dCwgZHVyYXRpb24sIHJvd3M6IHJlcy5yb3dDb3VudCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBxdWVyeSBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gU2V0dXAgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSBwb29sXHJcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcignVW5leHBlY3RlZCBkYXRhYmFzZSBlcnJvcjonLCBlcnIpO1xyXG4gICAgICAvLyBEb24ndCBjcmFzaCB0aGUgc2VydmVyIG9uIGNvbm5lY3Rpb24gZXJyb3JzXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgbW9kdWxlIGluaXRpYWxpemVkIG9uIHNlcnZlcicpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkYXRhYmFzZSBtb2R1bGU6JywgZXJyb3IpO1xyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgbm9uLWZ1bmN0aW9uYWwgc3R1YnMgaWYgaW5pdGlhbGl6YXRpb24gZmFpbHNcclxuICAgIHBvb2wgPSB7XHJcbiAgICAgIHF1ZXJ5OiAoKSA9PiB7IHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcG9vbCBub3QgaW5pdGlhbGl6ZWQnKTsgfSxcclxuICAgICAgb246ICgpID0+IHt9XHJcbiAgICB9O1xyXG5cclxuICAgIHF1ZXJ5ID0gYXN5bmMgKCkgPT4geyB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGZ1bmN0aW9uIG5vdCBpbml0aWFsaXplZCcpOyB9O1xyXG4gIH1cclxufSBlbHNlIHtcclxuICAvLyBDbGllbnQtc2lkZSBtb2NrIGltcGxlbWVudGF0aW9uXHJcbiAgcXVlcnkgPSBhc3luYyAoKSA9PiB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJpZXMgY2Fubm90IGJlIGV4ZWN1dGVkIG9uIHRoZSBjbGllbnQgc2lkZScpO1xyXG4gIH07XHJcbiAgXHJcbiAgcG9vbCA9IHtcclxuICAgIHF1ZXJ5OiAoKSA9PiB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcXVlcmllcyBjYW5ub3QgYmUgZXhlY3V0ZWQgb24gdGhlIGNsaWVudCBzaWRlJyk7XHJcbiAgICB9LFxyXG4gICAgb246ICgpID0+IHt9XHJcbiAgfTtcclxufVxyXG5cclxuLy8gTmV4dC5qcyBzdXBwb3J0cyBFUyBtb2R1bGVzIGJ5IGRlZmF1bHRcclxuZXhwb3J0IHsgcXVlcnksIHBvb2wgfTsiXSwibmFtZXMiOlsicG9vbCIsInF1ZXJ5IiwiUG9vbCIsInJlcXVpcmUiLCJwcm9jZXNzIiwiY29ubmVjdGlvblN0cmluZyIsImVudiIsIkRBVEFCQVNFX1VSTCIsInNzbCIsInJlamVjdFVuYXV0aG9yaXplZCIsInVzZXIiLCJEQl9VU0VSIiwiaG9zdCIsIkRCX0hPU1QiLCJkYXRhYmFzZSIsIkRCX05BTUUiLCJwYXNzd29yZCIsIkRCX1BBU1NXT1JEIiwicG9ydCIsInBhcnNlSW50IiwiREJfUE9SVCIsInRleHQiLCJwYXJhbXMiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJyZXMiLCJkdXJhdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJyb3dzIiwicm93Q291bnQiLCJlcnJvciIsIm9uIiwiZXJyIiwiRXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./lib/db.js\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cauth%5Clogin.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cauth%5Clogin.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_auth_login_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\auth\\login.js */ \"(api-node)/./pages/api/auth/login.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_login_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_login_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/auth/login\",\n        pathname: \"/api/auth/login\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_auth_login_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGYXV0aCUyRmxvZ2luJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNhdXRoJTVDbG9naW4uanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ0U7QUFDMUQ7QUFDeUQ7QUFDekQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHFEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxxREFBUTtBQUNwQztBQUNPLHdCQUF3Qix5R0FBbUI7QUFDbEQ7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxhdXRoXFxcXGxvZ2luLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL2xvZ2luXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXV0aC9sb2dpblwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cauth%5Clogin.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/auth/login.js":
/*!*********************************!*\
  !*** ./pages/api/auth/login.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cookie */ \"cookie\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_auth_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/auth.js */ \"(api-node)/./lib/auth.js\");\n/* harmony import */ var _lib_db_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/db.js */ \"(api-node)/./lib/db.js\");\n// pages/api/auth/login.js\n\n\n\nasync function handler(req, res) {\n    // Only accept POST requests\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            error: 'Method not allowed'\n        });\n    }\n    try {\n        const { email, password } = req.body;\n        // Validate inputs\n        if (!email || !password) {\n            return res.status(400).json({\n                error: 'Email and password are required'\n            });\n        }\n        try {\n            // Find user by email\n            const user = await _lib_auth_js__WEBPACK_IMPORTED_MODULE_1__.auth.findUserByEmail(email);\n            // Check if user exists\n            if (!user) {\n                return res.status(401).json({\n                    error: 'Invalid credentials'\n                });\n            }\n            // Check if user is active\n            if (!user.is_active) {\n                return res.status(401).json({\n                    error: 'Account is inactive. Please contact your administrator.'\n                });\n            }\n            // Check if account is active\n            if (!user.account_is_active) {\n                return res.status(401).json({\n                    error: 'Your organization account is inactive. Please contact support.'\n                });\n            }\n            // Verify password\n            const passwordValid = await _lib_auth_js__WEBPACK_IMPORTED_MODULE_1__.auth.comparePassword(password, user.password_hash);\n            if (!passwordValid) {\n                return res.status(401).json({\n                    error: 'Invalid credentials'\n                });\n            }\n            // Update last login time\n            await (0,_lib_db_js__WEBPACK_IMPORTED_MODULE_2__.query)('UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE user_id = $1', [\n                user.user_id\n            ]);\n            // Create a new session\n            const sessionToken = await _lib_auth_js__WEBPACK_IMPORTED_MODULE_1__.auth.createSession(user.user_id);\n            // Set session cookie\n            res.setHeader('Set-Cookie', cookie__WEBPACK_IMPORTED_MODULE_0___default().serialize('session_token', sessionToken, {\n                httpOnly: true,\n                secure: \"development\" === 'production',\n                maxAge: 60 * 60 * 24 * 7,\n                sameSite: 'strict',\n                path: '/'\n            }));\n            // Return user info without sensitive data\n            return res.status(200).json({\n                user: {\n                    id: user.user_id,\n                    email: user.email,\n                    firstName: user.first_name,\n                    lastName: user.last_name,\n                    accountId: user.account_id,\n                    accountName: user.account_name,\n                    role: user.role_name,\n                    isAdmin: user.is_account_admin\n                },\n                sessionToken\n            });\n        } catch (dbError) {\n            console.error('Database operation error during login:', dbError);\n            return res.status(500).json({\n                error: 'A database error occurred. Please check your database configuration.'\n            });\n        }\n    } catch (error) {\n        console.error('Login error:', error);\n        return res.status(500).json({\n            error: 'An error occurred during login'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0osSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQWlDO0lBQ3hFO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFx2aW5vZFxccHJvamVjdHNcXGlubnZlc3RcXFBPQ1xcaW5udmVzdGFpXFxwYWdlc1xcYXBpXFxhdXRoXFxsb2dpbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9hcGkvYXV0aC9sb2dpbi5qc1xyXG5pbXBvcnQgY29va2llIGZyb20gJ2Nvb2tpZSc7XHJcbmltcG9ydCB7IGF1dGggfSBmcm9tICcuLi8uLi8uLi9saWIvYXV0aC5qcyc7XHJcbmltcG9ydCB7IHF1ZXJ5IH0gZnJvbSAnLi4vLi4vLi4vbGliL2RiLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICAvLyBPbmx5IGFjY2VwdCBQT1NUIHJlcXVlc3RzXHJcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcclxuXHJcbiAgICAvLyBWYWxpZGF0ZSBpbnB1dHNcclxuICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnRW1haWwgYW5kIHBhc3N3b3JkIGFyZSByZXF1aXJlZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gRmluZCB1c2VyIGJ5IGVtYWlsXHJcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhdXRoLmZpbmRVc2VyQnlFbWFpbChlbWFpbCk7XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB1c2VyIGV4aXN0c1xyXG4gICAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgY3JlZGVudGlhbHMnIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB1c2VyIGlzIGFjdGl2ZVxyXG4gICAgICBpZiAoIXVzZXIuaXNfYWN0aXZlKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdBY2NvdW50IGlzIGluYWN0aXZlLiBQbGVhc2UgY29udGFjdCB5b3VyIGFkbWluaXN0cmF0b3IuJyB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgaWYgYWNjb3VudCBpcyBhY3RpdmVcclxuICAgICAgaWYgKCF1c2VyLmFjY291bnRfaXNfYWN0aXZlKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdZb3VyIG9yZ2FuaXphdGlvbiBhY2NvdW50IGlzIGluYWN0aXZlLiBQbGVhc2UgY29udGFjdCBzdXBwb3J0LicgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFZlcmlmeSBwYXNzd29yZFxyXG4gICAgICBjb25zdCBwYXNzd29yZFZhbGlkID0gYXdhaXQgYXV0aC5jb21wYXJlUGFzc3dvcmQocGFzc3dvcmQsIHVzZXIucGFzc3dvcmRfaGFzaCk7XHJcblxyXG4gICAgICBpZiAoIXBhc3N3b3JkVmFsaWQpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgY3JlZGVudGlhbHMnIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBVcGRhdGUgbGFzdCBsb2dpbiB0aW1lXHJcbiAgICAgIGF3YWl0IHF1ZXJ5KFxyXG4gICAgICAgICdVUERBVEUgdXNlcnMgU0VUIGxhc3RfbG9naW4gPSBDVVJSRU5UX1RJTUVTVEFNUCBXSEVSRSB1c2VyX2lkID0gJDEnLFxyXG4gICAgICAgIFt1c2VyLnVzZXJfaWRdXHJcbiAgICAgICk7XHJcblxyXG4gICAgICAvLyBDcmVhdGUgYSBuZXcgc2Vzc2lvblxyXG4gICAgICBjb25zdCBzZXNzaW9uVG9rZW4gPSBhd2FpdCBhdXRoLmNyZWF0ZVNlc3Npb24odXNlci51c2VyX2lkKTtcclxuXHJcbiAgICAgIC8vIFNldCBzZXNzaW9uIGNvb2tpZVxyXG4gICAgICByZXMuc2V0SGVhZGVyKCdTZXQtQ29va2llJywgY29va2llLnNlcmlhbGl6ZSgnc2Vzc2lvbl90b2tlbicsIHNlc3Npb25Ub2tlbiwge1xyXG4gICAgICAgIGh0dHBPbmx5OiB0cnVlLFxyXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcclxuICAgICAgICBtYXhBZ2U6IDYwICogNjAgKiAyNCAqIDcsIC8vIDEgd2Vla1xyXG4gICAgICAgIHNhbWVTaXRlOiAnc3RyaWN0JyxcclxuICAgICAgICBwYXRoOiAnLydcclxuICAgICAgfSkpO1xyXG5cclxuICAgICAgLy8gUmV0dXJuIHVzZXIgaW5mbyB3aXRob3V0IHNlbnNpdGl2ZSBkYXRhXHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgdXNlcjoge1xyXG4gICAgICAgICAgaWQ6IHVzZXIudXNlcl9pZCxcclxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgICAgICAgZmlyc3ROYW1lOiB1c2VyLmZpcnN0X25hbWUsXHJcbiAgICAgICAgICBsYXN0TmFtZTogdXNlci5sYXN0X25hbWUsXHJcbiAgICAgICAgICBhY2NvdW50SWQ6IHVzZXIuYWNjb3VudF9pZCxcclxuICAgICAgICAgIGFjY291bnROYW1lOiB1c2VyLmFjY291bnRfbmFtZSxcclxuICAgICAgICAgIHJvbGU6IHVzZXIucm9sZV9uYW1lLFxyXG4gICAgICAgICAgaXNBZG1pbjogdXNlci5pc19hY2NvdW50X2FkbWluXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXNzaW9uVG9rZW4gLy8gQ2xpZW50IHdpbGwgc3RvcmUgdGhpcyBpbiBhIGNvb2tpZVxyXG4gICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGRiRXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2Ugb3BlcmF0aW9uIGVycm9yIGR1cmluZyBsb2dpbjonLCBkYkVycm9yKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBIGRhdGFiYXNlIGVycm9yIG9jY3VycmVkLiBQbGVhc2UgY2hlY2sgeW91ciBkYXRhYmFzZSBjb25maWd1cmF0aW9uLicgfSk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGxvZ2luJyB9KTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiY29va2llIiwiYXV0aCIsInF1ZXJ5IiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImVtYWlsIiwicGFzc3dvcmQiLCJib2R5IiwidXNlciIsImZpbmRVc2VyQnlFbWFpbCIsImlzX2FjdGl2ZSIsImFjY291bnRfaXNfYWN0aXZlIiwicGFzc3dvcmRWYWxpZCIsImNvbXBhcmVQYXNzd29yZCIsInBhc3N3b3JkX2hhc2giLCJ1c2VyX2lkIiwic2Vzc2lvblRva2VuIiwiY3JlYXRlU2Vzc2lvbiIsInNldEhlYWRlciIsInNlcmlhbGl6ZSIsImh0dHBPbmx5Iiwic2VjdXJlIiwicHJvY2VzcyIsIm1heEFnZSIsInNhbWVTaXRlIiwicGF0aCIsImlkIiwiZmlyc3ROYW1lIiwiZmlyc3RfbmFtZSIsImxhc3ROYW1lIiwibGFzdF9uYW1lIiwiYWNjb3VudElkIiwiYWNjb3VudF9pZCIsImFjY291bnROYW1lIiwiYWNjb3VudF9uYW1lIiwicm9sZSIsInJvbGVfbmFtZSIsImlzQWRtaW4iLCJpc19hY2NvdW50X2FkbWluIiwiZGJFcnJvciIsImNvbnNvbGUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/auth/login.js\n");

/***/ }),

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("bcryptjs");

/***/ }),

/***/ "cookie":
/*!*************************!*\
  !*** external "cookie" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("cookie");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("uuid");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Flogin&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cauth%5Clogin.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();