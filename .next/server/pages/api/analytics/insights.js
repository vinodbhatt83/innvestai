"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/analytics/insights";
exports.ids = ["pages/api/analytics/insights"];
exports.modules = {

/***/ "(api-node)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pool: () => (/* binding */ pool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n// lib/db.js\n// Initialize query and pool as null\nlet pool = null;\nlet query = null;\n// Only run this code on the server\nif (true) {\n    try {\n        // Server-side code - import pg using require to avoid webpack issues\n        const { Pool } = __webpack_require__(/*! pg */ \"pg\");\n        // Create a database connection pool\n        pool =  false ? 0 : new Pool({\n            user: process.env.DB_USER || 'postgres',\n            host: process.env.DB_HOST || 'localhost',\n            database: process.env.DB_NAME || 'innvestai',\n            password: process.env.DB_PASSWORD || 'Temp@123',\n            port: parseInt(process.env.DB_PORT || '5432')\n        });\n        // Define the query function\n        query = async (text, params)=>{\n            try {\n                const start = Date.now();\n                const res = await pool.query(text, params);\n                const duration = Date.now() - start;\n                // Log query performance in development\n                if (true) {\n                    console.log('Executed query', {\n                        text,\n                        duration,\n                        rows: res.rowCount\n                    });\n                }\n                return res;\n            } catch (error) {\n                console.error('Database query error:', error);\n                throw error;\n            }\n        };\n        // Setup event handlers for the pool\n        pool.on('error', (err)=>{\n            console.error('Unexpected database error:', err);\n        // Don't crash the server on connection errors\n        });\n        console.log('Database module initialized on server');\n    } catch (error) {\n        console.error('Failed to initialize database module:', error);\n        // Create non-functional stubs if initialization fails\n        pool = {\n            query: ()=>{\n                throw new Error('Database pool not initialized');\n            },\n            on: ()=>{}\n        };\n        query = async ()=>{\n            throw new Error('Database query function not initialized');\n        };\n    }\n} else {}\n// Choose one export style based on the environment\n// Use ES modules export style since that's what the rest of your code uses\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL2xpYi9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLFlBQVk7QUFFWixvQ0FBb0M7QUFDcEMsSUFBSUEsT0FBTztBQUNYLElBQUlDLFFBQVE7QUFFWixtQ0FBbUM7QUFDbkMsSUFBSSxJQUE2QixFQUFFO0lBQ2pDLElBQUk7UUFDRixxRUFBcUU7UUFDckUsTUFBTSxFQUFFQyxJQUFJLEVBQUUsR0FBR0MsbUJBQU9BLENBQUMsY0FBSTtRQUU3QixvQ0FBb0M7UUFDcENILE9BQU9JLE1BQXFDLEdBQ3hDLENBS0UsR0FDRixJQUFJRixLQUFLO1lBQ1BRLE1BQU1OLFFBQVFFLEdBQUcsQ0FBQ0ssT0FBTyxJQUFJO1lBQzdCQyxNQUFNUixRQUFRRSxHQUFHLENBQUNPLE9BQU8sSUFBSTtZQUM3QkMsVUFBVVYsUUFBUUUsR0FBRyxDQUFDUyxPQUFPLElBQUk7WUFDakNDLFVBQVVaLFFBQVFFLEdBQUcsQ0FBQ1csV0FBVyxJQUFJO1lBQ3JDQyxNQUFNQyxTQUFTZixRQUFRRSxHQUFHLENBQUNjLE9BQU8sSUFBSTtRQUN4QztRQUVKLDRCQUE0QjtRQUM1Qm5CLFFBQVEsT0FBT29CLE1BQU1DO1lBQ25CLElBQUk7Z0JBQ0YsTUFBTUMsUUFBUUMsS0FBS0MsR0FBRztnQkFDdEIsTUFBTUMsTUFBTSxNQUFNMUIsS0FBS0MsS0FBSyxDQUFDb0IsTUFBTUM7Z0JBQ25DLE1BQU1LLFdBQVdILEtBQUtDLEdBQUcsS0FBS0Y7Z0JBRTlCLHVDQUF1QztnQkFDdkMsSUFBSW5CLElBQXFDLEVBQUU7b0JBQ3pDd0IsUUFBUUMsR0FBRyxDQUFDLGtCQUFrQjt3QkFBRVI7d0JBQU1NO3dCQUFVRyxNQUFNSixJQUFJSyxRQUFRO29CQUFDO2dCQUNyRTtnQkFFQSxPQUFPTDtZQUNULEVBQUUsT0FBT00sT0FBTztnQkFDZEosUUFBUUksS0FBSyxDQUFDLHlCQUF5QkE7Z0JBQ3ZDLE1BQU1BO1lBQ1I7UUFDRjtRQUVBLG9DQUFvQztRQUNwQ2hDLEtBQUtpQyxFQUFFLENBQUMsU0FBUyxDQUFDQztZQUNoQk4sUUFBUUksS0FBSyxDQUFDLDhCQUE4QkU7UUFDNUMsOENBQThDO1FBQ2hEO1FBRUFOLFFBQVFDLEdBQUcsQ0FBQztJQUNkLEVBQUUsT0FBT0csT0FBTztRQUNkSixRQUFRSSxLQUFLLENBQUMseUNBQXlDQTtRQUV2RCxzREFBc0Q7UUFDdERoQyxPQUFPO1lBQ0xDLE9BQU87Z0JBQVEsTUFBTSxJQUFJa0MsTUFBTTtZQUFrQztZQUNqRUYsSUFBSSxLQUFPO1FBQ2I7UUFFQWhDLFFBQVE7WUFBYyxNQUFNLElBQUlrQyxNQUFNO1FBQTRDO0lBQ3BGO0FBQ0YsT0FBTyxFQVlOO0FBRUQsbURBQW1EO0FBQ25ELDJFQUEyRTtBQUNwRCIsInNvdXJjZXMiOlsiQzpcXHZpbm9kXFxwcm9qZWN0c1xcaW5udmVzdFxcUE9DXFxpbm52ZXN0YWlcXGxpYlxcZGIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL2RiLmpzXHJcblxyXG4vLyBJbml0aWFsaXplIHF1ZXJ5IGFuZCBwb29sIGFzIG51bGxcclxubGV0IHBvb2wgPSBudWxsO1xyXG5sZXQgcXVlcnkgPSBudWxsO1xyXG5cclxuLy8gT25seSBydW4gdGhpcyBjb2RlIG9uIHRoZSBzZXJ2ZXJcclxuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFNlcnZlci1zaWRlIGNvZGUgLSBpbXBvcnQgcGcgdXNpbmcgcmVxdWlyZSB0byBhdm9pZCB3ZWJwYWNrIGlzc3Vlc1xyXG4gICAgY29uc3QgeyBQb29sIH0gPSByZXF1aXJlKCdwZycpO1xyXG5cclxuICAgIC8vIENyZWF0ZSBhIGRhdGFiYXNlIGNvbm5lY3Rpb24gcG9vbFxyXG4gICAgcG9vbCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgXHJcbiAgICAgID8gbmV3IFBvb2woe1xyXG4gICAgICAgICAgY29ubmVjdGlvblN0cmluZzogcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMLFxyXG4gICAgICAgICAgc3NsOiB7XHJcbiAgICAgICAgICAgIHJlamVjdFVuYXV0aG9yaXplZDogZmFsc2VcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICA6IG5ldyBQb29sKHtcclxuICAgICAgICAgIHVzZXI6IHByb2Nlc3MuZW52LkRCX1VTRVIgfHwgJ3Bvc3RncmVzJyxcclxuICAgICAgICAgIGhvc3Q6IHByb2Nlc3MuZW52LkRCX0hPU1QgfHwgJ2xvY2FsaG9zdCcsXHJcbiAgICAgICAgICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuREJfTkFNRSB8fCAnaW5udmVzdGFpJywgLy8gVXNlIGJ1aWx0LWluIHBvc3RncmVzIGRhdGFiYXNlXHJcbiAgICAgICAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQgfHwgJ1RlbXBAMTIzJyxcclxuICAgICAgICAgIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52LkRCX1BPUlQgfHwgJzU0MzInKSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAvLyBEZWZpbmUgdGhlIHF1ZXJ5IGZ1bmN0aW9uXHJcbiAgICBxdWVyeSA9IGFzeW5jICh0ZXh0LCBwYXJhbXMpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XHJcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9vbC5xdWVyeSh0ZXh0LCBwYXJhbXMpO1xyXG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIExvZyBxdWVyeSBwZXJmb3JtYW5jZSBpbiBkZXZlbG9wbWVudFxyXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRXhlY3V0ZWQgcXVlcnknLCB7IHRleHQsIGR1cmF0aW9uLCByb3dzOiByZXMucm93Q291bnQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgcXVlcnkgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFNldHVwIGV2ZW50IGhhbmRsZXJzIGZvciB0aGUgcG9vbFxyXG4gICAgcG9vbC5vbignZXJyb3InLCAoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgZGF0YWJhc2UgZXJyb3I6JywgZXJyKTtcclxuICAgICAgLy8gRG9uJ3QgY3Jhc2ggdGhlIHNlcnZlciBvbiBjb25uZWN0aW9uIGVycm9yc1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0RhdGFiYXNlIG1vZHVsZSBpbml0aWFsaXplZCBvbiBzZXJ2ZXInKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgZGF0YWJhc2UgbW9kdWxlOicsIGVycm9yKTtcclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIG5vbi1mdW5jdGlvbmFsIHN0dWJzIGlmIGluaXRpYWxpemF0aW9uIGZhaWxzXHJcbiAgICBwb29sID0ge1xyXG4gICAgICBxdWVyeTogKCkgPT4geyB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHBvb2wgbm90IGluaXRpYWxpemVkJyk7IH0sXHJcbiAgICAgIG9uOiAoKSA9PiB7fVxyXG4gICAgfTtcclxuXHJcbiAgICBxdWVyeSA9IGFzeW5jICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBxdWVyeSBmdW5jdGlvbiBub3QgaW5pdGlhbGl6ZWQnKTsgfTtcclxuICB9XHJcbn0gZWxzZSB7XHJcbiAgLy8gQ2xpZW50LXNpZGUgbW9jayBpbXBsZW1lbnRhdGlvblxyXG4gIHF1ZXJ5ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBxdWVyaWVzIGNhbm5vdCBiZSBleGVjdXRlZCBvbiB0aGUgY2xpZW50IHNpZGUnKTtcclxuICB9O1xyXG4gIFxyXG4gIHBvb2wgPSB7XHJcbiAgICBxdWVyeTogKCkgPT4ge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJpZXMgY2Fubm90IGJlIGV4ZWN1dGVkIG9uIHRoZSBjbGllbnQgc2lkZScpO1xyXG4gICAgfSxcclxuICAgIG9uOiAoKSA9PiB7fVxyXG4gIH07XHJcbn1cclxuXHJcbi8vIENob29zZSBvbmUgZXhwb3J0IHN0eWxlIGJhc2VkIG9uIHRoZSBlbnZpcm9ubWVudFxyXG4vLyBVc2UgRVMgbW9kdWxlcyBleHBvcnQgc3R5bGUgc2luY2UgdGhhdCdzIHdoYXQgdGhlIHJlc3Qgb2YgeW91ciBjb2RlIHVzZXNcclxuZXhwb3J0IHsgcXVlcnksIHBvb2wgfTsiXSwibmFtZXMiOlsicG9vbCIsInF1ZXJ5IiwiUG9vbCIsInJlcXVpcmUiLCJwcm9jZXNzIiwiY29ubmVjdGlvblN0cmluZyIsImVudiIsIkRBVEFCQVNFX1VSTCIsInNzbCIsInJlamVjdFVuYXV0aG9yaXplZCIsInVzZXIiLCJEQl9VU0VSIiwiaG9zdCIsIkRCX0hPU1QiLCJkYXRhYmFzZSIsIkRCX05BTUUiLCJwYXNzd29yZCIsIkRCX1BBU1NXT1JEIiwicG9ydCIsInBhcnNlSW50IiwiREJfUE9SVCIsInRleHQiLCJwYXJhbXMiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJyZXMiLCJkdXJhdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJyb3dzIiwicm93Q291bnQiLCJlcnJvciIsIm9uIiwiZXJyIiwiRXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./lib/db.js\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalytics%2Finsights&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Canalytics%5Cinsights.js&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalytics%2Finsights&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Canalytics%5Cinsights.js&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_analytics_insights_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\analytics\\insights.js */ \"(api-node)/./pages/api/analytics/insights.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_analytics_insights_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_analytics_insights_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/analytics/insights\",\n        pathname: \"/api/analytics/insights\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_analytics_insights_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGYW5hbHl0aWNzJTJGaW5zaWdodHMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2FuYWx5dGljcyU1Q2luc2lnaHRzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQ2lFO0FBQ2pFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyw2REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsNkRBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcYW5hbHl0aWNzXFxcXGluc2lnaHRzLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hbmFseXRpY3MvaW5zaWdodHNcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hbmFseXRpY3MvaW5zaWdodHNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalytics%2Finsights&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Canalytics%5Cinsights.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/analytics/insights.js":
/*!*****************************************!*\
  !*** ./pages/api/analytics/insights.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/db */ \"(api-node)/./lib/db.js\");\n// pages/api/analytics/insights.js\n\nasync function handler(req, res) {\n    if (req.method !== 'GET') {\n        res.setHeader('Allow', [\n            'GET'\n        ]);\n        return res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n    try {\n        // Optional limit parameter with default of 5 insights\n        const { limit = 5 } = req.query;\n        const maxInsights = parseInt(limit);\n        // First, check what tables are available in the database\n        const tablesQuery = `\n      SELECT table_name \n      FROM information_schema.tables \n      WHERE table_schema = 'public'\n    `;\n        const tablesResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(tablesQuery);\n        const tables = tablesResult.rows.map((row)=>row.table_name);\n        // Try to check what stored procedures are available\n        let availableFunctions = [];\n        try {\n            const functionsQuery = `\n        SELECT routine_name\n        FROM information_schema.routines\n        WHERE routine_type = 'FUNCTION' \n        AND routine_schema = 'public'\n      `;\n            const functionsResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(functionsQuery);\n            availableFunctions = functionsResult.rows.map((row)=>row.routine_name);\n        } catch (err) {\n            console.error('Error checking available functions:', err);\n        }\n        // Collect insights from multiple sources\n        const insights = [];\n        let insightId = 1;\n        // Try to use functions if they exist\n        for (const functionName of availableFunctions){\n            // Stop adding insights if we've reached the maximum\n            if (insights.length >= maxInsights) break;\n            if ([\n                'analyze_market_dynamics',\n                'find_market_investment_opportunities',\n                'analyze_seasonal_patterns'\n            ].includes(functionName)) {\n                try {\n                    // Call the function with default parameters\n                    const functionQuery = `SELECT * FROM ${functionName}(2023, 2022)`;\n                    const functionResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(functionQuery);\n                    if (functionResult.rows && functionResult.rows.length > 0) {\n                        // Process results based on function name\n                        if (functionName === 'analyze_market_dynamics') {\n                            for (const row of functionResult.rows){\n                                if (insights.length >= maxInsights) break;\n                                if (row.market_name && row.revpar_growth) {\n                                    if (parseFloat(row.revpar_growth) > 5) {\n                                        insights.push({\n                                            id: insightId++,\n                                            type: 'opportunity',\n                                            title: `${row.market_name} RevPAR growth`,\n                                            description: `${row.market_name} shows strong RevPAR growth of ${parseFloat(row.revpar_growth).toFixed(1)}%, indicating a potential investment opportunity.`,\n                                            confidence: parseFloat(row.confidence || 0.85)\n                                        });\n                                    } else if (parseFloat(row.revpar_growth) < 0) {\n                                        insights.push({\n                                            id: insightId++,\n                                            type: 'risk',\n                                            title: `${row.market_name} RevPAR decline`,\n                                            description: `${row.market_name} shows a RevPAR decline of ${parseFloat(row.revpar_growth).toFixed(1)}%, suggesting caution for investments in this market.`,\n                                            confidence: parseFloat(row.confidence || 0.82)\n                                        });\n                                    }\n                                }\n                            }\n                        } else if (functionName === 'find_market_investment_opportunities') {\n                            for (const row of functionResult.rows){\n                                if (insights.length >= maxInsights) break;\n                                insights.push({\n                                    id: insightId++,\n                                    type: 'opportunity',\n                                    title: `${row.market_name} investment opportunity`,\n                                    description: `${row.market_name} shows promising investment potential with estimated returns of ${parseFloat(row.expected_return).toFixed(1)}%.`,\n                                    confidence: parseFloat(row.confidence || 0.88)\n                                });\n                            }\n                        } else if (functionName === 'analyze_seasonal_patterns') {\n                            if (insights.length < maxInsights) {\n                                // Generate insight from seasonal data\n                                const seasons = [];\n                                let highSeason = null;\n                                let highValue = 0;\n                                for (const row of functionResult.rows){\n                                    if (parseFloat(row.occupancy) > highValue) {\n                                        highValue = parseFloat(row.occupancy);\n                                        highSeason = row.month;\n                                    }\n                                    if (parseFloat(row.occupancy) > 0.8) {\n                                        seasons.push(row.month);\n                                    }\n                                }\n                                if (seasons.length > 0) {\n                                    const monthNames = [];\n                                    for (const monthNum of seasons){\n                                        const date = new Date(2023, monthNum - 1, 1);\n                                        monthNames.push(date.toLocaleString('default', {\n                                            month: 'long'\n                                        }));\n                                    }\n                                    insights.push({\n                                        id: insightId++,\n                                        type: 'roi',\n                                        title: 'Seasonal pricing opportunity',\n                                        description: `Demand analysis shows peak periods in ${monthNames.join(', ')}. Optimizing rates during these periods could increase annual returns.`,\n                                        confidence: 0.84\n                                    });\n                                }\n                            }\n                        }\n                    }\n                } catch (err) {\n                    console.error(`Error calling function ${functionName}:`, err);\n                }\n            }\n        }\n        // If we have fact_market_data, generate insights from it\n        if (tables.includes('fact_market_data') && tables.includes('dim_market') && insights.length < maxInsights) {\n            try {\n                // Get top performing markets by RevPAR\n                const topMarketsQuery = `\n          SELECT m.market_name, AVG(f.revpar) as avg_revpar, \n                 CASE WHEN AVG(f.revpar) > 150 THEN 0.9\n                      WHEN AVG(f.revpar) > 120 THEN 0.85\n                      ELSE 0.8 END as confidence\n          FROM fact_market_data f\n          JOIN dim_market m ON f.market_key = m.market_key\n          GROUP BY m.market_name\n          ORDER BY avg_revpar DESC\n          LIMIT ${maxInsights - insights.length}\n        `;\n                const topMarketsResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(topMarketsQuery);\n                if (topMarketsResult.rows && topMarketsResult.rows.length > 0) {\n                    for (const row of topMarketsResult.rows){\n                        if (insights.length >= maxInsights) break;\n                        if (!insights.some((insight)=>insight.title.includes(row.market_name))) {\n                            insights.push({\n                                id: insightId++,\n                                type: 'opportunity',\n                                title: `${row.market_name} market opportunity`,\n                                description: `${row.market_name} shows strong RevPAR performance at $${parseFloat(row.avg_revpar).toFixed(2)}, making it a top market for potential investment.`,\n                                confidence: parseFloat(row.confidence)\n                            });\n                        }\n                    }\n                }\n                // Get markets with high occupancy\n                if (insights.length < maxInsights) {\n                    const highOccupancyQuery = `\n            SELECT m.market_name, AVG(f.occupancy) as avg_occupancy,\n                   CASE WHEN AVG(f.occupancy) > 0.85 THEN 0.88\n                        WHEN AVG(f.occupancy) > 0.8 THEN 0.83\n                        ELSE 0.78 END as confidence\n            FROM fact_market_data f\n            JOIN dim_market m ON f.market_key = m.market_key\n            GROUP BY m.market_name\n            HAVING AVG(f.occupancy) > 0.75\n            ORDER BY avg_occupancy DESC\n            LIMIT ${maxInsights - insights.length}\n          `;\n                    const highOccupancyResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(highOccupancyQuery);\n                    if (highOccupancyResult.rows && highOccupancyResult.rows.length > 0) {\n                        for (const row of highOccupancyResult.rows){\n                            if (insights.length >= maxInsights) break;\n                            if (!insights.some((insight)=>insight.title.includes(row.market_name))) {\n                                insights.push({\n                                    id: insightId++,\n                                    type: 'roi',\n                                    title: `${row.market_name} ADR optimization`,\n                                    description: `With a high average occupancy of ${(parseFloat(row.avg_occupancy) * 100).toFixed(1)}%, ${row.market_name} hotels have potential for ADR optimization to increase RevPAR.`,\n                                    confidence: parseFloat(row.confidence)\n                                });\n                            }\n                        }\n                    }\n                }\n                // Check for markets with high RevPAR growth\n                if (insights.length < maxInsights) {\n                    // Use a query to calculate growth between years if possible\n                    try {\n                        const growthQuery = `\n              WITH current_year AS (\n                SELECT m.market_name, AVG(f.revpar) as revpar\n                FROM fact_market_data f\n                JOIN dim_market m ON f.market_key = m.market_key\n                WHERE f.year = 2023\n                GROUP BY m.market_name\n              ),\n              prev_year AS (\n                SELECT m.market_name, AVG(f.revpar) as revpar\n                FROM fact_market_data f\n                JOIN dim_market m ON f.market_key = m.market_key\n                WHERE f.year = 2022\n                GROUP BY m.market_name\n              )\n              SELECT c.market_name, \n                     c.revpar as current_revpar,\n                     p.revpar as prev_revpar,\n                     ((c.revpar - p.revpar) / p.revpar * 100) as growth,\n                     CASE WHEN ((c.revpar - p.revpar) / p.revpar * 100) > 10 THEN 0.87\n                          WHEN ((c.revpar - p.revpar) / p.revpar * 100) > 5 THEN 0.82\n                          ELSE 0.78 END as confidence\n              FROM current_year c\n              JOIN prev_year p ON c.market_name = p.market_name\n              WHERE ((c.revpar - p.revpar) / p.revpar * 100) > 5\n              ORDER BY growth DESC\n              LIMIT ${maxInsights - insights.length}\n            `;\n                        const growthResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(growthQuery);\n                        if (growthResult.rows && growthResult.rows.length > 0) {\n                            for (const row of growthResult.rows){\n                                if (insights.length >= maxInsights) break;\n                                if (!insights.some((insight)=>insight.title.includes(row.market_name))) {\n                                    insights.push({\n                                        id: insightId++,\n                                        type: 'opportunity',\n                                        title: `${row.market_name} growth trend`,\n                                        description: `${row.market_name} shows YoY RevPAR growth of ${parseFloat(row.growth).toFixed(1)}%, from $${parseFloat(row.prev_revpar).toFixed(2)} to $${parseFloat(row.current_revpar).toFixed(2)}.`,\n                                        confidence: parseFloat(row.confidence)\n                                    });\n                                }\n                            }\n                        }\n                    } catch (err) {\n                        console.error('Error calculating growth insights:', err);\n                    }\n                }\n            } catch (err) {\n                console.error('Error generating insights from fact_market_data:', err);\n            }\n        }\n        // If we have deals table, generate insights from it\n        if (tables.includes('deals') && insights.length < maxInsights) {\n            try {\n                // Check if we have deals with property info\n                const dealsQuery = `\n          SELECT COUNT(*) as deal_count, \n                 AVG(expected_return) as avg_return,\n                 MAX(investment_amount) as max_investment,\n                 MIN(investment_amount) as min_investment\n          FROM deals\n        `;\n                const dealsResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(dealsQuery);\n                if (dealsResult.rows && dealsResult.rows.length > 0) {\n                    const dealCount = parseInt(dealsResult.rows[0].deal_count);\n                    const avgReturn = parseFloat(dealsResult.rows[0].avg_return);\n                    if (dealCount > 0 && insights.length < maxInsights) {\n                        // Generate portfolio diversification insight based on real data\n                        insights.push({\n                            id: insightId++,\n                            type: 'roi',\n                            title: 'Portfolio diversification',\n                            description: `Analysis of your ${dealCount} deals shows an average return of ${avgReturn.toFixed(1)}%. Further geographic diversification could optimize risk-adjusted returns.`,\n                            confidence: 0.86\n                        });\n                    }\n                    // Get status distribution\n                    if (insights.length < maxInsights) {\n                        const statusQuery = `\n              SELECT status, COUNT(*) as count\n              FROM deals\n              GROUP BY status\n              ORDER BY count DESC\n            `;\n                        const statusResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(statusQuery);\n                        if (statusResult.rows && statusResult.rows.length > 0) {\n                            // Generate insight about deal statuses\n                            const draftCount = statusResult.rows.find((r)=>r.status === 'Draft')?.count || 0;\n                            if (draftCount > 0 && insights.length < maxInsights) {\n                                insights.push({\n                                    id: insightId++,\n                                    type: 'risk',\n                                    title: 'Pending deal finalization',\n                                    description: `You have ${draftCount} deals in draft status. Finalizing these deals could help meet your portfolio growth targets.`,\n                                    confidence: 0.85\n                                });\n                            }\n                        }\n                    }\n                }\n            } catch (err) {\n                console.error('Error generating insights from deals table:', err);\n            }\n        }\n        // If we couldn't generate any insights from real data, return an empty array\n        // No mock data fallbacks\n        // Ensure we only return up to maxInsights\n        const limitedInsights = insights.slice(0, maxInsights);\n        res.status(200).json(limitedInsights);\n    } catch (error) {\n        console.error('Error generating insights:', error);\n        // No mock data fallbacks, return empty array on error\n        res.status(200).json([]);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS9hbmFseXRpY3MvaW5zaWdodHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxrQ0FBa0M7QUFDTTtBQUV6QixlQUFlQyxRQUFRQyxHQUFHLEVBQUVDLEdBQUc7SUFDNUMsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLE9BQU87UUFDeEJELElBQUlFLFNBQVMsQ0FBQyxTQUFTO1lBQUM7U0FBTTtRQUM5QixPQUFPRixJQUFJRyxNQUFNLENBQUMsS0FBS0MsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFTCxJQUFJRSxNQUFNLENBQUMsWUFBWSxDQUFDO0lBQy9EO0lBRUEsSUFBSTtRQUNGLHNEQUFzRDtRQUN0RCxNQUFNLEVBQUVJLFFBQVEsQ0FBQyxFQUFFLEdBQUdOLElBQUlGLEtBQUs7UUFDL0IsTUFBTVMsY0FBY0MsU0FBU0Y7UUFFN0IseURBQXlEO1FBQ3pELE1BQU1HLGNBQWMsQ0FBQzs7OztJQUlyQixDQUFDO1FBRUQsTUFBTUMsZUFBZSxNQUFNWiw4Q0FBS0EsQ0FBQ1c7UUFDakMsTUFBTUUsU0FBU0QsYUFBYUUsSUFBSSxDQUFDQyxHQUFHLENBQUNDLENBQUFBLE1BQU9BLElBQUlDLFVBQVU7UUFFMUQsb0RBQW9EO1FBQ3BELElBQUlDLHFCQUFxQixFQUFFO1FBQzNCLElBQUk7WUFDRixNQUFNQyxpQkFBaUIsQ0FBQzs7Ozs7TUFLeEIsQ0FBQztZQUVELE1BQU1DLGtCQUFrQixNQUFNcEIsOENBQUtBLENBQUNtQjtZQUNwQ0QscUJBQXFCRSxnQkFBZ0JOLElBQUksQ0FBQ0MsR0FBRyxDQUFDQyxDQUFBQSxNQUFPQSxJQUFJSyxZQUFZO1FBQ3ZFLEVBQUUsT0FBT0MsS0FBSztZQUNaQyxRQUFRQyxLQUFLLENBQUMsdUNBQXVDRjtRQUN2RDtRQUVBLHlDQUF5QztRQUN6QyxNQUFNRyxXQUFXLEVBQUU7UUFDbkIsSUFBSUMsWUFBWTtRQUVoQixxQ0FBcUM7UUFDckMsS0FBSyxNQUFNQyxnQkFBZ0JULG1CQUFvQjtZQUM3Qyxv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NUQsSUFBSSxDQUFDYyxNQUFNLEdBQUcsR0FBRzs0QkFDckQsdUNBQXVDOzRCQUN2QyxNQUFNK0MsYUFBYUQsYUFBYTVELElBQUksQ0FBQzhELElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRXZFLE1BQU0sS0FBSyxVQUFVd0UsU0FBUzs0QkFFL0UsSUFBSUgsYUFBYSxLQUFLbEQsU0FBU0csTUFBTSxHQUFHbkIsYUFBYTtnQ0FDbkRnQixTQUFTVSxJQUFJLENBQUM7b0NBQ1pDLElBQUlWO29DQUNKVyxNQUFNO29DQUNOQyxPQUFPO29DQUNQQyxhQUFhLENBQUMsU0FBUyxFQUFFb0MsV0FBVyw2RkFBNkYsQ0FBQztvQ0FDbElsQyxZQUFZO2dDQUNkOzRCQUNGO3dCQUNGO29CQUNGO2dCQUNGO1lBQ0YsRUFBRSxPQUFPbkIsS0FBSztnQkFDWkMsUUFBUUMsS0FBSyxDQUFDLCtDQUErQ0Y7WUFDL0Q7UUFDRjtRQUVBLDZFQUE2RTtRQUM3RSx5QkFBeUI7UUFFekIsMENBQTBDO1FBQzFDLE1BQU15RCxrQkFBa0J0RCxTQUFTdUQsS0FBSyxDQUFDLEdBQUd2RTtRQUUxQ04sSUFBSUcsTUFBTSxDQUFDLEtBQUsyRSxJQUFJLENBQUNGO0lBQ3ZCLEVBQUUsT0FBT3ZELE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLDhCQUE4QkE7UUFDNUMsc0RBQXNEO1FBQ3REckIsSUFBSUcsTUFBTSxDQUFDLEtBQUsyRSxJQUFJLENBQUMsRUFBRTtJQUN6QjtBQUNGIiwic291cmNlcyI6WyJDOlxcdmlub2RcXHByb2plY3RzXFxpbm52ZXN0XFxQT0NcXGlubnZlc3RhaVxccGFnZXNcXGFwaVxcYW5hbHl0aWNzXFxpbnNpZ2h0cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9hcGkvYW5hbHl0aWNzL2luc2lnaHRzLmpzXHJcbmltcG9ydCB7IHF1ZXJ5IH0gZnJvbSAnLi4vLi4vLi4vbGliL2RiJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICBpZiAocmVxLm1ldGhvZCAhPT0gJ0dFVCcpIHtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgWydHRVQnXSk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmVuZChgTWV0aG9kICR7cmVxLm1ldGhvZH0gTm90IEFsbG93ZWRgKTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyBPcHRpb25hbCBsaW1pdCBwYXJhbWV0ZXIgd2l0aCBkZWZhdWx0IG9mIDUgaW5zaWdodHNcclxuICAgIGNvbnN0IHsgbGltaXQgPSA1IH0gPSByZXEucXVlcnk7XHJcbiAgICBjb25zdCBtYXhJbnNpZ2h0cyA9IHBhcnNlSW50KGxpbWl0KTtcclxuICAgIFxyXG4gICAgLy8gRmlyc3QsIGNoZWNrIHdoYXQgdGFibGVzIGFyZSBhdmFpbGFibGUgaW4gdGhlIGRhdGFiYXNlXHJcbiAgICBjb25zdCB0YWJsZXNRdWVyeSA9IGBcclxuICAgICAgU0VMRUNUIHRhYmxlX25hbWUgXHJcbiAgICAgIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLnRhYmxlcyBcclxuICAgICAgV0hFUkUgdGFibGVfc2NoZW1hID0gJ3B1YmxpYydcclxuICAgIGA7XHJcbiAgICBcclxuICAgIGNvbnN0IHRhYmxlc1Jlc3VsdCA9IGF3YWl0IHF1ZXJ5KHRhYmxlc1F1ZXJ5KTtcclxuICAgIGNvbnN0IHRhYmxlcyA9IHRhYmxlc1Jlc3VsdC5yb3dzLm1hcChyb3cgPT4gcm93LnRhYmxlX25hbWUpO1xyXG4gICAgXHJcbiAgICAvLyBUcnkgdG8gY2hlY2sgd2hhdCBzdG9yZWQgcHJvY2VkdXJlcyBhcmUgYXZhaWxhYmxlXHJcbiAgICBsZXQgYXZhaWxhYmxlRnVuY3Rpb25zID0gW107XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBmdW5jdGlvbnNRdWVyeSA9IGBcclxuICAgICAgICBTRUxFQ1Qgcm91dGluZV9uYW1lXHJcbiAgICAgICAgRlJPTSBpbmZvcm1hdGlvbl9zY2hlbWEucm91dGluZXNcclxuICAgICAgICBXSEVSRSByb3V0aW5lX3R5cGUgPSAnRlVOQ1RJT04nIFxyXG4gICAgICAgIEFORCByb3V0aW5lX3NjaGVtYSA9ICdwdWJsaWMnXHJcbiAgICAgIGA7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBmdW5jdGlvbnNSZXN1bHQgPSBhd2FpdCBxdWVyeShmdW5jdGlvbnNRdWVyeSk7XHJcbiAgICAgIGF2YWlsYWJsZUZ1bmN0aW9ucyA9IGZ1bmN0aW9uc1Jlc3VsdC5yb3dzLm1hcChyb3cgPT4gcm93LnJvdXRpbmVfbmFtZSk7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hlY2tpbmcgYXZhaWxhYmxlIGZ1bmN0aW9uczonLCBlcnIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDb2xsZWN0IGluc2lnaHRzIGZyb20gbXVsdGlwbGUgc291cmNlc1xyXG4gICAgY29uc3QgaW5zaWdodHMgPSBbXTtcclxuICAgIGxldCBpbnNpZ2h0SWQgPSAxO1xyXG4gICAgXHJcbiAgICAvLyBUcnkgdG8gdXNlIGZ1bmN0aW9ucyBpZiB0aGV5IGV4aXN0XHJcbiAgICBmb3IgKGNvbnN0IGZ1bmN0aW9uTmFtZSBvZiBhdmFpbGFibGVGdW5jdGlvbnMpIHtcclxuICAgICAgLy8gU3RvcCBhZGRpbmcgaW5zaWdodHMgaWYgd2UndmUgcmVhY2hlZCB0aGUgbWF4aW11bVxyXG4gICAgICBpZiAoaW5zaWdodHMubGVuZ3RoID49IG1heEluc2lnaHRzKSBicmVhaztcclxuICAgICAgXHJcbiAgICAgIGlmIChbJ2FuYWx5emVfbWFya2V0X2R5bmFtaWNzJywgJ2ZpbmRfbWFya2V0X2ludmVzdG1lbnRfb3Bwb3J0dW5pdGllcycsICdhbmFseXplX3NlYXNvbmFsX3BhdHRlcm5zJ10uaW5jbHVkZXMoZnVuY3Rpb25OYW1lKSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBDYWxsIHRoZSBmdW5jdGlvbiB3aXRoIGRlZmF1bHQgcGFyYW1ldGVyc1xyXG4gICAgICAgICAgY29uc3QgZnVuY3Rpb25RdWVyeSA9IGBTRUxFQ1QgKiBGUk9NICR7ZnVuY3Rpb25OYW1lfSgyMDIzLCAyMDIyKWA7XHJcbiAgICAgICAgICBjb25zdCBmdW5jdGlvblJlc3VsdCA9IGF3YWl0IHF1ZXJ5KGZ1bmN0aW9uUXVlcnkpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoZnVuY3Rpb25SZXN1bHQucm93cyAmJiBmdW5jdGlvblJlc3VsdC5yb3dzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gUHJvY2VzcyByZXN1bHRzIGJhc2VkIG9uIGZ1bmN0aW9uIG5hbWVcclxuICAgICAgICAgICAgaWYgKGZ1bmN0aW9uTmFtZSA9PT0gJ2FuYWx5emVfbWFya2V0X2R5bmFtaWNzJykge1xyXG4gICAgICAgICAgICAgIGZvciAoY29uc3Qgcm93IG9mIGZ1bmN0aW9uUmVzdWx0LnJvd3MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpbnNpZ2h0cy5sZW5ndGggPj0gbWF4SW5zaWdodHMpIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAocm93Lm1hcmtldF9uYW1lICYmIHJvdy5yZXZwYXJfZ3Jvd3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KHJvdy5yZXZwYXJfZ3Jvd3RoKSA+IDUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnNpZ2h0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgIGlkOiBpbnNpZ2h0SWQrKyxcclxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdvcHBvcnR1bml0eScsXHJcbiAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCR7cm93Lm1hcmtldF9uYW1lfSBSZXZQQVIgZ3Jvd3RoYCxcclxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHtyb3cubWFya2V0X25hbWV9IHNob3dzIHN0cm9uZyBSZXZQQVIgZ3Jvd3RoIG9mICR7cGFyc2VGbG9hdChyb3cucmV2cGFyX2dyb3d0aCkudG9GaXhlZCgxKX0lLCBpbmRpY2F0aW5nIGEgcG90ZW50aWFsIGludmVzdG1lbnQgb3Bwb3J0dW5pdHkuYCxcclxuICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZGVuY2U6IHBhcnNlRmxvYXQocm93LmNvbmZpZGVuY2UgfHwgMC44NSlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJzZUZsb2F0KHJvdy5yZXZwYXJfZ3Jvd3RoKSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnNpZ2h0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgIGlkOiBpbnNpZ2h0SWQrKyxcclxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyaXNrJyxcclxuICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBgJHtyb3cubWFya2V0X25hbWV9IFJldlBBUiBkZWNsaW5lYCxcclxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHtyb3cubWFya2V0X25hbWV9IHNob3dzIGEgUmV2UEFSIGRlY2xpbmUgb2YgJHtwYXJzZUZsb2F0KHJvdy5yZXZwYXJfZ3Jvd3RoKS50b0ZpeGVkKDEpfSUsIHN1Z2dlc3RpbmcgY2F1dGlvbiBmb3IgaW52ZXN0bWVudHMgaW4gdGhpcyBtYXJrZXQuYCxcclxuICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZGVuY2U6IHBhcnNlRmxvYXQocm93LmNvbmZpZGVuY2UgfHwgMC44MilcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChmdW5jdGlvbk5hbWUgPT09ICdmaW5kX21hcmtldF9pbnZlc3RtZW50X29wcG9ydHVuaXRpZXMnKSB7XHJcbiAgICAgICAgICAgICAgZm9yIChjb25zdCByb3cgb2YgZnVuY3Rpb25SZXN1bHQucm93cykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGluc2lnaHRzLmxlbmd0aCA+PSBtYXhJbnNpZ2h0cykgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGluc2lnaHRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICBpZDogaW5zaWdodElkKyssXHJcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdvcHBvcnR1bml0eScsXHJcbiAgICAgICAgICAgICAgICAgIHRpdGxlOiBgJHtyb3cubWFya2V0X25hbWV9IGludmVzdG1lbnQgb3Bwb3J0dW5pdHlgLFxyXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7cm93Lm1hcmtldF9uYW1lfSBzaG93cyBwcm9taXNpbmcgaW52ZXN0bWVudCBwb3RlbnRpYWwgd2l0aCBlc3RpbWF0ZWQgcmV0dXJucyBvZiAke3BhcnNlRmxvYXQocm93LmV4cGVjdGVkX3JldHVybikudG9GaXhlZCgxKX0lLmAsXHJcbiAgICAgICAgICAgICAgICAgIGNvbmZpZGVuY2U6IHBhcnNlRmxvYXQocm93LmNvbmZpZGVuY2UgfHwgMC44OClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChmdW5jdGlvbk5hbWUgPT09ICdhbmFseXplX3NlYXNvbmFsX3BhdHRlcm5zJykge1xyXG4gICAgICAgICAgICAgIGlmIChpbnNpZ2h0cy5sZW5ndGggPCBtYXhJbnNpZ2h0cykge1xyXG4gICAgICAgICAgICAgICAgLy8gR2VuZXJhdGUgaW5zaWdodCBmcm9tIHNlYXNvbmFsIGRhdGFcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlYXNvbnMgPSBbXTtcclxuICAgICAgICAgICAgICAgIGxldCBoaWdoU2Vhc29uID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGxldCBoaWdoVmFsdWUgPSAwO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJvdyBvZiBmdW5jdGlvblJlc3VsdC5yb3dzKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KHJvdy5vY2N1cGFuY3kpID4gaGlnaFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlnaFZhbHVlID0gcGFyc2VGbG9hdChyb3cub2NjdXBhbmN5KTtcclxuICAgICAgICAgICAgICAgICAgICBoaWdoU2Vhc29uID0gcm93Lm1vbnRoO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICBpZiAocGFyc2VGbG9hdChyb3cub2NjdXBhbmN5KSA+IDAuOCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlYXNvbnMucHVzaChyb3cubW9udGgpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmIChzZWFzb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgY29uc3QgbW9udGhOYW1lcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1vbnRoTnVtIG9mIHNlYXNvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoMjAyMywgbW9udGhOdW0gLSAxLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICBtb250aE5hbWVzLnB1c2goZGF0ZS50b0xvY2FsZVN0cmluZygnZGVmYXVsdCcsIHsgbW9udGg6ICdsb25nJyB9KSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgIGluc2lnaHRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBpbnNpZ2h0SWQrKyxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAncm9pJyxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1NlYXNvbmFsIHByaWNpbmcgb3Bwb3J0dW5pdHknLFxyXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgRGVtYW5kIGFuYWx5c2lzIHNob3dzIHBlYWsgcGVyaW9kcyBpbiAke21vbnRoTmFtZXMuam9pbignLCAnKX0uIE9wdGltaXppbmcgcmF0ZXMgZHVyaW5nIHRoZXNlIHBlcmlvZHMgY291bGQgaW5jcmVhc2UgYW5udWFsIHJldHVybnMuYCxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWRlbmNlOiAwLjg0XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgY2FsbGluZyBmdW5jdGlvbiAke2Z1bmN0aW9uTmFtZX06YCwgZXJyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSWYgd2UgaGF2ZSBmYWN0X21hcmtldF9kYXRhLCBnZW5lcmF0ZSBpbnNpZ2h0cyBmcm9tIGl0XHJcbiAgICBpZiAodGFibGVzLmluY2x1ZGVzKCdmYWN0X21hcmtldF9kYXRhJykgJiYgdGFibGVzLmluY2x1ZGVzKCdkaW1fbWFya2V0JykgJiYgaW5zaWdodHMubGVuZ3RoIDwgbWF4SW5zaWdodHMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBHZXQgdG9wIHBlcmZvcm1pbmcgbWFya2V0cyBieSBSZXZQQVJcclxuICAgICAgICBjb25zdCB0b3BNYXJrZXRzUXVlcnkgPSBgXHJcbiAgICAgICAgICBTRUxFQ1QgbS5tYXJrZXRfbmFtZSwgQVZHKGYucmV2cGFyKSBhcyBhdmdfcmV2cGFyLCBcclxuICAgICAgICAgICAgICAgICBDQVNFIFdIRU4gQVZHKGYucmV2cGFyKSA+IDE1MCBUSEVOIDAuOVxyXG4gICAgICAgICAgICAgICAgICAgICAgV0hFTiBBVkcoZi5yZXZwYXIpID4gMTIwIFRIRU4gMC44NVxyXG4gICAgICAgICAgICAgICAgICAgICAgRUxTRSAwLjggRU5EIGFzIGNvbmZpZGVuY2VcclxuICAgICAgICAgIEZST00gZmFjdF9tYXJrZXRfZGF0YSBmXHJcbiAgICAgICAgICBKT0lOIGRpbV9tYXJrZXQgbSBPTiBmLm1hcmtldF9rZXkgPSBtLm1hcmtldF9rZXlcclxuICAgICAgICAgIEdST1VQIEJZIG0ubWFya2V0X25hbWVcclxuICAgICAgICAgIE9SREVSIEJZIGF2Z19yZXZwYXIgREVTQ1xyXG4gICAgICAgICAgTElNSVQgJHttYXhJbnNpZ2h0cyAtIGluc2lnaHRzLmxlbmd0aH1cclxuICAgICAgICBgO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHRvcE1hcmtldHNSZXN1bHQgPSBhd2FpdCBxdWVyeSh0b3BNYXJrZXRzUXVlcnkpO1xyXG4gICAgICAgIGlmICh0b3BNYXJrZXRzUmVzdWx0LnJvd3MgJiYgdG9wTWFya2V0c1Jlc3VsdC5yb3dzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGZvciAoY29uc3Qgcm93IG9mIHRvcE1hcmtldHNSZXN1bHQucm93cykge1xyXG4gICAgICAgICAgICBpZiAoaW5zaWdodHMubGVuZ3RoID49IG1heEluc2lnaHRzKSBicmVhaztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICghaW5zaWdodHMuc29tZShpbnNpZ2h0ID0+IGluc2lnaHQudGl0bGUuaW5jbHVkZXMocm93Lm1hcmtldF9uYW1lKSkpIHtcclxuICAgICAgICAgICAgICBpbnNpZ2h0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGlkOiBpbnNpZ2h0SWQrKyxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdvcHBvcnR1bml0eScsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogYCR7cm93Lm1hcmtldF9uYW1lfSBtYXJrZXQgb3Bwb3J0dW5pdHlgLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGAke3Jvdy5tYXJrZXRfbmFtZX0gc2hvd3Mgc3Ryb25nIFJldlBBUiBwZXJmb3JtYW5jZSBhdCAkJHtwYXJzZUZsb2F0KHJvdy5hdmdfcmV2cGFyKS50b0ZpeGVkKDIpfSwgbWFraW5nIGl0IGEgdG9wIG1hcmtldCBmb3IgcG90ZW50aWFsIGludmVzdG1lbnQuYCxcclxuICAgICAgICAgICAgICAgIGNvbmZpZGVuY2U6IHBhcnNlRmxvYXQocm93LmNvbmZpZGVuY2UpXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2V0IG1hcmtldHMgd2l0aCBoaWdoIG9jY3VwYW5jeVxyXG4gICAgICAgIGlmIChpbnNpZ2h0cy5sZW5ndGggPCBtYXhJbnNpZ2h0cykge1xyXG4gICAgICAgICAgY29uc3QgaGlnaE9jY3VwYW5jeVF1ZXJ5ID0gYFxyXG4gICAgICAgICAgICBTRUxFQ1QgbS5tYXJrZXRfbmFtZSwgQVZHKGYub2NjdXBhbmN5KSBhcyBhdmdfb2NjdXBhbmN5LFxyXG4gICAgICAgICAgICAgICAgICAgQ0FTRSBXSEVOIEFWRyhmLm9jY3VwYW5jeSkgPiAwLjg1IFRIRU4gMC44OFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBXSEVOIEFWRyhmLm9jY3VwYW5jeSkgPiAwLjggVEhFTiAwLjgzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEVMU0UgMC43OCBFTkQgYXMgY29uZmlkZW5jZVxyXG4gICAgICAgICAgICBGUk9NIGZhY3RfbWFya2V0X2RhdGEgZlxyXG4gICAgICAgICAgICBKT0lOIGRpbV9tYXJrZXQgbSBPTiBmLm1hcmtldF9rZXkgPSBtLm1hcmtldF9rZXlcclxuICAgICAgICAgICAgR1JPVVAgQlkgbS5tYXJrZXRfbmFtZVxyXG4gICAgICAgICAgICBIQVZJTkcgQVZHKGYub2NjdXBhbmN5KSA+IDAuNzVcclxuICAgICAgICAgICAgT1JERVIgQlkgYXZnX29jY3VwYW5jeSBERVNDXHJcbiAgICAgICAgICAgIExJTUlUICR7bWF4SW5zaWdodHMgLSBpbnNpZ2h0cy5sZW5ndGh9XHJcbiAgICAgICAgICBgO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBjb25zdCBoaWdoT2NjdXBhbmN5UmVzdWx0ID0gYXdhaXQgcXVlcnkoaGlnaE9jY3VwYW5jeVF1ZXJ5KTtcclxuICAgICAgICAgIGlmIChoaWdoT2NjdXBhbmN5UmVzdWx0LnJvd3MgJiYgaGlnaE9jY3VwYW5jeVJlc3VsdC5yb3dzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByb3cgb2YgaGlnaE9jY3VwYW5jeVJlc3VsdC5yb3dzKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGluc2lnaHRzLmxlbmd0aCA+PSBtYXhJbnNpZ2h0cykgYnJlYWs7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgaWYgKCFpbnNpZ2h0cy5zb21lKGluc2lnaHQgPT4gaW5zaWdodC50aXRsZS5pbmNsdWRlcyhyb3cubWFya2V0X25hbWUpKSkge1xyXG4gICAgICAgICAgICAgICAgaW5zaWdodHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgIGlkOiBpbnNpZ2h0SWQrKyxcclxuICAgICAgICAgICAgICAgICAgdHlwZTogJ3JvaScsXHJcbiAgICAgICAgICAgICAgICAgIHRpdGxlOiBgJHtyb3cubWFya2V0X25hbWV9IEFEUiBvcHRpbWl6YXRpb25gLFxyXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYFdpdGggYSBoaWdoIGF2ZXJhZ2Ugb2NjdXBhbmN5IG9mICR7KHBhcnNlRmxvYXQocm93LmF2Z19vY2N1cGFuY3kpICogMTAwKS50b0ZpeGVkKDEpfSUsICR7cm93Lm1hcmtldF9uYW1lfSBob3RlbHMgaGF2ZSBwb3RlbnRpYWwgZm9yIEFEUiBvcHRpbWl6YXRpb24gdG8gaW5jcmVhc2UgUmV2UEFSLmAsXHJcbiAgICAgICAgICAgICAgICAgIGNvbmZpZGVuY2U6IHBhcnNlRmxvYXQocm93LmNvbmZpZGVuY2UpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIG1hcmtldHMgd2l0aCBoaWdoIFJldlBBUiBncm93dGhcclxuICAgICAgICBpZiAoaW5zaWdodHMubGVuZ3RoIDwgbWF4SW5zaWdodHMpIHtcclxuICAgICAgICAgIC8vIFVzZSBhIHF1ZXJ5IHRvIGNhbGN1bGF0ZSBncm93dGggYmV0d2VlbiB5ZWFycyBpZiBwb3NzaWJsZVxyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgZ3Jvd3RoUXVlcnkgPSBgXHJcbiAgICAgICAgICAgICAgV0lUSCBjdXJyZW50X3llYXIgQVMgKFxyXG4gICAgICAgICAgICAgICAgU0VMRUNUIG0ubWFya2V0X25hbWUsIEFWRyhmLnJldnBhcikgYXMgcmV2cGFyXHJcbiAgICAgICAgICAgICAgICBGUk9NIGZhY3RfbWFya2V0X2RhdGEgZlxyXG4gICAgICAgICAgICAgICAgSk9JTiBkaW1fbWFya2V0IG0gT04gZi5tYXJrZXRfa2V5ID0gbS5tYXJrZXRfa2V5XHJcbiAgICAgICAgICAgICAgICBXSEVSRSBmLnllYXIgPSAyMDIzXHJcbiAgICAgICAgICAgICAgICBHUk9VUCBCWSBtLm1hcmtldF9uYW1lXHJcbiAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICBwcmV2X3llYXIgQVMgKFxyXG4gICAgICAgICAgICAgICAgU0VMRUNUIG0ubWFya2V0X25hbWUsIEFWRyhmLnJldnBhcikgYXMgcmV2cGFyXHJcbiAgICAgICAgICAgICAgICBGUk9NIGZhY3RfbWFya2V0X2RhdGEgZlxyXG4gICAgICAgICAgICAgICAgSk9JTiBkaW1fbWFya2V0IG0gT04gZi5tYXJrZXRfa2V5ID0gbS5tYXJrZXRfa2V5XHJcbiAgICAgICAgICAgICAgICBXSEVSRSBmLnllYXIgPSAyMDIyXHJcbiAgICAgICAgICAgICAgICBHUk9VUCBCWSBtLm1hcmtldF9uYW1lXHJcbiAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgIFNFTEVDVCBjLm1hcmtldF9uYW1lLCBcclxuICAgICAgICAgICAgICAgICAgICAgYy5yZXZwYXIgYXMgY3VycmVudF9yZXZwYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgIHAucmV2cGFyIGFzIHByZXZfcmV2cGFyLFxyXG4gICAgICAgICAgICAgICAgICAgICAoKGMucmV2cGFyIC0gcC5yZXZwYXIpIC8gcC5yZXZwYXIgKiAxMDApIGFzIGdyb3d0aCxcclxuICAgICAgICAgICAgICAgICAgICAgQ0FTRSBXSEVOICgoYy5yZXZwYXIgLSBwLnJldnBhcikgLyBwLnJldnBhciAqIDEwMCkgPiAxMCBUSEVOIDAuODdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBXSEVOICgoYy5yZXZwYXIgLSBwLnJldnBhcikgLyBwLnJldnBhciAqIDEwMCkgPiA1IFRIRU4gMC44MlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIEVMU0UgMC43OCBFTkQgYXMgY29uZmlkZW5jZVxyXG4gICAgICAgICAgICAgIEZST00gY3VycmVudF95ZWFyIGNcclxuICAgICAgICAgICAgICBKT0lOIHByZXZfeWVhciBwIE9OIGMubWFya2V0X25hbWUgPSBwLm1hcmtldF9uYW1lXHJcbiAgICAgICAgICAgICAgV0hFUkUgKChjLnJldnBhciAtIHAucmV2cGFyKSAvIHAucmV2cGFyICogMTAwKSA+IDVcclxuICAgICAgICAgICAgICBPUkRFUiBCWSBncm93dGggREVTQ1xyXG4gICAgICAgICAgICAgIExJTUlUICR7bWF4SW5zaWdodHMgLSBpbnNpZ2h0cy5sZW5ndGh9XHJcbiAgICAgICAgICAgIGA7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBncm93dGhSZXN1bHQgPSBhd2FpdCBxdWVyeShncm93dGhRdWVyeSk7XHJcbiAgICAgICAgICAgIGlmIChncm93dGhSZXN1bHQucm93cyAmJiBncm93dGhSZXN1bHQucm93cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgZm9yIChjb25zdCByb3cgb2YgZ3Jvd3RoUmVzdWx0LnJvd3MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpbnNpZ2h0cy5sZW5ndGggPj0gbWF4SW5zaWdodHMpIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoIWluc2lnaHRzLnNvbWUoaW5zaWdodCA9PiBpbnNpZ2h0LnRpdGxlLmluY2x1ZGVzKHJvdy5tYXJrZXRfbmFtZSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgIGluc2lnaHRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBpbnNpZ2h0SWQrKyxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnb3Bwb3J0dW5pdHknLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBgJHtyb3cubWFya2V0X25hbWV9IGdyb3d0aCB0cmVuZGAsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGAke3Jvdy5tYXJrZXRfbmFtZX0gc2hvd3MgWW9ZIFJldlBBUiBncm93dGggb2YgJHtwYXJzZUZsb2F0KHJvdy5ncm93dGgpLnRvRml4ZWQoMSl9JSwgZnJvbSAkJHtwYXJzZUZsb2F0KHJvdy5wcmV2X3JldnBhcikudG9GaXhlZCgyKX0gdG8gJCR7cGFyc2VGbG9hdChyb3cuY3VycmVudF9yZXZwYXIpLnRvRml4ZWQoMil9LmAsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlkZW5jZTogcGFyc2VGbG9hdChyb3cuY29uZmlkZW5jZSlcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2FsY3VsYXRpbmcgZ3Jvd3RoIGluc2lnaHRzOicsIGVycik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIGluc2lnaHRzIGZyb20gZmFjdF9tYXJrZXRfZGF0YTonLCBlcnIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElmIHdlIGhhdmUgZGVhbHMgdGFibGUsIGdlbmVyYXRlIGluc2lnaHRzIGZyb20gaXRcclxuICAgIGlmICh0YWJsZXMuaW5jbHVkZXMoJ2RlYWxzJykgJiYgaW5zaWdodHMubGVuZ3RoIDwgbWF4SW5zaWdodHMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGRlYWxzIHdpdGggcHJvcGVydHkgaW5mb1xyXG4gICAgICAgIGNvbnN0IGRlYWxzUXVlcnkgPSBgXHJcbiAgICAgICAgICBTRUxFQ1QgQ09VTlQoKikgYXMgZGVhbF9jb3VudCwgXHJcbiAgICAgICAgICAgICAgICAgQVZHKGV4cGVjdGVkX3JldHVybikgYXMgYXZnX3JldHVybixcclxuICAgICAgICAgICAgICAgICBNQVgoaW52ZXN0bWVudF9hbW91bnQpIGFzIG1heF9pbnZlc3RtZW50LFxyXG4gICAgICAgICAgICAgICAgIE1JTihpbnZlc3RtZW50X2Ftb3VudCkgYXMgbWluX2ludmVzdG1lbnRcclxuICAgICAgICAgIEZST00gZGVhbHNcclxuICAgICAgICBgO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGRlYWxzUmVzdWx0ID0gYXdhaXQgcXVlcnkoZGVhbHNRdWVyeSk7XHJcbiAgICAgICAgaWYgKGRlYWxzUmVzdWx0LnJvd3MgJiYgZGVhbHNSZXN1bHQucm93cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCBkZWFsQ291bnQgPSBwYXJzZUludChkZWFsc1Jlc3VsdC5yb3dzWzBdLmRlYWxfY291bnQpO1xyXG4gICAgICAgICAgY29uc3QgYXZnUmV0dXJuID0gcGFyc2VGbG9hdChkZWFsc1Jlc3VsdC5yb3dzWzBdLmF2Z19yZXR1cm4pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoZGVhbENvdW50ID4gMCAmJiBpbnNpZ2h0cy5sZW5ndGggPCBtYXhJbnNpZ2h0cykge1xyXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBwb3J0Zm9saW8gZGl2ZXJzaWZpY2F0aW9uIGluc2lnaHQgYmFzZWQgb24gcmVhbCBkYXRhXHJcbiAgICAgICAgICAgIGluc2lnaHRzLnB1c2goe1xyXG4gICAgICAgICAgICAgIGlkOiBpbnNpZ2h0SWQrKyxcclxuICAgICAgICAgICAgICB0eXBlOiAncm9pJyxcclxuICAgICAgICAgICAgICB0aXRsZTogJ1BvcnRmb2xpbyBkaXZlcnNpZmljYXRpb24nLFxyXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgQW5hbHlzaXMgb2YgeW91ciAke2RlYWxDb3VudH0gZGVhbHMgc2hvd3MgYW4gYXZlcmFnZSByZXR1cm4gb2YgJHthdmdSZXR1cm4udG9GaXhlZCgxKX0lLiBGdXJ0aGVyIGdlb2dyYXBoaWMgZGl2ZXJzaWZpY2F0aW9uIGNvdWxkIG9wdGltaXplIHJpc2stYWRqdXN0ZWQgcmV0dXJucy5gLFxyXG4gICAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuODZcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIEdldCBzdGF0dXMgZGlzdHJpYnV0aW9uXHJcbiAgICAgICAgICBpZiAoaW5zaWdodHMubGVuZ3RoIDwgbWF4SW5zaWdodHMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3RhdHVzUXVlcnkgPSBgXHJcbiAgICAgICAgICAgICAgU0VMRUNUIHN0YXR1cywgQ09VTlQoKikgYXMgY291bnRcclxuICAgICAgICAgICAgICBGUk9NIGRlYWxzXHJcbiAgICAgICAgICAgICAgR1JPVVAgQlkgc3RhdHVzXHJcbiAgICAgICAgICAgICAgT1JERVIgQlkgY291bnQgREVTQ1xyXG4gICAgICAgICAgICBgO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3Qgc3RhdHVzUmVzdWx0ID0gYXdhaXQgcXVlcnkoc3RhdHVzUXVlcnkpO1xyXG4gICAgICAgICAgICBpZiAoc3RhdHVzUmVzdWx0LnJvd3MgJiYgc3RhdHVzUmVzdWx0LnJvd3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgIC8vIEdlbmVyYXRlIGluc2lnaHQgYWJvdXQgZGVhbCBzdGF0dXNlc1xyXG4gICAgICAgICAgICAgIGNvbnN0IGRyYWZ0Q291bnQgPSBzdGF0dXNSZXN1bHQucm93cy5maW5kKHIgPT4gci5zdGF0dXMgPT09ICdEcmFmdCcpPy5jb3VudCB8fCAwO1xyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIGlmIChkcmFmdENvdW50ID4gMCAmJiBpbnNpZ2h0cy5sZW5ndGggPCBtYXhJbnNpZ2h0cykge1xyXG4gICAgICAgICAgICAgICAgaW5zaWdodHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgIGlkOiBpbnNpZ2h0SWQrKyxcclxuICAgICAgICAgICAgICAgICAgdHlwZTogJ3Jpc2snLFxyXG4gICAgICAgICAgICAgICAgICB0aXRsZTogJ1BlbmRpbmcgZGVhbCBmaW5hbGl6YXRpb24nLFxyXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYFlvdSBoYXZlICR7ZHJhZnRDb3VudH0gZGVhbHMgaW4gZHJhZnQgc3RhdHVzLiBGaW5hbGl6aW5nIHRoZXNlIGRlYWxzIGNvdWxkIGhlbHAgbWVldCB5b3VyIHBvcnRmb2xpbyBncm93dGggdGFyZ2V0cy5gLFxyXG4gICAgICAgICAgICAgICAgICBjb25maWRlbmNlOiAwLjg1XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgaW5zaWdodHMgZnJvbSBkZWFscyB0YWJsZTonLCBlcnIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElmIHdlIGNvdWxkbid0IGdlbmVyYXRlIGFueSBpbnNpZ2h0cyBmcm9tIHJlYWwgZGF0YSwgcmV0dXJuIGFuIGVtcHR5IGFycmF5XHJcbiAgICAvLyBObyBtb2NrIGRhdGEgZmFsbGJhY2tzXHJcbiAgICBcclxuICAgIC8vIEVuc3VyZSB3ZSBvbmx5IHJldHVybiB1cCB0byBtYXhJbnNpZ2h0c1xyXG4gICAgY29uc3QgbGltaXRlZEluc2lnaHRzID0gaW5zaWdodHMuc2xpY2UoMCwgbWF4SW5zaWdodHMpO1xyXG4gICAgXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihsaW1pdGVkSW5zaWdodHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIGluc2lnaHRzOicsIGVycm9yKTtcclxuICAgIC8vIE5vIG1vY2sgZGF0YSBmYWxsYmFja3MsIHJldHVybiBlbXB0eSBhcnJheSBvbiBlcnJvclxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oW10pO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJxdWVyeSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzZXRIZWFkZXIiLCJzdGF0dXMiLCJlbmQiLCJsaW1pdCIsIm1heEluc2lnaHRzIiwicGFyc2VJbnQiLCJ0YWJsZXNRdWVyeSIsInRhYmxlc1Jlc3VsdCIsInRhYmxlcyIsInJvd3MiLCJtYXAiLCJyb3ciLCJ0YWJsZV9uYW1lIiwiYXZhaWxhYmxlRnVuY3Rpb25zIiwiZnVuY3Rpb25zUXVlcnkiLCJmdW5jdGlvbnNSZXN1bHQiLCJyb3V0aW5lX25hbWUiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJpbnNpZ2h0cyIsImluc2lnaHRJZCIsImZ1bmN0aW9uTmFtZSIsImxlbmd0aCIsImluY2x1ZGVzIiwiZnVuY3Rpb25RdWVyeSIsImZ1bmN0aW9uUmVzdWx0IiwibWFya2V0X25hbWUiLCJyZXZwYXJfZ3Jvd3RoIiwicGFyc2VGbG9hdCIsInB1c2giLCJpZCIsInR5cGUiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwidG9GaXhlZCIsImNvbmZpZGVuY2UiLCJleHBlY3RlZF9yZXR1cm4iLCJzZWFzb25zIiwiaGlnaFNlYXNvbiIsImhpZ2hWYWx1ZSIsIm9jY3VwYW5jeSIsIm1vbnRoIiwibW9udGhOYW1lcyIsIm1vbnRoTnVtIiwiZGF0ZSIsIkRhdGUiLCJ0b0xvY2FsZVN0cmluZyIsImpvaW4iLCJ0b3BNYXJrZXRzUXVlcnkiLCJ0b3BNYXJrZXRzUmVzdWx0Iiwic29tZSIsImluc2lnaHQiLCJhdmdfcmV2cGFyIiwiaGlnaE9jY3VwYW5jeVF1ZXJ5IiwiaGlnaE9jY3VwYW5jeVJlc3VsdCIsImF2Z19vY2N1cGFuY3kiLCJncm93dGhRdWVyeSIsImdyb3d0aFJlc3VsdCIsImdyb3d0aCIsInByZXZfcmV2cGFyIiwiY3VycmVudF9yZXZwYXIiLCJkZWFsc1F1ZXJ5IiwiZGVhbHNSZXN1bHQiLCJkZWFsQ291bnQiLCJkZWFsX2NvdW50IiwiYXZnUmV0dXJuIiwiYXZnX3JldHVybiIsInN0YXR1c1F1ZXJ5Iiwic3RhdHVzUmVzdWx0IiwiZHJhZnRDb3VudCIsImZpbmQiLCJyIiwiY291bnQiLCJsaW1pdGVkSW5zaWdodHMiLCJzbGljZSIsImpzb24iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/analytics/insights.js\n");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalytics%2Finsights&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Canalytics%5Cinsights.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();