"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/properties/search";
exports.ids = ["pages/api/properties/search"];
exports.modules = {

/***/ "(api-node)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pool: () => (/* binding */ pool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n// lib/db.js\n// Initialize query and pool as null\nlet pool = null;\nlet query = null;\n// Only run this code on the server\nif (true) {\n    try {\n        // Server-side code - import pg using require to avoid webpack issues\n        const { Pool } = __webpack_require__(/*! pg */ \"pg\");\n        // Create a database connection pool\n        pool =  false ? 0 : new Pool({\n            user: process.env.DB_USER || 'postgres',\n            host: process.env.DB_HOST || 'localhost',\n            database: process.env.DB_NAME || 'innvestai',\n            password: process.env.DB_PASSWORD || 'Temp@123',\n            port: parseInt(process.env.DB_PORT || '5432')\n        });\n        // Define the query function\n        query = async (text, params)=>{\n            try {\n                const start = Date.now();\n                const res = await pool.query(text, params);\n                const duration = Date.now() - start;\n                // Log query performance in development\n                if (true) {\n                    console.log('Executed query', {\n                        text,\n                        duration,\n                        rows: res.rowCount\n                    });\n                }\n                return res;\n            } catch (error) {\n                console.error('Database query error:', error);\n                throw error;\n            }\n        };\n        // Setup event handlers for the pool\n        pool.on('error', (err)=>{\n            console.error('Unexpected database error:', err);\n        // Don't crash the server on connection errors\n        });\n        console.log('Database module initialized on server');\n    } catch (error) {\n        console.error('Failed to initialize database module:', error);\n        // Create non-functional stubs if initialization fails\n        pool = {\n            query: ()=>{\n                throw new Error('Database pool not initialized');\n            },\n            on: ()=>{}\n        };\n        query = async ()=>{\n            throw new Error('Database query function not initialized');\n        };\n    }\n} else {}\n// Next.js supports ES modules by default\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL2xpYi9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLFlBQVk7QUFFWixvQ0FBb0M7QUFDcEMsSUFBSUEsT0FBTztBQUNYLElBQUlDLFFBQVE7QUFFWixtQ0FBbUM7QUFDbkMsSUFBSSxJQUE2QixFQUFFO0lBQ2pDLElBQUk7UUFDRixxRUFBcUU7UUFDckUsTUFBTSxFQUFFQyxJQUFJLEVBQUUsR0FBR0MsbUJBQU9BLENBQUMsY0FBSTtRQUU3QixvQ0FBb0M7UUFDcENILE9BQU9JLE1BQXFDLEdBQ3hDLENBS0UsR0FDRixJQUFJRixLQUFLO1lBQ1BRLE1BQU1OLFFBQVFFLEdBQUcsQ0FBQ0ssT0FBTyxJQUFJO1lBQzdCQyxNQUFNUixRQUFRRSxHQUFHLENBQUNPLE9BQU8sSUFBSTtZQUM3QkMsVUFBVVYsUUFBUUUsR0FBRyxDQUFDUyxPQUFPLElBQUk7WUFDakNDLFVBQVVaLFFBQVFFLEdBQUcsQ0FBQ1csV0FBVyxJQUFJO1lBQ3JDQyxNQUFNQyxTQUFTZixRQUFRRSxHQUFHLENBQUNjLE9BQU8sSUFBSTtRQUN4QztRQUVKLDRCQUE0QjtRQUM1Qm5CLFFBQVEsT0FBT29CLE1BQU1DO1lBQ25CLElBQUk7Z0JBQ0YsTUFBTUMsUUFBUUMsS0FBS0MsR0FBRztnQkFDdEIsTUFBTUMsTUFBTSxNQUFNMUIsS0FBS0MsS0FBSyxDQUFDb0IsTUFBTUM7Z0JBQ25DLE1BQU1LLFdBQVdILEtBQUtDLEdBQUcsS0FBS0Y7Z0JBRTlCLHVDQUF1QztnQkFDdkMsSUFBSW5CLElBQXFDLEVBQUU7b0JBQ3pDd0IsUUFBUUMsR0FBRyxDQUFDLGtCQUFrQjt3QkFBRVI7d0JBQU1NO3dCQUFVRyxNQUFNSixJQUFJSyxRQUFRO29CQUFDO2dCQUNyRTtnQkFFQSxPQUFPTDtZQUNULEVBQUUsT0FBT00sT0FBTztnQkFDZEosUUFBUUksS0FBSyxDQUFDLHlCQUF5QkE7Z0JBQ3ZDLE1BQU1BO1lBQ1I7UUFDRjtRQUVBLG9DQUFvQztRQUNwQ2hDLEtBQUtpQyxFQUFFLENBQUMsU0FBUyxDQUFDQztZQUNoQk4sUUFBUUksS0FBSyxDQUFDLDhCQUE4QkU7UUFDNUMsOENBQThDO1FBQ2hEO1FBRUFOLFFBQVFDLEdBQUcsQ0FBQztJQUNkLEVBQUUsT0FBT0csT0FBTztRQUNkSixRQUFRSSxLQUFLLENBQUMseUNBQXlDQTtRQUV2RCxzREFBc0Q7UUFDdERoQyxPQUFPO1lBQ0xDLE9BQU87Z0JBQVEsTUFBTSxJQUFJa0MsTUFBTTtZQUFrQztZQUNqRUYsSUFBSSxLQUFPO1FBQ2I7UUFFQWhDLFFBQVE7WUFBYyxNQUFNLElBQUlrQyxNQUFNO1FBQTRDO0lBQ3BGO0FBQ0YsT0FBTyxFQVlOO0FBRUQseUNBQXlDO0FBQ2xCIiwic291cmNlcyI6WyJDOlxcdmlub2RcXHByb2plY3RzXFxpbm52ZXN0XFxQT0NcXGlubnZlc3RhaVxcbGliXFxkYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvZGIuanNcclxuXHJcbi8vIEluaXRpYWxpemUgcXVlcnkgYW5kIHBvb2wgYXMgbnVsbFxyXG5sZXQgcG9vbCA9IG51bGw7XHJcbmxldCBxdWVyeSA9IG51bGw7XHJcblxyXG4vLyBPbmx5IHJ1biB0aGlzIGNvZGUgb24gdGhlIHNlcnZlclxyXG5pZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gU2VydmVyLXNpZGUgY29kZSAtIGltcG9ydCBwZyB1c2luZyByZXF1aXJlIHRvIGF2b2lkIHdlYnBhY2sgaXNzdWVzXHJcbiAgICBjb25zdCB7IFBvb2wgfSA9IHJlcXVpcmUoJ3BnJyk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgZGF0YWJhc2UgY29ubmVjdGlvbiBwb29sXHJcbiAgICBwb29sID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyBcclxuICAgICAgPyBuZXcgUG9vbCh7XHJcbiAgICAgICAgICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwsXHJcbiAgICAgICAgICBzc2w6IHtcclxuICAgICAgICAgICAgcmVqZWN0VW5hdXRob3JpemVkOiBmYWxzZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgIDogbmV3IFBvb2woe1xyXG4gICAgICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuREJfVVNFUiB8fCAncG9zdGdyZXMnLFxyXG4gICAgICAgICAgaG9zdDogcHJvY2Vzcy5lbnYuREJfSE9TVCB8fCAnbG9jYWxob3N0JyxcclxuICAgICAgICAgIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5EQl9OQU1FIHx8ICdpbm52ZXN0YWknLCAvLyBVc2UgYnVpbHQtaW4gcG9zdGdyZXMgZGF0YWJhc2VcclxuICAgICAgICAgIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCAnVGVtcEAxMjMnLFxyXG4gICAgICAgICAgcG9ydDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfUE9SVCB8fCAnNTQzMicpLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIC8vIERlZmluZSB0aGUgcXVlcnkgZnVuY3Rpb25cclxuICAgIHF1ZXJ5ID0gYXN5bmMgKHRleHQsIHBhcmFtcykgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBwb29sLnF1ZXJ5KHRleHQsIHBhcmFtcyk7XHJcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnQ7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTG9nIHF1ZXJ5IHBlcmZvcm1hbmNlIGluIGRldmVsb3BtZW50XHJcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdFeGVjdXRlZCBxdWVyeScsIHsgdGV4dCwgZHVyYXRpb24sIHJvd3M6IHJlcy5yb3dDb3VudCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBxdWVyeSBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gU2V0dXAgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSBwb29sXHJcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcignVW5leHBlY3RlZCBkYXRhYmFzZSBlcnJvcjonLCBlcnIpO1xyXG4gICAgICAvLyBEb24ndCBjcmFzaCB0aGUgc2VydmVyIG9uIGNvbm5lY3Rpb24gZXJyb3JzXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgbW9kdWxlIGluaXRpYWxpemVkIG9uIHNlcnZlcicpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkYXRhYmFzZSBtb2R1bGU6JywgZXJyb3IpO1xyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgbm9uLWZ1bmN0aW9uYWwgc3R1YnMgaWYgaW5pdGlhbGl6YXRpb24gZmFpbHNcclxuICAgIHBvb2wgPSB7XHJcbiAgICAgIHF1ZXJ5OiAoKSA9PiB7IHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcG9vbCBub3QgaW5pdGlhbGl6ZWQnKTsgfSxcclxuICAgICAgb246ICgpID0+IHt9XHJcbiAgICB9O1xyXG5cclxuICAgIHF1ZXJ5ID0gYXN5bmMgKCkgPT4geyB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGZ1bmN0aW9uIG5vdCBpbml0aWFsaXplZCcpOyB9O1xyXG4gIH1cclxufSBlbHNlIHtcclxuICAvLyBDbGllbnQtc2lkZSBtb2NrIGltcGxlbWVudGF0aW9uXHJcbiAgcXVlcnkgPSBhc3luYyAoKSA9PiB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJpZXMgY2Fubm90IGJlIGV4ZWN1dGVkIG9uIHRoZSBjbGllbnQgc2lkZScpO1xyXG4gIH07XHJcbiAgXHJcbiAgcG9vbCA9IHtcclxuICAgIHF1ZXJ5OiAoKSA9PiB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcXVlcmllcyBjYW5ub3QgYmUgZXhlY3V0ZWQgb24gdGhlIGNsaWVudCBzaWRlJyk7XHJcbiAgICB9LFxyXG4gICAgb246ICgpID0+IHt9XHJcbiAgfTtcclxufVxyXG5cclxuLy8gTmV4dC5qcyBzdXBwb3J0cyBFUyBtb2R1bGVzIGJ5IGRlZmF1bHRcclxuZXhwb3J0IHsgcXVlcnksIHBvb2wgfTsiXSwibmFtZXMiOlsicG9vbCIsInF1ZXJ5IiwiUG9vbCIsInJlcXVpcmUiLCJwcm9jZXNzIiwiY29ubmVjdGlvblN0cmluZyIsImVudiIsIkRBVEFCQVNFX1VSTCIsInNzbCIsInJlamVjdFVuYXV0aG9yaXplZCIsInVzZXIiLCJEQl9VU0VSIiwiaG9zdCIsIkRCX0hPU1QiLCJkYXRhYmFzZSIsIkRCX05BTUUiLCJwYXNzd29yZCIsIkRCX1BBU1NXT1JEIiwicG9ydCIsInBhcnNlSW50IiwiREJfUE9SVCIsInRleHQiLCJwYXJhbXMiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJyZXMiLCJkdXJhdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJyb3dzIiwicm93Q291bnQiLCJlcnJvciIsIm9uIiwiZXJyIiwiRXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./lib/db.js\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproperties%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cproperties%5Csearch.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproperties%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cproperties%5Csearch.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_properties_search_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\properties\\search.js */ \"(api-node)/./pages/api/properties/search.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_properties_search_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_properties_search_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/properties/search\",\n        pathname: \"/api/properties/search\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_properties_search_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGcHJvcGVydGllcyUyRnNlYXJjaCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDcHJvcGVydGllcyU1Q3NlYXJjaC5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDRTtBQUMxRDtBQUNnRTtBQUNoRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsNERBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDREQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLHlHQUFtQjtBQUNsRDtBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXHByb3BlcnRpZXNcXFxcc2VhcmNoLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9wcm9wZXJ0aWVzL3NlYXJjaFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Byb3BlcnRpZXMvc2VhcmNoXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproperties%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cproperties%5Csearch.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/properties/search.js":
/*!****************************************!*\
  !*** ./pages/api/properties/search.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/db */ \"(api-node)/./lib/db.js\");\n// pages/api/properties/search.js\n\nasync function handler(req, res) {\n    if (req.method !== 'GET') {\n        return res.status(405).json({\n            error: 'Method not allowed'\n        });\n    }\n    // Get the search query from the request\n    const { query: searchQuery } = req.query;\n    console.log('Search query received:', searchQuery);\n    if (!searchQuery || searchQuery.length < 2) {\n        console.log('Search query too short, returning empty results');\n        return res.status(200).json({\n            properties: []\n        });\n    }\n    try {\n        // Dynamically adapt to your database schema\n        console.log('Determining database schema...');\n        // Get information about the dim_property table\n        const tableCheckQuery = `\n      SELECT EXISTS (\n        SELECT FROM information_schema.tables \n        WHERE table_schema = 'public' \n        AND table_name = 'dim_property'\n      );\n    `;\n        const tableExists = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(tableCheckQuery);\n        console.log('dim_property table exists:', tableExists.rows[0].exists);\n        // If the dim_property table doesn't exist, we should check for alternative tables\n        if (!tableExists.rows[0].exists) {\n            console.log('dim_property table not found, checking for alternative property tables...');\n            // Check for any table that might contain properties\n            const alternativeTablesQuery = `\n        SELECT table_name \n        FROM information_schema.tables \n        WHERE table_schema = 'public' \n        AND (\n          table_name LIKE '%property%' \n          OR table_name LIKE '%hotel%' \n          OR table_name LIKE '%properties%'\n        );\n      `;\n            const alternativeTables = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(alternativeTablesQuery);\n            console.log('Alternative property tables found:', alternativeTables.rows);\n            if (alternativeTables.rows.length === 0) {\n                console.log('No property tables found, returning empty results');\n                return res.status(200).json({\n                    properties: []\n                });\n            }\n            // Use the first alternative table\n            const alternativeTable = alternativeTables.rows[0].table_name;\n            console.log('Using alternative table:', alternativeTable);\n            // Get columns from alternative table\n            const columnsQuery = `\n        SELECT column_name \n        FROM information_schema.columns \n        WHERE table_schema = 'public' \n        AND table_name = $1;\n      `;\n            const columns = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(columnsQuery, [\n                alternativeTable\n            ]);\n            const columnNames = columns.rows.map((row)=>row.column_name);\n            console.log('Columns in alternative table:', columnNames);\n            // Find ID column (look for any column with 'id' or 'key' in the name)\n            const idColumn = columnNames.find((col)=>col.includes('id') || col.includes('key')) || columnNames[0];\n            // Find name column (look for any column with 'name' in the name)\n            const nameColumn = columnNames.find((col)=>col.includes('name')) || columnNames[1];\n            // Perform search on alternative table\n            const searchQuery = `\n        SELECT \n          ${idColumn} as property_key, \n          ${nameColumn} as property_name\n        FROM ${alternativeTable}\n        WHERE ${nameColumn} ILIKE $1\n        LIMIT 10;\n      `;\n            console.log('Running search query on alternative table:', searchQuery);\n            const searchResults = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(searchQuery, [\n                `%${searchQuery}%`\n            ]);\n            return res.status(200).json({\n                properties: searchResults.rows\n            });\n        }\n        // If we reach here, the dim_property table exists\n        // Get the columns from the dim_property table\n        const columnsQuery = `\n      SELECT column_name \n      FROM information_schema.columns \n      WHERE table_schema = 'public' \n      AND table_name = 'dim_property';\n    `;\n        const columns = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(columnsQuery);\n        const columnNames = columns.rows.map((row)=>row.column_name);\n        console.log('Columns in dim_property:', columnNames);\n        // Determine key columns to use in the query\n        const idColumn = columnNames.includes('property_key') ? 'property_key' : columnNames.includes('id') ? 'id' : columnNames.find((col)=>col.includes('id') || col.includes('key')) || 'id';\n        const nameColumn = columnNames.includes('property_name') ? 'property_name' : columnNames.includes('name') ? 'name' : columnNames.find((col)=>col.includes('name')) || 'property_name';\n        const addressColumn = columnNames.includes('address') ? 'address' : columnNames.includes('property_address') ? 'property_address' : null;\n        const roomsColumn = columnNames.includes('number_of_rooms') ? 'number_of_rooms' : columnNames.includes('rooms') ? 'rooms' : null;\n        const typeColumn = columnNames.includes('property_type') ? 'property_type' : columnNames.includes('type') ? 'type' : columnNames.includes('hotel_type_key') ? 'hotel_type_key' : null;\n        // Check if we have city and state columns or need to join with other tables\n        const hasCityColumn = columnNames.includes('city') || columnNames.includes('city_key');\n        const hasStateColumn = columnNames.includes('state') || columnNames.includes('state_key');\n        // Build the search query based on available columns\n        let searchQueryText = `\n      SELECT \n        p.${idColumn} as property_key, \n        p.${nameColumn} as property_name\n    `;\n        if (addressColumn) {\n            searchQueryText += `, p.${addressColumn} as property_address`;\n        }\n        if (roomsColumn) {\n            searchQueryText += `, p.${roomsColumn} as number_of_rooms`;\n        }\n        // Handle city and state\n        if (hasCityColumn) {\n            if (columnNames.includes('city')) {\n                searchQueryText += `, p.city`;\n            } else if (columnNames.includes('city_key')) {\n                // Check if dim_city table exists for joining\n                const cityTableQuery = `\n          SELECT EXISTS (\n            SELECT FROM information_schema.tables \n            WHERE table_schema = 'public' \n            AND table_name = 'dim_city'\n          );\n        `;\n                const cityTableExists = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(cityTableQuery);\n                if (cityTableExists.rows[0].exists) {\n                    searchQueryText += `, c.city_name as city`;\n                }\n            }\n        }\n        if (hasStateColumn) {\n            if (columnNames.includes('state')) {\n                searchQueryText += `, p.state`;\n            } else if (columnNames.includes('state_key')) {\n                // Check if dim_state table exists for joining\n                const stateTableQuery = `\n          SELECT EXISTS (\n            SELECT FROM information_schema.tables \n            WHERE table_schema = 'public' \n            AND table_name = 'dim_state'\n          );\n        `;\n                const stateTableExists = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(stateTableQuery);\n                if (stateTableExists.rows[0].exists) {\n                    searchQueryText += `, s.state_name as state`;\n                }\n            }\n        }\n        // Handle property type\n        if (typeColumn) {\n            if (typeColumn === 'property_type' || typeColumn === 'type') {\n                searchQueryText += `, p.${typeColumn} as property_type`;\n            } else if (typeColumn === 'hotel_type_key') {\n                // Check if dim_hotel_type table exists for joining\n                const typeTableQuery = `\n          SELECT EXISTS (\n            SELECT FROM information_schema.tables \n            WHERE table_schema = 'public' \n            AND table_name = 'dim_hotel_type'\n          );\n        `;\n                const typeTableExists = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(typeTableQuery);\n                if (typeTableExists.rows[0].exists) {\n                    searchQueryText += `, h.hotel_type_name as property_type`;\n                }\n            }\n        }\n        // FROM clause\n        searchQueryText += `\\nFROM dim_property p`;\n        // Add JOINs if needed\n        if (columnNames.includes('city_key') && hasCityColumn) {\n            searchQueryText += `\\nLEFT JOIN dim_city c ON p.city_key = c.city_key`;\n        }\n        if (hasStateColumn && columnNames.includes('state_key')) {\n            searchQueryText += `\\nLEFT JOIN dim_state s ON p.state_key = s.state_key`;\n        } else if (hasCityColumn && columnNames.includes('city_key')) {\n            // Join state through city\n            searchQueryText += `\\nLEFT JOIN dim_state s ON c.state_key = s.state_key`;\n        }\n        if (typeColumn === 'hotel_type_key') {\n            searchQueryText += `\\nLEFT JOIN dim_hotel_type h ON p.hotel_type_key = h.hotel_type_key`;\n        }\n        // WHERE clause - search by property name\n        searchQueryText += `\\nWHERE p.${nameColumn} ILIKE $1`;\n        // LIMIT clause\n        searchQueryText += `\\nLIMIT 10`;\n        console.log('Final search query:', searchQueryText);\n        // Execute the search query\n        const searchResults = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(searchQueryText, [\n            `%${searchQuery}%`\n        ]);\n        console.log('Search returned', searchResults.rows.length, 'results');\n        return res.status(200).json({\n            properties: searchResults.rows\n        });\n    } catch (error) {\n        console.error('Error searching properties:', error);\n        return res.status(500).json({\n            error: 'Failed to search properties',\n            details: error.message\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS9wcm9wZXJ0aWVzL3NlYXJjaC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLGlDQUFpQztBQUNPO0FBRXpCLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxJQUFJRCxJQUFJRSxNQUFNLEtBQUssT0FBTztRQUN4QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQzFCQyxPQUFPO1FBQ1Q7SUFDRjtJQUVBLHdDQUF3QztJQUN4QyxNQUFNLEVBQUVQLE9BQU9RLFdBQVcsRUFBRSxHQUFHTixJQUFJRixLQUFLO0lBQ3hDUyxRQUFRQyxHQUFHLENBQUMsMEJBQTBCRjtJQUV0QyxJQUFJLENBQUNBLGVBQWVBLFlBQVlHLE1BQU0sR0FBRyxHQUFHO1FBQzFDRixRQUFRQyxHQUFHLENBQUM7UUFDWixPQUFPUCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVNLFlBQVksRUFBRTtRQUFDO0lBQy9DO0lBRUEsSUFBSTtRQUNGLDRDQUE0QztRQUM1Q0gsUUFBUUMsR0FBRyxDQUFDO1FBRVosK0NBQStDO1FBQy9DLE1BQU1HLGtCQUFrQixDQUFDOzs7Ozs7SUFNekIsQ0FBQztRQUVELE1BQU1DLGNBQWMsTUFBTWQsOENBQUtBLENBQUNhO1FBQ2hDSixRQUFRQyxHQUFHLENBQUMsOEJBQThCSSxZQUFZQyxJQUFJLENBQUMsRUFBRSxDQUFDQyxNQUFNO1FBRXBFLGtGQUFrRjtRQUNsRixJQUFJLENBQUNGLFlBQVlDLElBQUksQ0FBQyxFQUFFLENBQUNDLE1BQU0sRUFBRTtZQUMvQlAsUUFBUUMsR0FBRyxDQUFDO1lBRVosb0RBQW9EO1lBQ3BELE1BQU1PLHlCQUF5QixDQUFDOzs7Ozs7Ozs7TUFTaEMsQ0FBQztZQUVELE1BQU1DLG9CQUFvQixNQUFNbEIsOENBQUtBLENBQUNpQjtZQUN0Q1IsUUFBUUMsR0FBRyxDQUFDLHNDQUFzQ1Esa0JBQWtCSCxJQUFJO1lBRXhFLElBQUlHLGtC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QyxDQUFDLEVBQUU5QixZQUFZLENBQUMsQ0FBQztTQUFDO1FBRXZFQyxRQUFRQyxHQUFHLENBQUMsbUJBQW1Cc0IsY0FBY2pCLElBQUksQ0FBQ0osTUFBTSxFQUFFO1FBRTFELE9BQU9SLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRU0sWUFBWW9CLGNBQWNqQixJQUFJO1FBQUM7SUFDL0QsRUFBRSxPQUFPUixPQUFPO1FBQ2RFLFFBQVFGLEtBQUssQ0FBQywrQkFBK0JBO1FBQzdDLE9BQU9KLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUJDLE9BQU87WUFDUHNDLFNBQVN0QyxNQUFNdUMsT0FBTztRQUN4QjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFx2aW5vZFxccHJvamVjdHNcXGlubnZlc3RcXFBPQ1xcaW5udmVzdGFpXFxwYWdlc1xcYXBpXFxwcm9wZXJ0aWVzXFxzZWFyY2guanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvYXBpL3Byb3BlcnRpZXMvc2VhcmNoLmpzXHJcbmltcG9ydCB7IHF1ZXJ5IH0gZnJvbSAnLi4vLi4vLi4vbGliL2RiJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICBpZiAocmVxLm1ldGhvZCAhPT0gJ0dFVCcpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IFxyXG4gICAgICBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCdcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IHRoZSBzZWFyY2ggcXVlcnkgZnJvbSB0aGUgcmVxdWVzdFxyXG4gIGNvbnN0IHsgcXVlcnk6IHNlYXJjaFF1ZXJ5IH0gPSByZXEucXVlcnk7XHJcbiAgY29uc29sZS5sb2coJ1NlYXJjaCBxdWVyeSByZWNlaXZlZDonLCBzZWFyY2hRdWVyeSk7XHJcblxyXG4gIGlmICghc2VhcmNoUXVlcnkgfHwgc2VhcmNoUXVlcnkubGVuZ3RoIDwgMikge1xyXG4gICAgY29uc29sZS5sb2coJ1NlYXJjaCBxdWVyeSB0b28gc2hvcnQsIHJldHVybmluZyBlbXB0eSByZXN1bHRzJyk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBwcm9wZXJ0aWVzOiBbXSB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyBEeW5hbWljYWxseSBhZGFwdCB0byB5b3VyIGRhdGFiYXNlIHNjaGVtYVxyXG4gICAgY29uc29sZS5sb2coJ0RldGVybWluaW5nIGRhdGFiYXNlIHNjaGVtYS4uLicpO1xyXG4gICAgXHJcbiAgICAvLyBHZXQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGRpbV9wcm9wZXJ0eSB0YWJsZVxyXG4gICAgY29uc3QgdGFibGVDaGVja1F1ZXJ5ID0gYFxyXG4gICAgICBTRUxFQ1QgRVhJU1RTIChcclxuICAgICAgICBTRUxFQ1QgRlJPTSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIFxyXG4gICAgICAgIFdIRVJFIHRhYmxlX3NjaGVtYSA9ICdwdWJsaWMnIFxyXG4gICAgICAgIEFORCB0YWJsZV9uYW1lID0gJ2RpbV9wcm9wZXJ0eSdcclxuICAgICAgKTtcclxuICAgIGA7XHJcbiAgICBcclxuICAgIGNvbnN0IHRhYmxlRXhpc3RzID0gYXdhaXQgcXVlcnkodGFibGVDaGVja1F1ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKCdkaW1fcHJvcGVydHkgdGFibGUgZXhpc3RzOicsIHRhYmxlRXhpc3RzLnJvd3NbMF0uZXhpc3RzKTtcclxuICAgIFxyXG4gICAgLy8gSWYgdGhlIGRpbV9wcm9wZXJ0eSB0YWJsZSBkb2Vzbid0IGV4aXN0LCB3ZSBzaG91bGQgY2hlY2sgZm9yIGFsdGVybmF0aXZlIHRhYmxlc1xyXG4gICAgaWYgKCF0YWJsZUV4aXN0cy5yb3dzWzBdLmV4aXN0cykge1xyXG4gICAgICBjb25zb2xlLmxvZygnZGltX3Byb3BlcnR5IHRhYmxlIG5vdCBmb3VuZCwgY2hlY2tpbmcgZm9yIGFsdGVybmF0aXZlIHByb3BlcnR5IHRhYmxlcy4uLicpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIGFueSB0YWJsZSB0aGF0IG1pZ2h0IGNvbnRhaW4gcHJvcGVydGllc1xyXG4gICAgICBjb25zdCBhbHRlcm5hdGl2ZVRhYmxlc1F1ZXJ5ID0gYFxyXG4gICAgICAgIFNFTEVDVCB0YWJsZV9uYW1lIFxyXG4gICAgICAgIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLnRhYmxlcyBcclxuICAgICAgICBXSEVSRSB0YWJsZV9zY2hlbWEgPSAncHVibGljJyBcclxuICAgICAgICBBTkQgKFxyXG4gICAgICAgICAgdGFibGVfbmFtZSBMSUtFICclcHJvcGVydHklJyBcclxuICAgICAgICAgIE9SIHRhYmxlX25hbWUgTElLRSAnJWhvdGVsJScgXHJcbiAgICAgICAgICBPUiB0YWJsZV9uYW1lIExJS0UgJyVwcm9wZXJ0aWVzJSdcclxuICAgICAgICApO1xyXG4gICAgICBgO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgYWx0ZXJuYXRpdmVUYWJsZXMgPSBhd2FpdCBxdWVyeShhbHRlcm5hdGl2ZVRhYmxlc1F1ZXJ5KTtcclxuICAgICAgY29uc29sZS5sb2coJ0FsdGVybmF0aXZlIHByb3BlcnR5IHRhYmxlcyBmb3VuZDonLCBhbHRlcm5hdGl2ZVRhYmxlcy5yb3dzKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChhbHRlcm5hdGl2ZVRhYmxlcy5yb3dzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdObyBwcm9wZXJ0eSB0YWJsZXMgZm91bmQsIHJldHVybmluZyBlbXB0eSByZXN1bHRzJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgcHJvcGVydGllczogW10gfSk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIFVzZSB0aGUgZmlyc3QgYWx0ZXJuYXRpdmUgdGFibGVcclxuICAgICAgY29uc3QgYWx0ZXJuYXRpdmVUYWJsZSA9IGFsdGVybmF0aXZlVGFibGVzLnJvd3NbMF0udGFibGVfbmFtZTtcclxuICAgICAgY29uc29sZS5sb2coJ1VzaW5nIGFsdGVybmF0aXZlIHRhYmxlOicsIGFsdGVybmF0aXZlVGFibGUpO1xyXG4gICAgICBcclxuICAgICAgLy8gR2V0IGNvbHVtbnMgZnJvbSBhbHRlcm5hdGl2ZSB0YWJsZVxyXG4gICAgICBjb25zdCBjb2x1bW5zUXVlcnkgPSBgXHJcbiAgICAgICAgU0VMRUNUIGNvbHVtbl9uYW1lIFxyXG4gICAgICAgIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLmNvbHVtbnMgXHJcbiAgICAgICAgV0hFUkUgdGFibGVfc2NoZW1hID0gJ3B1YmxpYycgXHJcbiAgICAgICAgQU5EIHRhYmxlX25hbWUgPSAkMTtcclxuICAgICAgYDtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGNvbHVtbnMgPSBhd2FpdCBxdWVyeShjb2x1bW5zUXVlcnksIFthbHRlcm5hdGl2ZVRhYmxlXSk7XHJcbiAgICAgIGNvbnN0IGNvbHVtbk5hbWVzID0gY29sdW1ucy5yb3dzLm1hcChyb3cgPT4gcm93LmNvbHVtbl9uYW1lKTtcclxuICAgICAgY29uc29sZS5sb2coJ0NvbHVtbnMgaW4gYWx0ZXJuYXRpdmUgdGFibGU6JywgY29sdW1uTmFtZXMpO1xyXG4gICAgICBcclxuICAgICAgLy8gRmluZCBJRCBjb2x1bW4gKGxvb2sgZm9yIGFueSBjb2x1bW4gd2l0aCAnaWQnIG9yICdrZXknIGluIHRoZSBuYW1lKVxyXG4gICAgICBjb25zdCBpZENvbHVtbiA9IGNvbHVtbk5hbWVzLmZpbmQoY29sID0+IFxyXG4gICAgICAgIGNvbC5pbmNsdWRlcygnaWQnKSB8fCBjb2wuaW5jbHVkZXMoJ2tleScpXHJcbiAgICAgICkgfHwgY29sdW1uTmFtZXNbMF07XHJcbiAgICAgIFxyXG4gICAgICAvLyBGaW5kIG5hbWUgY29sdW1uIChsb29rIGZvciBhbnkgY29sdW1uIHdpdGggJ25hbWUnIGluIHRoZSBuYW1lKVxyXG4gICAgICBjb25zdCBuYW1lQ29sdW1uID0gY29sdW1uTmFtZXMuZmluZChjb2wgPT4gY29sLmluY2x1ZGVzKCduYW1lJykpIHx8IGNvbHVtbk5hbWVzWzFdO1xyXG4gICAgICBcclxuICAgICAgLy8gUGVyZm9ybSBzZWFyY2ggb24gYWx0ZXJuYXRpdmUgdGFibGVcclxuICAgICAgY29uc3Qgc2VhcmNoUXVlcnkgPSBgXHJcbiAgICAgICAgU0VMRUNUIFxyXG4gICAgICAgICAgJHtpZENvbHVtbn0gYXMgcHJvcGVydHlfa2V5LCBcclxuICAgICAgICAgICR7bmFtZUNvbHVtbn0gYXMgcHJvcGVydHlfbmFtZVxyXG4gICAgICAgIEZST00gJHthbHRlcm5hdGl2ZVRhYmxlfVxyXG4gICAgICAgIFdIRVJFICR7bmFtZUNvbHVtbn0gSUxJS0UgJDFcclxuICAgICAgICBMSU1JVCAxMDtcclxuICAgICAgYDtcclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKCdSdW5uaW5nIHNlYXJjaCBxdWVyeSBvbiBhbHRlcm5hdGl2ZSB0YWJsZTonLCBzZWFyY2hRdWVyeSk7XHJcbiAgICAgIGNvbnN0IHNlYXJjaFJlc3VsdHMgPSBhd2FpdCBxdWVyeShzZWFyY2hRdWVyeSwgW2AlJHtzZWFyY2hRdWVyeX0lYF0pO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgcHJvcGVydGllczogc2VhcmNoUmVzdWx0cy5yb3dzIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBJZiB3ZSByZWFjaCBoZXJlLCB0aGUgZGltX3Byb3BlcnR5IHRhYmxlIGV4aXN0c1xyXG4gICAgLy8gR2V0IHRoZSBjb2x1bW5zIGZyb20gdGhlIGRpbV9wcm9wZXJ0eSB0YWJsZVxyXG4gICAgY29uc3QgY29sdW1uc1F1ZXJ5ID0gYFxyXG4gICAgICBTRUxFQ1QgY29sdW1uX25hbWUgXHJcbiAgICAgIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLmNvbHVtbnMgXHJcbiAgICAgIFdIRVJFIHRhYmxlX3NjaGVtYSA9ICdwdWJsaWMnIFxyXG4gICAgICBBTkQgdGFibGVfbmFtZSA9ICdkaW1fcHJvcGVydHknO1xyXG4gICAgYDtcclxuICAgIFxyXG4gICAgY29uc3QgY29sdW1ucyA9IGF3YWl0IHF1ZXJ5KGNvbHVtbnNRdWVyeSk7XHJcbiAgICBjb25zdCBjb2x1bW5OYW1lcyA9IGNvbHVtbnMucm93cy5tYXAocm93ID0+IHJvdy5jb2x1bW5fbmFtZSk7XHJcbiAgICBjb25zb2xlLmxvZygnQ29sdW1ucyBpbiBkaW1fcHJvcGVydHk6JywgY29sdW1uTmFtZXMpO1xyXG4gICAgXHJcbiAgICAvLyBEZXRlcm1pbmUga2V5IGNvbHVtbnMgdG8gdXNlIGluIHRoZSBxdWVyeVxyXG4gICAgY29uc3QgaWRDb2x1bW4gPSBjb2x1bW5OYW1lcy5pbmNsdWRlcygncHJvcGVydHlfa2V5JykgPyAncHJvcGVydHlfa2V5JyA6IFxyXG4gICAgICAgICAgICAgICAgICAgY29sdW1uTmFtZXMuaW5jbHVkZXMoJ2lkJykgPyAnaWQnIDpcclxuICAgICAgICAgICAgICAgICAgIGNvbHVtbk5hbWVzLmZpbmQoY29sID0+IGNvbC5pbmNsdWRlcygnaWQnKSB8fCBjb2wuaW5jbHVkZXMoJ2tleScpKSB8fCAnaWQnO1xyXG4gICAgICAgICAgICAgICAgICAgXHJcbiAgICBjb25zdCBuYW1lQ29sdW1uID0gY29sdW1uTmFtZXMuaW5jbHVkZXMoJ3Byb3BlcnR5X25hbWUnKSA/ICdwcm9wZXJ0eV9uYW1lJyA6XHJcbiAgICAgICAgICAgICAgICAgICAgIGNvbHVtbk5hbWVzLmluY2x1ZGVzKCduYW1lJykgPyAnbmFtZScgOlxyXG4gICAgICAgICAgICAgICAgICAgICBjb2x1bW5OYW1lcy5maW5kKGNvbCA9PiBjb2wuaW5jbHVkZXMoJ25hbWUnKSkgfHwgJ3Byb3BlcnR5X25hbWUnO1xyXG4gICAgICAgICAgICAgICAgICAgICBcclxuICAgIGNvbnN0IGFkZHJlc3NDb2x1bW4gPSBjb2x1bW5OYW1lcy5pbmNsdWRlcygnYWRkcmVzcycpID8gJ2FkZHJlc3MnIDpcclxuICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5OYW1lcy5pbmNsdWRlcygncHJvcGVydHlfYWRkcmVzcycpID8gJ3Byb3BlcnR5X2FkZHJlc3MnIDpcclxuICAgICAgICAgICAgICAgICAgICAgICBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgY29uc3Qgcm9vbXNDb2x1bW4gPSBjb2x1bW5OYW1lcy5pbmNsdWRlcygnbnVtYmVyX29mX3Jvb21zJykgPyAnbnVtYmVyX29mX3Jvb21zJyA6XHJcbiAgICAgICAgICAgICAgICAgICAgIGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdyb29tcycpID8gJ3Jvb21zJyA6XHJcbiAgICAgICAgICAgICAgICAgICAgIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgY29uc3QgdHlwZUNvbHVtbiA9IGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdwcm9wZXJ0eV90eXBlJykgPyAncHJvcGVydHlfdHlwZScgOlxyXG4gICAgICAgICAgICAgICAgICAgICBjb2x1bW5OYW1lcy5pbmNsdWRlcygndHlwZScpID8gJ3R5cGUnIDpcclxuICAgICAgICAgICAgICAgICAgICAgY29sdW1uTmFtZXMuaW5jbHVkZXMoJ2hvdGVsX3R5cGVfa2V5JykgPyAnaG90ZWxfdHlwZV9rZXknIDpcclxuICAgICAgICAgICAgICAgICAgICAgbnVsbDtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBjaXR5IGFuZCBzdGF0ZSBjb2x1bW5zIG9yIG5lZWQgdG8gam9pbiB3aXRoIG90aGVyIHRhYmxlc1xyXG4gICAgY29uc3QgaGFzQ2l0eUNvbHVtbiA9IGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdjaXR5JykgfHwgY29sdW1uTmFtZXMuaW5jbHVkZXMoJ2NpdHlfa2V5Jyk7XHJcbiAgICBjb25zdCBoYXNTdGF0ZUNvbHVtbiA9IGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdzdGF0ZScpIHx8IGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdzdGF0ZV9rZXknKTtcclxuICAgIFxyXG4gICAgLy8gQnVpbGQgdGhlIHNlYXJjaCBxdWVyeSBiYXNlZCBvbiBhdmFpbGFibGUgY29sdW1uc1xyXG4gICAgbGV0IHNlYXJjaFF1ZXJ5VGV4dCA9IGBcclxuICAgICAgU0VMRUNUIFxyXG4gICAgICAgIHAuJHtpZENvbHVtbn0gYXMgcHJvcGVydHlfa2V5LCBcclxuICAgICAgICBwLiR7bmFtZUNvbHVtbn0gYXMgcHJvcGVydHlfbmFtZVxyXG4gICAgYDtcclxuICAgIFxyXG4gICAgaWYgKGFkZHJlc3NDb2x1bW4pIHtcclxuICAgICAgc2VhcmNoUXVlcnlUZXh0ICs9IGAsIHAuJHthZGRyZXNzQ29sdW1ufSBhcyBwcm9wZXJ0eV9hZGRyZXNzYDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHJvb21zQ29sdW1uKSB7XHJcbiAgICAgIHNlYXJjaFF1ZXJ5VGV4dCArPSBgLCBwLiR7cm9vbXNDb2x1bW59IGFzIG51bWJlcl9vZl9yb29tc2A7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEhhbmRsZSBjaXR5IGFuZCBzdGF0ZVxyXG4gICAgaWYgKGhhc0NpdHlDb2x1bW4pIHtcclxuICAgICAgaWYgKGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdjaXR5JykpIHtcclxuICAgICAgICBzZWFyY2hRdWVyeVRleHQgKz0gYCwgcC5jaXR5YDtcclxuICAgICAgfSBlbHNlIGlmIChjb2x1bW5OYW1lcy5pbmNsdWRlcygnY2l0eV9rZXknKSkge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGRpbV9jaXR5IHRhYmxlIGV4aXN0cyBmb3Igam9pbmluZ1xyXG4gICAgICAgIGNvbnN0IGNpdHlUYWJsZVF1ZXJ5ID0gYFxyXG4gICAgICAgICAgU0VMRUNUIEVYSVNUUyAoXHJcbiAgICAgICAgICAgIFNFTEVDVCBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS50YWJsZXMgXHJcbiAgICAgICAgICAgIFdIRVJFIHRhYmxlX3NjaGVtYSA9ICdwdWJsaWMnIFxyXG4gICAgICAgICAgICBBTkQgdGFibGVfbmFtZSA9ICdkaW1fY2l0eSdcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgYDtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjaXR5VGFibGVFeGlzdHMgPSBhd2FpdCBxdWVyeShjaXR5VGFibGVRdWVyeSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGNpdHlUYWJsZUV4aXN0cy5yb3dzWzBdLmV4aXN0cykge1xyXG4gICAgICAgICAgc2VhcmNoUXVlcnlUZXh0ICs9IGAsIGMuY2l0eV9uYW1lIGFzIGNpdHlgO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoaGFzU3RhdGVDb2x1bW4pIHtcclxuICAgICAgaWYgKGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdzdGF0ZScpKSB7XHJcbiAgICAgICAgc2VhcmNoUXVlcnlUZXh0ICs9IGAsIHAuc3RhdGVgO1xyXG4gICAgICB9IGVsc2UgaWYgKGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdzdGF0ZV9rZXknKSkge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGRpbV9zdGF0ZSB0YWJsZSBleGlzdHMgZm9yIGpvaW5pbmdcclxuICAgICAgICBjb25zdCBzdGF0ZVRhYmxlUXVlcnkgPSBgXHJcbiAgICAgICAgICBTRUxFQ1QgRVhJU1RTIChcclxuICAgICAgICAgICAgU0VMRUNUIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLnRhYmxlcyBcclxuICAgICAgICAgICAgV0hFUkUgdGFibGVfc2NoZW1hID0gJ3B1YmxpYycgXHJcbiAgICAgICAgICAgIEFORCB0YWJsZV9uYW1lID0gJ2RpbV9zdGF0ZSdcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgYDtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBzdGF0ZVRhYmxlRXhpc3RzID0gYXdhaXQgcXVlcnkoc3RhdGVUYWJsZVF1ZXJ5KTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoc3RhdGVUYWJsZUV4aXN0cy5yb3dzWzBdLmV4aXN0cykge1xyXG4gICAgICAgICAgc2VhcmNoUXVlcnlUZXh0ICs9IGAsIHMuc3RhdGVfbmFtZSBhcyBzdGF0ZWA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEhhbmRsZSBwcm9wZXJ0eSB0eXBlXHJcbiAgICBpZiAodHlwZUNvbHVtbikge1xyXG4gICAgICBpZiAodHlwZUNvbHVtbiA9PT0gJ3Byb3BlcnR5X3R5cGUnIHx8IHR5cGVDb2x1bW4gPT09ICd0eXBlJykge1xyXG4gICAgICAgIHNlYXJjaFF1ZXJ5VGV4dCArPSBgLCBwLiR7dHlwZUNvbHVtbn0gYXMgcHJvcGVydHlfdHlwZWA7XHJcbiAgICAgIH0gZWxzZSBpZiAodHlwZUNvbHVtbiA9PT0gJ2hvdGVsX3R5cGVfa2V5Jykge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGRpbV9ob3RlbF90eXBlIHRhYmxlIGV4aXN0cyBmb3Igam9pbmluZ1xyXG4gICAgICAgIGNvbnN0IHR5cGVUYWJsZVF1ZXJ5ID0gYFxyXG4gICAgICAgICAgU0VMRUNUIEVYSVNUUyAoXHJcbiAgICAgICAgICAgIFNFTEVDVCBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS50YWJsZXMgXHJcbiAgICAgICAgICAgIFdIRVJFIHRhYmxlX3NjaGVtYSA9ICdwdWJsaWMnIFxyXG4gICAgICAgICAgICBBTkQgdGFibGVfbmFtZSA9ICdkaW1faG90ZWxfdHlwZSdcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgYDtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCB0eXBlVGFibGVFeGlzdHMgPSBhd2FpdCBxdWVyeSh0eXBlVGFibGVRdWVyeSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHR5cGVUYWJsZUV4aXN0cy5yb3dzWzBdLmV4aXN0cykge1xyXG4gICAgICAgICAgc2VhcmNoUXVlcnlUZXh0ICs9IGAsIGguaG90ZWxfdHlwZV9uYW1lIGFzIHByb3BlcnR5X3R5cGVgO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBGUk9NIGNsYXVzZVxyXG4gICAgc2VhcmNoUXVlcnlUZXh0ICs9IGBcXG5GUk9NIGRpbV9wcm9wZXJ0eSBwYDtcclxuICAgIFxyXG4gICAgLy8gQWRkIEpPSU5zIGlmIG5lZWRlZFxyXG4gICAgaWYgKGNvbHVtbk5hbWVzLmluY2x1ZGVzKCdjaXR5X2tleScpICYmIGhhc0NpdHlDb2x1bW4pIHtcclxuICAgICAgc2VhcmNoUXVlcnlUZXh0ICs9IGBcXG5MRUZUIEpPSU4gZGltX2NpdHkgYyBPTiBwLmNpdHlfa2V5ID0gYy5jaXR5X2tleWA7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChoYXNTdGF0ZUNvbHVtbiAmJiBjb2x1bW5OYW1lcy5pbmNsdWRlcygnc3RhdGVfa2V5JykpIHtcclxuICAgICAgc2VhcmNoUXVlcnlUZXh0ICs9IGBcXG5MRUZUIEpPSU4gZGltX3N0YXRlIHMgT04gcC5zdGF0ZV9rZXkgPSBzLnN0YXRlX2tleWA7XHJcbiAgICB9IGVsc2UgaWYgKGhhc0NpdHlDb2x1bW4gJiYgY29sdW1uTmFtZXMuaW5jbHVkZXMoJ2NpdHlfa2V5JykpIHtcclxuICAgICAgLy8gSm9pbiBzdGF0ZSB0aHJvdWdoIGNpdHlcclxuICAgICAgc2VhcmNoUXVlcnlUZXh0ICs9IGBcXG5MRUZUIEpPSU4gZGltX3N0YXRlIHMgT04gYy5zdGF0ZV9rZXkgPSBzLnN0YXRlX2tleWA7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmICh0eXBlQ29sdW1uID09PSAnaG90ZWxfdHlwZV9rZXknKSB7XHJcbiAgICAgIHNlYXJjaFF1ZXJ5VGV4dCArPSBgXFxuTEVGVCBKT0lOIGRpbV9ob3RlbF90eXBlIGggT04gcC5ob3RlbF90eXBlX2tleSA9IGguaG90ZWxfdHlwZV9rZXlgO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBXSEVSRSBjbGF1c2UgLSBzZWFyY2ggYnkgcHJvcGVydHkgbmFtZVxyXG4gICAgc2VhcmNoUXVlcnlUZXh0ICs9IGBcXG5XSEVSRSBwLiR7bmFtZUNvbHVtbn0gSUxJS0UgJDFgO1xyXG4gICAgXHJcbiAgICAvLyBMSU1JVCBjbGF1c2VcclxuICAgIHNlYXJjaFF1ZXJ5VGV4dCArPSBgXFxuTElNSVQgMTBgO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygnRmluYWwgc2VhcmNoIHF1ZXJ5OicsIHNlYXJjaFF1ZXJ5VGV4dCk7XHJcbiAgICBcclxuICAgIC8vIEV4ZWN1dGUgdGhlIHNlYXJjaCBxdWVyeVxyXG4gICAgY29uc3Qgc2VhcmNoUmVzdWx0cyA9IGF3YWl0IHF1ZXJ5KHNlYXJjaFF1ZXJ5VGV4dCwgW2AlJHtzZWFyY2hRdWVyeX0lYF0pO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygnU2VhcmNoIHJldHVybmVkJywgc2VhcmNoUmVzdWx0cy5yb3dzLmxlbmd0aCwgJ3Jlc3VsdHMnKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgcHJvcGVydGllczogc2VhcmNoUmVzdWx0cy5yb3dzIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZWFyY2hpbmcgcHJvcGVydGllczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcclxuICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gc2VhcmNoIHByb3BlcnRpZXMnLFxyXG4gICAgICBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIFxyXG4gICAgfSk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbInF1ZXJ5IiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsInNlYXJjaFF1ZXJ5IiwiY29uc29sZSIsImxvZyIsImxlbmd0aCIsInByb3BlcnRpZXMiLCJ0YWJsZUNoZWNrUXVlcnkiLCJ0YWJsZUV4aXN0cyIsInJvd3MiLCJleGlzdHMiLCJhbHRlcm5hdGl2ZVRhYmxlc1F1ZXJ5IiwiYWx0ZXJuYXRpdmVUYWJsZXMiLCJhbHRlcm5hdGl2ZVRhYmxlIiwidGFibGVfbmFtZSIsImNvbHVtbnNRdWVyeSIsImNvbHVtbnMiLCJjb2x1bW5OYW1lcyIsIm1hcCIsInJvdyIsImNvbHVtbl9uYW1lIiwiaWRDb2x1bW4iLCJmaW5kIiwiY29sIiwiaW5jbHVkZXMiLCJuYW1lQ29sdW1uIiwic2VhcmNoUmVzdWx0cyIsImFkZHJlc3NDb2x1bW4iLCJyb29tc0NvbHVtbiIsInR5cGVDb2x1bW4iLCJoYXNDaXR5Q29sdW1uIiwiaGFzU3RhdGVDb2x1bW4iLCJzZWFyY2hRdWVyeVRleHQiLCJjaXR5VGFibGVRdWVyeSIsImNpdHlUYWJsZUV4aXN0cyIsInN0YXRlVGFibGVRdWVyeSIsInN0YXRlVGFibGVFeGlzdHMiLCJ0eXBlVGFibGVRdWVyeSIsInR5cGVUYWJsZUV4aXN0cyIsImRldGFpbHMiLCJtZXNzYWdlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/properties/search.js\n");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproperties%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cproperties%5Csearch.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();