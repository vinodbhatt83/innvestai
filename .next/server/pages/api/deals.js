"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/deals";
exports.ids = ["pages/api/deals"];
exports.modules = {

/***/ "(api-node)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pool: () => (/* binding */ pool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n// lib/db.js\n// Initialize query and pool as null\nlet pool = null;\nlet query = null;\n// Only run this code on the server\nif (true) {\n    try {\n        // Server-side code - import pg using require to avoid webpack issues\n        const { Pool } = __webpack_require__(/*! pg */ \"pg\");\n        // Create a database connection pool\n        pool =  false ? 0 : new Pool({\n            user: process.env.DB_USER || 'postgres',\n            host: process.env.DB_HOST || 'localhost',\n            database: process.env.DB_NAME || 'innvestai',\n            password: process.env.DB_PASSWORD || 'Temp@123',\n            port: parseInt(process.env.DB_PORT || '5432')\n        });\n        // Define the query function\n        query = async (text, params)=>{\n            try {\n                const start = Date.now();\n                const res = await pool.query(text, params);\n                const duration = Date.now() - start;\n                // Log query performance in development\n                if (true) {\n                    console.log('Executed query', {\n                        text,\n                        duration,\n                        rows: res.rowCount\n                    });\n                }\n                return res;\n            } catch (error) {\n                console.error('Database query error:', error);\n                throw error;\n            }\n        };\n        // Setup event handlers for the pool\n        pool.on('error', (err)=>{\n            console.error('Unexpected database error:', err);\n        // Don't crash the server on connection errors\n        });\n        console.log('Database module initialized on server');\n    } catch (error) {\n        console.error('Failed to initialize database module:', error);\n        // Create non-functional stubs if initialization fails\n        pool = {\n            query: ()=>{\n                throw new Error('Database pool not initialized');\n            },\n            on: ()=>{}\n        };\n        query = async ()=>{\n            throw new Error('Database query function not initialized');\n        };\n    }\n} else {}\n// Next.js supports ES modules by default\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL2xpYi9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLFlBQVk7QUFFWixvQ0FBb0M7QUFDcEMsSUFBSUEsT0FBTztBQUNYLElBQUlDLFFBQVE7QUFFWixtQ0FBbUM7QUFDbkMsSUFBSSxJQUE2QixFQUFFO0lBQ2pDLElBQUk7UUFDRixxRUFBcUU7UUFDckUsTUFBTSxFQUFFQyxJQUFJLEVBQUUsR0FBR0MsbUJBQU9BLENBQUMsY0FBSTtRQUU3QixvQ0FBb0M7UUFDcENILE9BQU9JLE1BQXFDLEdBQ3hDLENBS0UsR0FDRixJQUFJRixLQUFLO1lBQ1BRLE1BQU1OLFFBQVFFLEdBQUcsQ0FBQ0ssT0FBTyxJQUFJO1lBQzdCQyxNQUFNUixRQUFRRSxHQUFHLENBQUNPLE9BQU8sSUFBSTtZQUM3QkMsVUFBVVYsUUFBUUUsR0FBRyxDQUFDUyxPQUFPLElBQUk7WUFDakNDLFVBQVVaLFFBQVFFLEdBQUcsQ0FBQ1csV0FBVyxJQUFJO1lBQ3JDQyxNQUFNQyxTQUFTZixRQUFRRSxHQUFHLENBQUNjLE9BQU8sSUFBSTtRQUN4QztRQUVKLDRCQUE0QjtRQUM1Qm5CLFFBQVEsT0FBT29CLE1BQU1DO1lBQ25CLElBQUk7Z0JBQ0YsTUFBTUMsUUFBUUMsS0FBS0MsR0FBRztnQkFDdEIsTUFBTUMsTUFBTSxNQUFNMUIsS0FBS0MsS0FBSyxDQUFDb0IsTUFBTUM7Z0JBQ25DLE1BQU1LLFdBQVdILEtBQUtDLEdBQUcsS0FBS0Y7Z0JBRTlCLHVDQUF1QztnQkFDdkMsSUFBSW5CLElBQXFDLEVBQUU7b0JBQ3pDd0IsUUFBUUMsR0FBRyxDQUFDLGtCQUFrQjt3QkFBRVI7d0JBQU1NO3dCQUFVRyxNQUFNSixJQUFJSyxRQUFRO29CQUFDO2dCQUNyRTtnQkFFQSxPQUFPTDtZQUNULEVBQUUsT0FBT00sT0FBTztnQkFDZEosUUFBUUksS0FBSyxDQUFDLHlCQUF5QkE7Z0JBQ3ZDLE1BQU1BO1lBQ1I7UUFDRjtRQUVBLG9DQUFvQztRQUNwQ2hDLEtBQUtpQyxFQUFFLENBQUMsU0FBUyxDQUFDQztZQUNoQk4sUUFBUUksS0FBSyxDQUFDLDhCQUE4QkU7UUFDNUMsOENBQThDO1FBQ2hEO1FBRUFOLFFBQVFDLEdBQUcsQ0FBQztJQUNkLEVBQUUsT0FBT0csT0FBTztRQUNkSixRQUFRSSxLQUFLLENBQUMseUNBQXlDQTtRQUV2RCxzREFBc0Q7UUFDdERoQyxPQUFPO1lBQ0xDLE9BQU87Z0JBQVEsTUFBTSxJQUFJa0MsTUFBTTtZQUFrQztZQUNqRUYsSUFBSSxLQUFPO1FBQ2I7UUFFQWhDLFFBQVE7WUFBYyxNQUFNLElBQUlrQyxNQUFNO1FBQTRDO0lBQ3BGO0FBQ0YsT0FBTyxFQVlOO0FBRUQseUNBQXlDO0FBQ2xCIiwic291cmNlcyI6WyJDOlxcdmlub2RcXHByb2plY3RzXFxpbm52ZXN0XFxQT0NcXGlubnZlc3RhaVxcbGliXFxkYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvZGIuanNcclxuXHJcbi8vIEluaXRpYWxpemUgcXVlcnkgYW5kIHBvb2wgYXMgbnVsbFxyXG5sZXQgcG9vbCA9IG51bGw7XHJcbmxldCBxdWVyeSA9IG51bGw7XHJcblxyXG4vLyBPbmx5IHJ1biB0aGlzIGNvZGUgb24gdGhlIHNlcnZlclxyXG5pZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICB0cnkge1xyXG4gICAgLy8gU2VydmVyLXNpZGUgY29kZSAtIGltcG9ydCBwZyB1c2luZyByZXF1aXJlIHRvIGF2b2lkIHdlYnBhY2sgaXNzdWVzXHJcbiAgICBjb25zdCB7IFBvb2wgfSA9IHJlcXVpcmUoJ3BnJyk7XHJcblxyXG4gICAgLy8gQ3JlYXRlIGEgZGF0YWJhc2UgY29ubmVjdGlvbiBwb29sXHJcbiAgICBwb29sID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyBcclxuICAgICAgPyBuZXcgUG9vbCh7XHJcbiAgICAgICAgICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwsXHJcbiAgICAgICAgICBzc2w6IHtcclxuICAgICAgICAgICAgcmVqZWN0VW5hdXRob3JpemVkOiBmYWxzZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgIDogbmV3IFBvb2woe1xyXG4gICAgICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuREJfVVNFUiB8fCAncG9zdGdyZXMnLFxyXG4gICAgICAgICAgaG9zdDogcHJvY2Vzcy5lbnYuREJfSE9TVCB8fCAnbG9jYWxob3N0JyxcclxuICAgICAgICAgIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5EQl9OQU1FIHx8ICdpbm52ZXN0YWknLCAvLyBVc2UgYnVpbHQtaW4gcG9zdGdyZXMgZGF0YWJhc2VcclxuICAgICAgICAgIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCAnVGVtcEAxMjMnLFxyXG4gICAgICAgICAgcG9ydDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfUE9SVCB8fCAnNTQzMicpLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIC8vIERlZmluZSB0aGUgcXVlcnkgZnVuY3Rpb25cclxuICAgIHF1ZXJ5ID0gYXN5bmMgKHRleHQsIHBhcmFtcykgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBwb29sLnF1ZXJ5KHRleHQsIHBhcmFtcyk7XHJcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnQ7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTG9nIHF1ZXJ5IHBlcmZvcm1hbmNlIGluIGRldmVsb3BtZW50XHJcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdFeGVjdXRlZCBxdWVyeScsIHsgdGV4dCwgZHVyYXRpb24sIHJvd3M6IHJlcy5yb3dDb3VudCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBxdWVyeSBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gU2V0dXAgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSBwb29sXHJcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcignVW5leHBlY3RlZCBkYXRhYmFzZSBlcnJvcjonLCBlcnIpO1xyXG4gICAgICAvLyBEb24ndCBjcmFzaCB0aGUgc2VydmVyIG9uIGNvbm5lY3Rpb24gZXJyb3JzXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgbW9kdWxlIGluaXRpYWxpemVkIG9uIHNlcnZlcicpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkYXRhYmFzZSBtb2R1bGU6JywgZXJyb3IpO1xyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgbm9uLWZ1bmN0aW9uYWwgc3R1YnMgaWYgaW5pdGlhbGl6YXRpb24gZmFpbHNcclxuICAgIHBvb2wgPSB7XHJcbiAgICAgIHF1ZXJ5OiAoKSA9PiB7IHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcG9vbCBub3QgaW5pdGlhbGl6ZWQnKTsgfSxcclxuICAgICAgb246ICgpID0+IHt9XHJcbiAgICB9O1xyXG5cclxuICAgIHF1ZXJ5ID0gYXN5bmMgKCkgPT4geyB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGZ1bmN0aW9uIG5vdCBpbml0aWFsaXplZCcpOyB9O1xyXG4gIH1cclxufSBlbHNlIHtcclxuICAvLyBDbGllbnQtc2lkZSBtb2NrIGltcGxlbWVudGF0aW9uXHJcbiAgcXVlcnkgPSBhc3luYyAoKSA9PiB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJpZXMgY2Fubm90IGJlIGV4ZWN1dGVkIG9uIHRoZSBjbGllbnQgc2lkZScpO1xyXG4gIH07XHJcbiAgXHJcbiAgcG9vbCA9IHtcclxuICAgIHF1ZXJ5OiAoKSA9PiB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcXVlcmllcyBjYW5ub3QgYmUgZXhlY3V0ZWQgb24gdGhlIGNsaWVudCBzaWRlJyk7XHJcbiAgICB9LFxyXG4gICAgb246ICgpID0+IHt9XHJcbiAgfTtcclxufVxyXG5cclxuLy8gTmV4dC5qcyBzdXBwb3J0cyBFUyBtb2R1bGVzIGJ5IGRlZmF1bHRcclxuZXhwb3J0IHsgcXVlcnksIHBvb2wgfTsiXSwibmFtZXMiOlsicG9vbCIsInF1ZXJ5IiwiUG9vbCIsInJlcXVpcmUiLCJwcm9jZXNzIiwiY29ubmVjdGlvblN0cmluZyIsImVudiIsIkRBVEFCQVNFX1VSTCIsInNzbCIsInJlamVjdFVuYXV0aG9yaXplZCIsInVzZXIiLCJEQl9VU0VSIiwiaG9zdCIsIkRCX0hPU1QiLCJkYXRhYmFzZSIsIkRCX05BTUUiLCJwYXNzd29yZCIsIkRCX1BBU1NXT1JEIiwicG9ydCIsInBhcnNlSW50IiwiREJfUE9SVCIsInRleHQiLCJwYXJhbXMiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJyZXMiLCJkdXJhdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJyb3dzIiwicm93Q291bnQiLCJlcnJvciIsIm9uIiwiZXJyIiwiRXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./lib/db.js\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeals&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdeals%5Cindex.js&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeals&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdeals%5Cindex.js&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_deals_index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\deals\\index.js */ \"(api-node)/./pages/api/deals/index.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_deals_index_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_deals_index_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/deals\",\n        pathname: \"/api/deals\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_deals_index_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGZGVhbHMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2RlYWxzJTVDaW5kZXguanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ0U7QUFDMUQ7QUFDMEQ7QUFDMUQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHNEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxzREFBUTtBQUNwQztBQUNPLHdCQUF3Qix5R0FBbUI7QUFDbEQ7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxkZWFsc1xcXFxpbmRleC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZGVhbHNcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9kZWFsc1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeals&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdeals%5Cindex.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/deals/index.js":
/*!**********************************!*\
  !*** ./pages/api/deals/index.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/db */ \"(api-node)/./lib/db.js\");\n// pages/api/deals/index.js\n\nasync function handler(req, res) {\n    switch(req.method){\n        case 'GET':\n            try {\n                // Get all deals with optional filtering\n                const { limit = 10, offset = 0, sortBy = 'created_at', order = 'DESC' } = req.query;\n                // First, check the structure of the deals table\n                const tableInfoQuery = `\n          SELECT column_name \n          FROM information_schema.columns \n          WHERE table_schema = 'public' \n          AND table_name = 'deals';\n        `;\n                const tableInfo = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(tableInfoQuery);\n                const dealColumns = tableInfo.rows.map((row)=>row.column_name);\n                console.log('Deal table columns:', dealColumns);\n                // Get the deal ID column name (deal_id or id)\n                const dealIdColumn = dealColumns.find((col)=>col === 'deal_id' || col === 'id') || 'id';\n                // Check if property_id exists in deals\n                const hasPropertyId = dealColumns.includes('property_id');\n                // Get all deals\n                let dealsQuery;\n                if (hasPropertyId) {\n                    // Attempt a simple query first to see if it works\n                    dealsQuery = `\n            SELECT * FROM deals\n            ORDER BY ${dealColumns.includes('created_at') ? 'created_at' : dealIdColumn} ${order === 'ASC' ? 'ASC' : 'DESC'}\n            LIMIT $1 OFFSET $2\n          `;\n                } else {\n                    // If no property_id, just get deals without trying to join\n                    dealsQuery = `\n            SELECT * FROM deals\n            ORDER BY ${dealColumns.includes('created_at') ? 'created_at' : dealIdColumn} ${order === 'ASC' ? 'ASC' : 'DESC'}\n            LIMIT $1 OFFSET $2\n          `;\n                }\n                const countQuery = `SELECT COUNT(*) FROM deals`;\n                const [dealsResult, countResult] = await Promise.all([\n                    (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(dealsQuery, [\n                        limit,\n                        offset\n                    ]),\n                    (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(countQuery)\n                ]);\n                // If we have deals and property_id exists, try to get property details\n                const deals = [\n                    ...dealsResult.rows\n                ]; // This is just the part of the code that needs to be fixed in pages/api/deals/index.js\n                // Enhanced deal data processing\n                if (deals.length > 0) {\n                    // Add default values for any missing fields and enhance with property info\n                    for(let i = 0; i < deals.length; i++){\n                        // Calculate investment amount from purchase_price if available, otherwise use default\n                        if (!deals[i].investment_amount && deals[i].purchase_price) {\n                            deals[i].investment_amount = deals[i].purchase_price;\n                        } else if (!deals[i].investment_amount) {\n                            deals[i].investment_amount = 1000000; // Default to $1M if no amount available\n                        }\n                        // Set default return percentages based on property_type if not set\n                        if (!deals[i].expected_return) {\n                            switch(deals[i].property_type?.toLowerCase()){\n                                case 'luxury':\n                                    deals[i].expected_return = 8.5;\n                                    break;\n                                case 'full service':\n                                    deals[i].expected_return = 8.2;\n                                    break;\n                                case 'limited service':\n                                    deals[i].expected_return = 8.8;\n                                    break;\n                                default:\n                                    deals[i].expected_return = 8.5; // Default\n                            }\n                        }\n                        // Calculate price per key if possible\n                        if (deals[i].purchase_price && deals[i].number_of_rooms) {\n                            deals[i].price_per_key = Math.round(deals[i].purchase_price / deals[i].number_of_rooms);\n                        }\n                        // Set default hold period if not present\n                        if (!deals[i].hold_period) {\n                            deals[i].hold_period = 5; // Default 5 year hold\n                        }\n                        // Try to get property data from dim_property\n                        try {\n                            // Check if dim_property table exists\n                            const tableCheck = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(`\n                SELECT table_name FROM information_schema.tables \n                WHERE table_schema = 'public' AND table_name = 'dim_property'\n              `);\n                            if (tableCheck.rows.length > 0) {\n                                // If deal has property_id, try to get property details\n                                if (deals[i].property_id) {\n                                    const propertyData = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(`\n                    SELECT p.*, h.hotel_type_name \n                    FROM dim_property p\n                    LEFT JOIN dim_hotel_type h ON p.hotel_type_key = h.hotel_type_key\n                    WHERE p.property_key = $1 OR p.property_id = $1\n                  `, [\n                                        deals[i].property_id\n                                    ]);\n                                    if (propertyData.rows.length > 0) {\n                                        const property = propertyData.rows[0];\n                                        // Add property details to deal\n                                        deals[i] = {\n                                            ...deals[i],\n                                            property_name: property.property_name || deals[i].property_name,\n                                            property_address: property.property_address || deals[i].property_address,\n                                            city: property.city || deals[i].city,\n                                            state: property.state || deals[i].state,\n                                            property_type: property.hotel_type_name || deals[i].property_type,\n                                            number_of_rooms: property.room_count || deals[i].number_of_rooms,\n                                            star_rating: property.star_rating,\n                                            brand: property.brand,\n                                            chain_scale: property.chain_scale,\n                                            year_built: property.year_built,\n                                            year_renovated: property.year_renovated\n                                        };\n                                    }\n                                }\n                            }\n                        } catch (err) {\n                            console.log('Error getting property data:', err.message);\n                        }\n                        // Get acquisition data if available (fetch from fact_deal_assumptions and dim_acquisition)\n                        try {\n                            const acquisitionData = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(`\n                SELECT a.* \n                FROM fact_deal_assumptions f\n                JOIN dim_acquisition a ON f.acquisition_id = a.acquisition_id\n                WHERE f.deal_id = $1\n              `, [\n                                deals[i].deal_id\n                            ]);\n                            if (acquisitionData.rows.length > 0) {\n                                deals[i] = {\n                                    ...deals[i],\n                                    ...acquisitionData.rows[0]\n                                };\n                            }\n                        } catch (err) {\n                            console.log('No acquisition data found for deal:', deals[i].deal_id);\n                        }\n                    }\n                }\n                if (deals.length > 0 && hasPropertyId) {\n                    // Try to enhance deals with property info\n                    try {\n                        // First, check if dim_property table exists and get its structure\n                        const propertyInfoQuery = `\n      SELECT column_name \n      FROM information_schema.columns \n      WHERE table_schema = 'public' \n      AND table_name = 'dim_property';\n    `;\n                        const propertyInfo = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(propertyInfoQuery);\n                        if (propertyInfo.rows.length > 0) {\n                            // Enhance each deal with property info\n                            for(let i = 0; i < deals.length; i++){\n                                const deal = deals[i];\n                                if (deal.property_id) {\n                                    // Use property_key instead of property_id\n                                    const propertyQuery = `\n            SELECT p.*, h.hotel_type_name, m.market_name\n            FROM dim_property p\n            LEFT JOIN dim_hotel_type h ON p.hotel_type_key = h.hotel_type_key\n            LEFT JOIN dim_market m ON p.market_key = m.market_key\n            WHERE p.property_key = $1\n          `;\n                                    try {\n                                        const propertyResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(propertyQuery, [\n                                            deal.property_id\n                                        ]);\n                                        const property = propertyResult.rows[0];\n                                        if (property) {\n                                            deals[i] = {\n                                                ...deal,\n                                                property_name: property.property_name,\n                                                hotel_type_name: property.hotel_type_name,\n                                                market_name: property.market_name,\n                                                // Use property's room_count if available \n                                                number_of_rooms: property.room_count || deal.number_of_rooms\n                                            };\n                                        }\n                                    } catch (propError) {\n                                        console.error('Error fetching property for deal:', propError);\n                                    // If property fetch fails, continue with original deal\n                                    }\n                                }\n                            }\n                        }\n                    } catch (enhanceError) {\n                        console.error('Error enhancing deals with property info:', enhanceError);\n                    // Continue with basic deal data\n                    }\n                }\n                res.status(200).json({\n                    deals,\n                    total: parseInt(countResult.rows[0].count),\n                    limit: parseInt(limit),\n                    offset: parseInt(offset)\n                });\n            } catch (error) {\n                console.error('Error executing query:', error);\n                res.status(500).json({\n                    error: 'Failed to retrieve deals',\n                    details: error.message\n                });\n            }\n            break;\n        // pages/api/deals/index.js (POST section updated)\n        case 'POST':\n            try {\n                // Extract form fields from the request\n                const requestBody = req.body;\n                console.log('Request body:', requestBody);\n                // Check the structure of the deals table\n                const tableInfoQuery = `\n      SELECT column_name \n      FROM information_schema.columns \n      WHERE table_schema = 'public' \n      AND table_name = 'deals';\n    `;\n                let tableInfo;\n                try {\n                    tableInfo = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(tableInfoQuery);\n                } catch (error) {\n                    console.log('Error getting table info, deals table might not exist');\n                    // Create a complete deals table with all required fields\n                    const createTableQuery = `\n        CREATE TABLE IF NOT EXISTS deals (\n          id SERIAL PRIMARY KEY,\n          property_id INTEGER,\n          deal_name VARCHAR(255) NOT NULL,\n          investment_amount DECIMAL(15, 2) NOT NULL DEFAULT 1000000,\n          expected_return DECIMAL(6, 2) NOT NULL DEFAULT 8.5,\n          start_date DATE NOT NULL DEFAULT CURRENT_DATE,\n          end_date DATE NOT NULL DEFAULT (CURRENT_DATE + INTERVAL '5 years'),\n          status VARCHAR(50) DEFAULT 'Draft',\n          created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n          updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        );\n      `;\n                    await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(createTableQuery);\n                    console.log('Created deals table with all required columns');\n                    // Get the columns again\n                    tableInfo = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(tableInfoQuery);\n                }\n                const dealColumns = tableInfo.rows.map((row)=>row.column_name);\n                console.log('Deal table columns after check:', dealColumns);\n                // Map property_id if it was sent from the client as property_key\n                let propertyId = requestBody.property_id;\n                // If property_id wasn't sent but property_key was, use that instead\n                if (propertyId === undefined && requestBody.property_key !== undefined) {\n                    propertyId = requestBody.property_key;\n                }\n                // Include the required fields with default values if not provided\n                const dataToInsert = {\n                    deal_name: requestBody.deal_name,\n                    property_id: propertyId || null,\n                    investment_amount: requestBody.investment_amount || 1000000,\n                    expected_return: requestBody.expected_return || 8.5,\n                    start_date: requestBody.start_date || new Date().toISOString().split('T')[0],\n                    end_date: requestBody.end_date || new Date(new Date().setFullYear(new Date().getFullYear() + 5)).toISOString().split('T')[0],\n                    status: requestBody.status || 'Draft'\n                };\n                // Generate the column list and placeholders\n                const columns = [];\n                const values = [];\n                let placeholders = [];\n                // Add fields that exist in the database\n                Object.keys(dataToInsert).forEach((key)=>{\n                    if (dealColumns.includes(key) && dataToInsert[key] !== undefined) {\n                        columns.push(key);\n                        values.push(dataToInsert[key]);\n                        placeholders.push(`$${values.length}`);\n                    }\n                });\n                // Add created_at if in columns\n                if (dealColumns.includes('created_at') && !columns.includes('created_at')) {\n                    columns.push('created_at');\n                    values.push(new Date());\n                    placeholders.push(`$${values.length}`);\n                }\n                console.log('Columns to insert:', columns);\n                console.log('Values to insert:', values);\n                if (columns.length === 0) {\n                    return res.status(400).json({\n                        error: 'No valid deal data provided'\n                    });\n                }\n                const insertQuery = `\n      INSERT INTO deals (${columns.join(', ')})\n      VALUES (${placeholders.join(', ')})\n      RETURNING *\n    `;\n                console.log('Insert query:', insertQuery);\n                const result = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(insertQuery, values);\n                console.log('Insert result:', result.rows[0]);\n                res.status(201).json(result.rows[0]);\n            } catch (error) {\n                console.error('Error creating deal:', error);\n                res.status(500).json({\n                    error: 'Failed to create deal',\n                    details: error.message\n                });\n            }\n            break;\n        default:\n            res.setHeader('Allow', [\n                'GET',\n                'POST'\n            ]);\n            res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TztZQUN0Q25HLElBQUltRSxNQUFNLENBQUMsS0FBS2lDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRXJHLElBQUlFLE1BQU0sQ0FBQyxZQUFZLENBQUM7SUFDMUQ7QUFDRiIsInNvdXJjZXMiOlsiQzpcXHZpbm9kXFxwcm9qZWN0c1xcaW5udmVzdFxcUE9DXFxpbm52ZXN0YWlcXHBhZ2VzXFxhcGlcXGRlYWxzXFxpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9hcGkvZGVhbHMvaW5kZXguanNcclxuaW1wb3J0IHsgcXVlcnkgfSBmcm9tICcuLi8uLi8uLi9saWIvZGInO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIHN3aXRjaCAocmVxLm1ldGhvZCkge1xyXG4gICAgY2FzZSAnR0VUJzpcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBHZXQgYWxsIGRlYWxzIHdpdGggb3B0aW9uYWwgZmlsdGVyaW5nXHJcbiAgICAgICAgY29uc3QgeyBsaW1pdCA9IDEwLCBvZmZzZXQgPSAwLCBzb3J0QnkgPSAnY3JlYXRlZF9hdCcsIG9yZGVyID0gJ0RFU0MnIH0gPSByZXEucXVlcnk7XHJcblxyXG4gICAgICAgIC8vIEZpcnN0LCBjaGVjayB0aGUgc3RydWN0dXJlIG9mIHRoZSBkZWFscyB0YWJsZVxyXG4gICAgICAgIGNvbnN0IHRhYmxlSW5mb1F1ZXJ5ID0gYFxyXG4gICAgICAgICAgU0VMRUNUIGNvbHVtbl9uYW1lIFxyXG4gICAgICAgICAgRlJPTSBpbmZvcm1hdGlvbl9zY2hlbWEuY29sdW1ucyBcclxuICAgICAgICAgIFdIRVJFIHRhYmxlX3NjaGVtYSA9ICdwdWJsaWMnIFxyXG4gICAgICAgICAgQU5EIHRhYmxlX25hbWUgPSAnZGVhbHMnO1xyXG4gICAgICAgIGA7XHJcblxyXG4gICAgICAgIGNvbnN0IHRhYmxlSW5mbyA9IGF3YWl0IHF1ZXJ5KHRhYmxlSW5mb1F1ZXJ5KTtcclxuICAgICAgICBjb25zdCBkZWFsQ29sdW1ucyA9IHRhYmxlSW5mby5yb3dzLm1hcChyb3cgPT4gcm93LmNvbHVtbl9uYW1lKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnRGVhbCB0YWJsZSBjb2x1bW5zOicsIGRlYWxDb2x1bW5zKTtcclxuXHJcbiAgICAgICAgLy8gR2V0IHRoZSBkZWFsIElEIGNvbHVtbiBuYW1lIChkZWFsX2lkIG9yIGlkKVxyXG4gICAgICAgIGNvbnN0IGRlYWxJZENvbHVtbiA9IGRlYWxDb2x1bW5zLmZpbmQoY29sID0+XHJcbiAgICAgICAgICBjb2wgPT09ICdkZWFsX2lkJyB8fCBjb2wgPT09ICdpZCdcclxuICAgICAgICApIHx8ICdpZCc7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHByb3BlcnR5X2lkIGV4aXN0cyBpbiBkZWFsc1xyXG4gICAgICAgIGNvbnN0IGhhc1Byb3BlcnR5SWQgPSBkZWFsQ29sdW1ucy5pbmNsdWRlcygncHJvcGVydHlfaWQnKTtcclxuXHJcbiAgICAgICAgLy8gR2V0IGFsbCBkZWFsc1xyXG4gICAgICAgIGxldCBkZWFsc1F1ZXJ5O1xyXG5cclxuICAgICAgICBpZiAoaGFzUHJvcGVydHlJZCkge1xyXG4gICAgICAgICAgLy8gQXR0ZW1wdCBhIHNpbXBsZSBxdWVyeSBmaXJzdCB0byBzZWUgaWYgaXQgd29ya3NcclxuICAgICAgICAgIGRlYWxzUXVlcnkgPSBgXHJcbiAgICAgICAgICAgIFNFTEVDVCAqIEZST00gZGVhbHNcclxuICAgICAgICAgICAgT1JERVIgQlkgJHtkZWFsQ29sdW1ucy5pbmNsdWRlcygnY3JlYXRlZF9hdCcpID8gJ2NyZWF0ZWRfYXQnIDogZGVhbElkQ29sdW1ufSAke29yZGVyID09PSAnQVNDJyA/ICdBU0MnIDogJ0RFU0MnfVxyXG4gICAgICAgICAgICBMSU1JVCAkMSBPRkZTRVQgJDJcclxuICAgICAgICAgIGA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIElmIG5vIHByb3BlcnR5X2lkLCBqdXN0IGdldCBkZWFscyB3aXRob3V0IHRyeWluZyB0byBqb2luXHJcbiAgICAgICAgICBkZWFsc1F1ZXJ5ID0gYFxyXG4gICAgICAgICAgICBTRUxFQ1QgKiBGUk9NIGRlYWxzXHJcbiAgICAgICAgICAgIE9SREVSIEJZICR7ZGVhbENvbHVtbnMuaW5jbHVkZXMoJ2NyZWF0ZWRfYXQnKSA/ICdjcmVhdGVkX2F0JyA6IGRlYWxJZENvbHVtbn0gJHtvcmRlciA9PT0gJ0FTQycgPyAnQVNDJyA6ICdERVNDJ31cclxuICAgICAgICAgICAgTElNSVQgJDEgT0ZGU0VUICQyXHJcbiAgICAgICAgICBgO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgY291bnRRdWVyeSA9IGBTRUxFQ1QgQ09VTlQoKikgRlJPTSBkZWFsc2A7XHJcblxyXG4gICAgICAgIGNvbnN0IFtkZWFsc1Jlc3VsdCwgY291bnRSZXN1bHRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgICAgcXVlcnkoZGVhbHNRdWVyeSwgW2xpbWl0LCBvZmZzZXRdKSxcclxuICAgICAgICAgIHF1ZXJ5KGNvdW50UXVlcnkpXHJcbiAgICAgICAgXSk7XHJcblxyXG4gICAgICAgIC8vIElmIHdlIGhhdmUgZGVhbHMgYW5kIHByb3BlcnR5X2lkIGV4aXN0cywgdHJ5IHRvIGdldCBwcm9wZXJ0eSBkZXRhaWxzXHJcbiAgICAgICAgY29uc3QgZGVhbHMgPSBbLi4uZGVhbHNSZXN1bHQucm93c107ICAgICAgICAvLyBUaGlzIGlzIGp1c3QgdGhlIHBhcnQgb2YgdGhlIGNvZGUgdGhhdCBuZWVkcyB0byBiZSBmaXhlZCBpbiBwYWdlcy9hcGkvZGVhbHMvaW5kZXguanNcclxuXHJcbiAgICAgICAgLy8gRW5oYW5jZWQgZGVhbCBkYXRhIHByb2Nlc3NpbmdcclxuICAgICAgICBpZiAoZGVhbHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgLy8gQWRkIGRlZmF1bHQgdmFsdWVzIGZvciBhbnkgbWlzc2luZyBmaWVsZHMgYW5kIGVuaGFuY2Ugd2l0aCBwcm9wZXJ0eSBpbmZvXHJcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlYWxzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBpbnZlc3RtZW50IGFtb3VudCBmcm9tIHB1cmNoYXNlX3ByaWNlIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHVzZSBkZWZhdWx0XHJcbiAgICAgICAgICAgIGlmICghZGVhbHNbaV0uaW52ZXN0bWVudF9hbW91bnQgJiYgZGVhbHNbaV0ucHVyY2hhc2VfcHJpY2UpIHtcclxuICAgICAgICAgICAgICBkZWFsc1tpXS5pbnZlc3RtZW50X2Ftb3VudCA9IGRlYWxzW2ldLnB1cmNoYXNlX3ByaWNlO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFkZWFsc1tpXS5pbnZlc3RtZW50X2Ftb3VudCkge1xyXG4gICAgICAgICAgICAgIGRlYWxzW2ldLmludmVzdG1lbnRfYW1vdW50ID0gMTAwMDAwMDsgLy8gRGVmYXVsdCB0byAkMU0gaWYgbm8gYW1vdW50IGF2YWlsYWJsZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBTZXQgZGVmYXVsdCByZXR1cm4gcGVyY2VudGFnZXMgYmFzZWQgb24gcHJvcGVydHlfdHlwZSBpZiBub3Qgc2V0XHJcbiAgICAgICAgICAgIGlmICghZGVhbHNbaV0uZXhwZWN0ZWRfcmV0dXJuKSB7XHJcbiAgICAgICAgICAgICAgc3dpdGNoKGRlYWxzW2ldLnByb3BlcnR5X3R5cGU/LnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2x1eHVyeSc6XHJcbiAgICAgICAgICAgICAgICAgIGRlYWxzW2ldLmV4cGVjdGVkX3JldHVybiA9IDguNTtcclxuICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdmdWxsIHNlcnZpY2UnOlxyXG4gICAgICAgICAgICAgICAgICBkZWFsc1tpXS5leHBlY3RlZF9yZXR1cm4gPSA4LjI7XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbGltaXRlZCBzZXJ2aWNlJzpcclxuICAgICAgICAgICAgICAgICAgZGVhbHNbaV0uZXhwZWN0ZWRfcmV0dXJuID0gOC44O1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgIGRlYWxzW2ldLmV4cGVjdGVkX3JldHVybiA9IDguNTsgLy8gRGVmYXVsdFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHByaWNlIHBlciBrZXkgaWYgcG9zc2libGVcclxuICAgICAgICAgICAgaWYgKGRlYWxzW2ldLnB1cmNoYXNlX3ByaWNlICYmIGRlYWxzW2ldLm51bWJlcl9vZl9yb29tcykge1xyXG4gICAgICAgICAgICAgIGRlYWxzW2ldLnByaWNlX3Blcl9rZXkgPSBNYXRoLnJvdW5kKGRlYWxzW2ldLnB1cmNoYXNlX3ByaWNlIC8gZGVhbHNbaV0ubnVtYmVyX29mX3Jvb21zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2V0IGRlZmF1bHQgaG9sZCBwZXJpb2QgaWYgbm90IHByZXNlbnRcclxuICAgICAgICAgICAgaWYgKCFkZWFsc1tpXS5ob2xkX3BlcmlvZCkge1xyXG4gICAgICAgICAgICAgIGRlYWxzW2ldLmhvbGRfcGVyaW9kID0gNTsgLy8gRGVmYXVsdCA1IHllYXIgaG9sZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgLy8gVHJ5IHRvIGdldCBwcm9wZXJ0eSBkYXRhIGZyb20gZGltX3Byb3BlcnR5XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgZGltX3Byb3BlcnR5IHRhYmxlIGV4aXN0c1xyXG4gICAgICAgICAgICAgIGNvbnN0IHRhYmxlQ2hlY2sgPSBhd2FpdCBxdWVyeShgXHJcbiAgICAgICAgICAgICAgICBTRUxFQ1QgdGFibGVfbmFtZSBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS50YWJsZXMgXHJcbiAgICAgICAgICAgICAgICBXSEVSRSB0YWJsZV9zY2hlbWEgPSAncHVibGljJyBBTkQgdGFibGVfbmFtZSA9ICdkaW1fcHJvcGVydHknXHJcbiAgICAgICAgICAgICAgYCk7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgaWYgKHRhYmxlQ2hlY2sucm93cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiBkZWFsIGhhcyBwcm9wZXJ0eV9pZCwgdHJ5IHRvIGdldCBwcm9wZXJ0eSBkZXRhaWxzXHJcbiAgICAgICAgICAgICAgICBpZiAoZGVhbHNbaV0ucHJvcGVydHlfaWQpIHtcclxuICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcGVydHlEYXRhID0gYXdhaXQgcXVlcnkoYFxyXG4gICAgICAgICAgICAgICAgICAgIFNFTEVDVCBwLiosIGguaG90ZWxfdHlwZV9uYW1lIFxyXG4gICAgICAgICAgICAgICAgICAgIEZST00gZGltX3Byb3BlcnR5IHBcclxuICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gZGltX2hvdGVsX3R5cGUgaCBPTiBwLmhvdGVsX3R5cGVfa2V5ID0gaC5ob3RlbF90eXBlX2tleVxyXG4gICAgICAgICAgICAgICAgICAgIFdIRVJFIHAucHJvcGVydHlfa2V5ID0gJDEgT1IgcC5wcm9wZXJ0eV9pZCA9ICQxXHJcbiAgICAgICAgICAgICAgICAgIGAsIFtkZWFsc1tpXS5wcm9wZXJ0eV9pZF0pO1xyXG4gICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5RGF0YS5yb3dzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHByb3BlcnR5RGF0YS5yb3dzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBwcm9wZXJ0eSBkZXRhaWxzIHRvIGRlYWxcclxuICAgICAgICAgICAgICAgICAgICBkZWFsc1tpXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgIC4uLmRlYWxzW2ldLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlfbmFtZTogcHJvcGVydHkucHJvcGVydHlfbmFtZSB8fCBkZWFsc1tpXS5wcm9wZXJ0eV9uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlfYWRkcmVzczogcHJvcGVydHkucHJvcGVydHlfYWRkcmVzcyB8fCBkZWFsc1tpXS5wcm9wZXJ0eV9hZGRyZXNzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY2l0eTogcHJvcGVydHkuY2l0eSB8fCBkZWFsc1tpXS5jaXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgc3RhdGU6IHByb3BlcnR5LnN0YXRlIHx8IGRlYWxzW2ldLnN0YXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlfdHlwZTogcHJvcGVydHkuaG90ZWxfdHlwZV9uYW1lIHx8IGRlYWxzW2ldLnByb3BlcnR5X3R5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICBudW1iZXJfb2Zfcm9vbXM6IHByb3BlcnR5LnJvb21fY291bnQgfHwgZGVhbHNbaV0ubnVtYmVyX29mX3Jvb21zLFxyXG4gICAgICAgICAgICAgICAgICAgICAgc3Rhcl9yYXRpbmc6IHByb3BlcnR5LnN0YXJfcmF0aW5nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgYnJhbmQ6IHByb3BlcnR5LmJyYW5kLFxyXG4gICAgICAgICAgICAgICAgICAgICAgY2hhaW5fc2NhbGU6IHByb3BlcnR5LmNoYWluX3NjYWxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgeWVhcl9idWlsdDogcHJvcGVydHkueWVhcl9idWlsdCxcclxuICAgICAgICAgICAgICAgICAgICAgIHllYXJfcmVub3ZhdGVkOiBwcm9wZXJ0eS55ZWFyX3Jlbm92YXRlZFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBnZXR0aW5nIHByb3BlcnR5IGRhdGE6JywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBHZXQgYWNxdWlzaXRpb24gZGF0YSBpZiBhdmFpbGFibGUgKGZldGNoIGZyb20gZmFjdF9kZWFsX2Fzc3VtcHRpb25zIGFuZCBkaW1fYWNxdWlzaXRpb24pXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgYWNxdWlzaXRpb25EYXRhID0gYXdhaXQgcXVlcnkoYFxyXG4gICAgICAgICAgICAgICAgU0VMRUNUIGEuKiBcclxuICAgICAgICAgICAgICAgIEZST00gZmFjdF9kZWFsX2Fzc3VtcHRpb25zIGZcclxuICAgICAgICAgICAgICAgIEpPSU4gZGltX2FjcXVpc2l0aW9uIGEgT04gZi5hY3F1aXNpdGlvbl9pZCA9IGEuYWNxdWlzaXRpb25faWRcclxuICAgICAgICAgICAgICAgIFdIRVJFIGYuZGVhbF9pZCA9ICQxXHJcbiAgICAgICAgICAgICAgYCwgW2RlYWxzW2ldLmRlYWxfaWRdKTtcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICBpZiAoYWNxdWlzaXRpb25EYXRhLnJvd3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZGVhbHNbaV0gPSB7IC4uLmRlYWxzW2ldLCAuLi5hY3F1aXNpdGlvbkRhdGEucm93c1swXSB9O1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIGFjcXVpc2l0aW9uIGRhdGEgZm91bmQgZm9yIGRlYWw6JywgZGVhbHNbaV0uZGVhbF9pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICBpZiAoZGVhbHMubGVuZ3RoID4gMCAmJiBoYXNQcm9wZXJ0eUlkKSB7XHJcbiAgICAgICAgICAvLyBUcnkgdG8gZW5oYW5jZSBkZWFscyB3aXRoIHByb3BlcnR5IGluZm9cclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIEZpcnN0LCBjaGVjayBpZiBkaW1fcHJvcGVydHkgdGFibGUgZXhpc3RzIGFuZCBnZXQgaXRzIHN0cnVjdHVyZVxyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eUluZm9RdWVyeSA9IGBcclxuICAgICAgU0VMRUNUIGNvbHVtbl9uYW1lIFxyXG4gICAgICBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS5jb2x1bW5zIFxyXG4gICAgICBXSEVSRSB0YWJsZV9zY2hlbWEgPSAncHVibGljJyBcclxuICAgICAgQU5EIHRhYmxlX25hbWUgPSAnZGltX3Byb3BlcnR5JztcclxuICAgIGA7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBwcm9wZXJ0eUluZm8gPSBhd2FpdCBxdWVyeShwcm9wZXJ0eUluZm9RdWVyeSk7XHJcblxyXG4gICAgICAgICAgICBpZiAocHJvcGVydHlJbmZvLnJvd3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgIC8vIEVuaGFuY2UgZWFjaCBkZWFsIHdpdGggcHJvcGVydHkgaW5mb1xyXG4gICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGVhbHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRlYWwgPSBkZWFsc1tpXTtcclxuICAgICAgICAgICAgICAgIGlmIChkZWFsLnByb3BlcnR5X2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vIFVzZSBwcm9wZXJ0eV9rZXkgaW5zdGVhZCBvZiBwcm9wZXJ0eV9pZFxyXG4gICAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0eVF1ZXJ5ID0gYFxyXG4gICAgICAgICAgICBTRUxFQ1QgcC4qLCBoLmhvdGVsX3R5cGVfbmFtZSwgbS5tYXJrZXRfbmFtZVxyXG4gICAgICAgICAgICBGUk9NIGRpbV9wcm9wZXJ0eSBwXHJcbiAgICAgICAgICAgIExFRlQgSk9JTiBkaW1faG90ZWxfdHlwZSBoIE9OIHAuaG90ZWxfdHlwZV9rZXkgPSBoLmhvdGVsX3R5cGVfa2V5XHJcbiAgICAgICAgICAgIExFRlQgSk9JTiBkaW1fbWFya2V0IG0gT04gcC5tYXJrZXRfa2V5ID0gbS5tYXJrZXRfa2V5XHJcbiAgICAgICAgICAgIFdIRVJFIHAucHJvcGVydHlfa2V5ID0gJDFcclxuICAgICAgICAgIGA7XHJcblxyXG4gICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5UmVzdWx0ID0gYXdhaXQgcXVlcnkocHJvcGVydHlRdWVyeSwgW2RlYWwucHJvcGVydHlfaWRdKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IHByb3BlcnR5UmVzdWx0LnJvd3NbMF07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eSkgeyAgICAgICAgICAgICAgICAgICAgICBkZWFsc1tpXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGVhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlfbmFtZTogcHJvcGVydHkucHJvcGVydHlfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG90ZWxfdHlwZV9uYW1lOiBwcm9wZXJ0eS5ob3RlbF90eXBlX25hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtldF9uYW1lOiBwcm9wZXJ0eS5tYXJrZXRfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHByb3BlcnR5J3Mgcm9vbV9jb3VudCBpZiBhdmFpbGFibGUgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcl9vZl9yb29tczogcHJvcGVydHkucm9vbV9jb3VudCB8fCBkZWFsLm51bWJlcl9vZl9yb29tc1xyXG4gICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHByb3BFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb3BlcnR5IGZvciBkZWFsOicsIHByb3BFcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgcHJvcGVydHkgZmV0Y2ggZmFpbHMsIGNvbnRpbnVlIHdpdGggb3JpZ2luYWwgZGVhbFxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGNhdGNoIChlbmhhbmNlRXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZW5oYW5jaW5nIGRlYWxzIHdpdGggcHJvcGVydHkgaW5mbzonLCBlbmhhbmNlRXJyb3IpO1xyXG4gICAgICAgICAgICAvLyBDb250aW51ZSB3aXRoIGJhc2ljIGRlYWwgZGF0YVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICAgICAgZGVhbHMsXHJcbiAgICAgICAgICB0b3RhbDogcGFyc2VJbnQoY291bnRSZXN1bHQucm93c1swXS5jb3VudCksXHJcbiAgICAgICAgICBsaW1pdDogcGFyc2VJbnQobGltaXQpLFxyXG4gICAgICAgICAgb2Zmc2V0OiBwYXJzZUludChvZmZzZXQpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZXhlY3V0aW5nIHF1ZXJ5OicsIGVycm9yKTtcclxuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHJldHJpZXZlIGRlYWxzJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgfVxyXG4gICAgICBicmVhaztcclxuXHJcbiAgICAvLyBwYWdlcy9hcGkvZGVhbHMvaW5kZXguanMgKFBPU1Qgc2VjdGlvbiB1cGRhdGVkKVxyXG4gICAgY2FzZSAnUE9TVCc6XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gRXh0cmFjdCBmb3JtIGZpZWxkcyBmcm9tIHRoZSByZXF1ZXN0XHJcbiAgICAgICAgY29uc3QgcmVxdWVzdEJvZHkgPSByZXEuYm9keTtcclxuICAgICAgICBjb25zb2xlLmxvZygnUmVxdWVzdCBib2R5OicsIHJlcXVlc3RCb2R5KTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgdGhlIHN0cnVjdHVyZSBvZiB0aGUgZGVhbHMgdGFibGVcclxuICAgICAgICBjb25zdCB0YWJsZUluZm9RdWVyeSA9IGBcclxuICAgICAgU0VMRUNUIGNvbHVtbl9uYW1lIFxyXG4gICAgICBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS5jb2x1bW5zIFxyXG4gICAgICBXSEVSRSB0YWJsZV9zY2hlbWEgPSAncHVibGljJyBcclxuICAgICAgQU5EIHRhYmxlX25hbWUgPSAnZGVhbHMnO1xyXG4gICAgYDtcclxuXHJcbiAgICAgICAgbGV0IHRhYmxlSW5mbztcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgdGFibGVJbmZvID0gYXdhaXQgcXVlcnkodGFibGVJbmZvUXVlcnkpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgZ2V0dGluZyB0YWJsZSBpbmZvLCBkZWFscyB0YWJsZSBtaWdodCBub3QgZXhpc3QnKTtcclxuXHJcbiAgICAgICAgICAvLyBDcmVhdGUgYSBjb21wbGV0ZSBkZWFscyB0YWJsZSB3aXRoIGFsbCByZXF1aXJlZCBmaWVsZHNcclxuICAgICAgICAgIGNvbnN0IGNyZWF0ZVRhYmxlUXVlcnkgPSBgXHJcbiAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgZGVhbHMgKFxyXG4gICAgICAgICAgaWQgU0VSSUFMIFBSSU1BUlkgS0VZLFxyXG4gICAgICAgICAgcHJvcGVydHlfaWQgSU5URUdFUixcclxuICAgICAgICAgIGRlYWxfbmFtZSBWQVJDSEFSKDI1NSkgTk9UIE5VTEwsXHJcbiAgICAgICAgICBpbnZlc3RtZW50X2Ftb3VudCBERUNJTUFMKDE1LCAyKSBOT1QgTlVMTCBERUZBVUxUIDEwMDAwMDAsXHJcbiAgICAgICAgICBleHBlY3RlZF9yZXR1cm4gREVDSU1BTCg2LCAyKSBOT1QgTlVMTCBERUZBVUxUIDguNSxcclxuICAgICAgICAgIHN0YXJ0X2RhdGUgREFURSBOT1QgTlVMTCBERUZBVUxUIENVUlJFTlRfREFURSxcclxuICAgICAgICAgIGVuZF9kYXRlIERBVEUgTk9UIE5VTEwgREVGQVVMVCAoQ1VSUkVOVF9EQVRFICsgSU5URVJWQUwgJzUgeWVhcnMnKSxcclxuICAgICAgICAgIHN0YXR1cyBWQVJDSEFSKDUwKSBERUZBVUxUICdEcmFmdCcsXHJcbiAgICAgICAgICBjcmVhdGVkX2F0IFRJTUVTVEFNUCBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLFxyXG4gICAgICAgICAgdXBkYXRlZF9hdCBUSU1FU1RBTVAgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUFxyXG4gICAgICAgICk7XHJcbiAgICAgIGA7XHJcblxyXG4gICAgICAgICAgYXdhaXQgcXVlcnkoY3JlYXRlVGFibGVRdWVyeSk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnQ3JlYXRlZCBkZWFscyB0YWJsZSB3aXRoIGFsbCByZXF1aXJlZCBjb2x1bW5zJyk7XHJcblxyXG4gICAgICAgICAgLy8gR2V0IHRoZSBjb2x1bW5zIGFnYWluXHJcbiAgICAgICAgICB0YWJsZUluZm8gPSBhd2FpdCBxdWVyeSh0YWJsZUluZm9RdWVyeSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkZWFsQ29sdW1ucyA9IHRhYmxlSW5mby5yb3dzLm1hcChyb3cgPT4gcm93LmNvbHVtbl9uYW1lKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnRGVhbCB0YWJsZSBjb2x1bW5zIGFmdGVyIGNoZWNrOicsIGRlYWxDb2x1bW5zKTtcclxuXHJcbiAgICAgICAgLy8gTWFwIHByb3BlcnR5X2lkIGlmIGl0IHdhcyBzZW50IGZyb20gdGhlIGNsaWVudCBhcyBwcm9wZXJ0eV9rZXlcclxuICAgICAgICBsZXQgcHJvcGVydHlJZCA9IHJlcXVlc3RCb2R5LnByb3BlcnR5X2lkO1xyXG5cclxuICAgICAgICAvLyBJZiBwcm9wZXJ0eV9pZCB3YXNuJ3Qgc2VudCBidXQgcHJvcGVydHlfa2V5IHdhcywgdXNlIHRoYXQgaW5zdGVhZFxyXG4gICAgICAgIGlmIChwcm9wZXJ0eUlkID09PSB1bmRlZmluZWQgJiYgcmVxdWVzdEJvZHkucHJvcGVydHlfa2V5ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIHByb3BlcnR5SWQgPSByZXF1ZXN0Qm9keS5wcm9wZXJ0eV9rZXk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJbmNsdWRlIHRoZSByZXF1aXJlZCBmaWVsZHMgd2l0aCBkZWZhdWx0IHZhbHVlcyBpZiBub3QgcHJvdmlkZWRcclxuICAgICAgICBjb25zdCBkYXRhVG9JbnNlcnQgPSB7XHJcbiAgICAgICAgICBkZWFsX25hbWU6IHJlcXVlc3RCb2R5LmRlYWxfbmFtZSxcclxuICAgICAgICAgIHByb3BlcnR5X2lkOiBwcm9wZXJ0eUlkIHx8IG51bGwsXHJcbiAgICAgICAgICBpbnZlc3RtZW50X2Ftb3VudDogcmVxdWVzdEJvZHkuaW52ZXN0bWVudF9hbW91bnQgfHwgMTAwMDAwMCxcclxuICAgICAgICAgIGV4cGVjdGVkX3JldHVybjogcmVxdWVzdEJvZHkuZXhwZWN0ZWRfcmV0dXJuIHx8IDguNSxcclxuICAgICAgICAgIHN0YXJ0X2RhdGU6IHJlcXVlc3RCb2R5LnN0YXJ0X2RhdGUgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sXHJcbiAgICAgICAgICBlbmRfZGF0ZTogcmVxdWVzdEJvZHkuZW5kX2RhdGUgfHwgbmV3IERhdGUobmV3IERhdGUoKS5zZXRGdWxsWWVhcihuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkgKyA1KSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLFxyXG4gICAgICAgICAgc3RhdHVzOiByZXF1ZXN0Qm9keS5zdGF0dXMgfHwgJ0RyYWZ0J1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIEdlbmVyYXRlIHRoZSBjb2x1bW4gbGlzdCBhbmQgcGxhY2Vob2xkZXJzXHJcbiAgICAgICAgY29uc3QgY29sdW1ucyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xyXG4gICAgICAgIGxldCBwbGFjZWhvbGRlcnMgPSBbXTtcclxuXHJcbiAgICAgICAgLy8gQWRkIGZpZWxkcyB0aGF0IGV4aXN0IGluIHRoZSBkYXRhYmFzZVxyXG4gICAgICAgIE9iamVjdC5rZXlzKGRhdGFUb0luc2VydCkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgaWYgKGRlYWxDb2x1bW5zLmluY2x1ZGVzKGtleSkgJiYgZGF0YVRvSW5zZXJ0W2tleV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBjb2x1bW5zLnB1c2goa2V5KTtcclxuICAgICAgICAgICAgdmFsdWVzLnB1c2goZGF0YVRvSW5zZXJ0W2tleV0pO1xyXG4gICAgICAgICAgICBwbGFjZWhvbGRlcnMucHVzaChgJCR7dmFsdWVzLmxlbmd0aH1gKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQWRkIGNyZWF0ZWRfYXQgaWYgaW4gY29sdW1uc1xyXG4gICAgICAgIGlmIChkZWFsQ29sdW1ucy5pbmNsdWRlcygnY3JlYXRlZF9hdCcpICYmICFjb2x1bW5zLmluY2x1ZGVzKCdjcmVhdGVkX2F0JykpIHtcclxuICAgICAgICAgIGNvbHVtbnMucHVzaCgnY3JlYXRlZF9hdCcpO1xyXG4gICAgICAgICAgdmFsdWVzLnB1c2gobmV3IERhdGUoKSk7XHJcbiAgICAgICAgICBwbGFjZWhvbGRlcnMucHVzaChgJCR7dmFsdWVzLmxlbmd0aH1gKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdDb2x1bW5zIHRvIGluc2VydDonLCBjb2x1bW5zKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnVmFsdWVzIHRvIGluc2VydDonLCB2YWx1ZXMpO1xyXG5cclxuICAgICAgICBpZiAoY29sdW1ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnTm8gdmFsaWQgZGVhbCBkYXRhIHByb3ZpZGVkJyB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGluc2VydFF1ZXJ5ID0gYFxyXG4gICAgICBJTlNFUlQgSU5UTyBkZWFscyAoJHtjb2x1bW5zLmpvaW4oJywgJyl9KVxyXG4gICAgICBWQUxVRVMgKCR7cGxhY2Vob2xkZXJzLmpvaW4oJywgJyl9KVxyXG4gICAgICBSRVRVUk5JTkcgKlxyXG4gICAgYDtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ0luc2VydCBxdWVyeTonLCBpbnNlcnRRdWVyeSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KGluc2VydFF1ZXJ5LCB2YWx1ZXMpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdJbnNlcnQgcmVzdWx0OicsIHJlc3VsdC5yb3dzWzBdKTtcclxuXHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24ocmVzdWx0LnJvd3NbMF0pO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGRlYWw6JywgZXJyb3IpO1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gY3JlYXRlIGRlYWwnLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ0dFVCcsICdQT1NUJ10pO1xyXG4gICAgICByZXMuc3RhdHVzKDQwNSkuZW5kKGBNZXRob2QgJHtyZXEubWV0aG9kfSBOb3QgQWxsb3dlZGApO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJxdWVyeSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJsaW1pdCIsIm9mZnNldCIsInNvcnRCeSIsIm9yZGVyIiwidGFibGVJbmZvUXVlcnkiLCJ0YWJsZUluZm8iLCJkZWFsQ29sdW1ucyIsInJvd3MiLCJtYXAiLCJyb3ciLCJjb2x1bW5fbmFtZSIsImNvbnNvbGUiLCJsb2ciLCJkZWFsSWRDb2x1bW4iLCJmaW5kIiwiY29sIiwiaGFzUHJvcGVydHlJZCIsImluY2x1ZGVzIiwiZGVhbHNRdWVyeSIsImNvdW50UXVlcnkiLCJkZWFsc1Jlc3VsdCIsImNvdW50UmVzdWx0IiwiUHJvbWlzZSIsImFsbCIsImRlYWxzIiwibGVuZ3RoIiwiaSIsImludmVzdG1lbnRfYW1vdW50IiwicHVyY2hhc2VfcHJpY2UiLCJleHBlY3RlZF9yZXR1cm4iLCJwcm9wZXJ0eV90eXBlIiwidG9Mb3dlckNhc2UiLCJudW1iZXJfb2Zfcm9vbXMiLCJwcmljZV9wZXJfa2V5IiwiTWF0aCIsInJvdW5kIiwiaG9sZF9wZXJpb2QiLCJ0YWJsZUNoZWNrIiwicHJvcGVydHlfaWQiLCJwcm9wZXJ0eURhdGEiLCJwcm9wZXJ0eSIsInByb3BlcnR5X25hbWUiLCJwcm9wZXJ0eV9hZGRyZXNzIiwiY2l0eSIsInN0YXRlIiwiaG90ZWxfdHlwZV9uYW1lIiwicm9vbV9jb3VudCIsInN0YXJfcmF0aW5nIiwiYnJhbmQiLCJjaGFpbl9zY2FsZSIsInllYXJfYnVpbHQiLCJ5ZWFyX3Jlbm92YXRlZCIsImVyciIsIm1lc3NhZ2UiLCJhY3F1aXNpdGlvbkRhdGEiLCJkZWFsX2lkIiwicHJvcGVydHlJbmZvUXVlcnkiLCJwcm9wZXJ0eUluZm8iLCJkZWFsIiwicHJvcGVydHlRdWVyeSIsInByb3BlcnR5UmVzdWx0IiwibWFya2V0X25hbWUiLCJwcm9wRXJyb3IiLCJlcnJvciIsImVuaGFuY2VFcnJvciIsInN0YXR1cyIsImpzb24iLCJ0b3RhbCIsInBhcnNlSW50IiwiY291bnQiLCJkZXRhaWxzIiwicmVxdWVzdEJvZHkiLCJib2R5IiwiY3JlYXRlVGFibGVRdWVyeSIsInByb3BlcnR5SWQiLCJ1bmRlZmluZWQiLCJwcm9wZXJ0eV9rZXkiLCJkYXRhVG9JbnNlcnQiLCJkZWFsX25hbWUiLCJzdGFydF9kYXRlIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic3BsaXQiLCJlbmRfZGF0ZSIsInNldEZ1bGxZZWFyIiwiZ2V0RnVsbFllYXIiLCJjb2x1bW5zIiwidmFsdWVzIiwicGxhY2Vob2xkZXJzIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJrZXkiLCJwdXNoIiwiaW5zZXJ0UXVlcnkiLCJqb2luIiwicmVzdWx0Iiwic2V0SGVhZGVyIiwiZW5kIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/deals/index.js\n");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeals&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdeals%5Cindex.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();