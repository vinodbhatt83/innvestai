"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/deals";
exports.ids = ["pages/api/deals"];
exports.modules = {

/***/ "(api-node)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pool: () => (/* binding */ pool),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n// lib/db.js\n// Initialize query and pool as null\nlet pool = null;\nlet query = null;\n// Only run this code on the server\nif (true) {\n    try {\n        // Server-side code - import pg using require to avoid webpack issues\n        const { Pool } = __webpack_require__(/*! pg */ \"pg\");\n        // Create a database connection pool\n        pool =  false ? 0 : new Pool({\n            user: process.env.DB_USER || 'postgres',\n            host: process.env.DB_HOST || 'localhost',\n            database: process.env.DB_NAME || 'innvestai',\n            password: process.env.DB_PASSWORD || 'Temp@123',\n            port: parseInt(process.env.DB_PORT || '5432')\n        });\n        // Define the query function\n        query = async (text, params)=>{\n            try {\n                const start = Date.now();\n                const res = await pool.query(text, params);\n                const duration = Date.now() - start;\n                // Log query performance in development\n                if (true) {\n                    console.log('Executed query', {\n                        text,\n                        duration,\n                        rows: res.rowCount\n                    });\n                }\n                return res;\n            } catch (error) {\n                console.error('Database query error:', error);\n                throw error;\n            }\n        };\n        // Setup event handlers for the pool\n        pool.on('error', (err)=>{\n            console.error('Unexpected database error:', err);\n        // Don't crash the server on connection errors\n        });\n        console.log('Database module initialized on server');\n    } catch (error) {\n        console.error('Failed to initialize database module:', error);\n        // Create non-functional stubs if initialization fails\n        pool = {\n            query: ()=>{\n                throw new Error('Database pool not initialized');\n            },\n            on: ()=>{}\n        };\n        query = async ()=>{\n            throw new Error('Database query function not initialized');\n        };\n    }\n} else {}\n// Choose one export style based on the environment\n// Use ES modules export style since that's what the rest of your code uses\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL2xpYi9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLFlBQVk7QUFFWixvQ0FBb0M7QUFDcEMsSUFBSUEsT0FBTztBQUNYLElBQUlDLFFBQVE7QUFFWixtQ0FBbUM7QUFDbkMsSUFBSSxJQUE2QixFQUFFO0lBQ2pDLElBQUk7UUFDRixxRUFBcUU7UUFDckUsTUFBTSxFQUFFQyxJQUFJLEVBQUUsR0FBR0MsbUJBQU9BLENBQUMsY0FBSTtRQUU3QixvQ0FBb0M7UUFDcENILE9BQU9JLE1BQXFDLEdBQ3hDLENBS0UsR0FDRixJQUFJRixLQUFLO1lBQ1BRLE1BQU1OLFFBQVFFLEdBQUcsQ0FBQ0ssT0FBTyxJQUFJO1lBQzdCQyxNQUFNUixRQUFRRSxHQUFHLENBQUNPLE9BQU8sSUFBSTtZQUM3QkMsVUFBVVYsUUFBUUUsR0FBRyxDQUFDUyxPQUFPLElBQUk7WUFDakNDLFVBQVVaLFFBQVFFLEdBQUcsQ0FBQ1csV0FBVyxJQUFJO1lBQ3JDQyxNQUFNQyxTQUFTZixRQUFRRSxHQUFHLENBQUNjLE9BQU8sSUFBSTtRQUN4QztRQUVKLDRCQUE0QjtRQUM1Qm5CLFFBQVEsT0FBT29CLE1BQU1DO1lBQ25CLElBQUk7Z0JBQ0YsTUFBTUMsUUFBUUMsS0FBS0MsR0FBRztnQkFDdEIsTUFBTUMsTUFBTSxNQUFNMUIsS0FBS0MsS0FBSyxDQUFDb0IsTUFBTUM7Z0JBQ25DLE1BQU1LLFdBQVdILEtBQUtDLEdBQUcsS0FBS0Y7Z0JBRTlCLHVDQUF1QztnQkFDdkMsSUFBSW5CLElBQXFDLEVBQUU7b0JBQ3pDd0IsUUFBUUMsR0FBRyxDQUFDLGtCQUFrQjt3QkFBRVI7d0JBQU1NO3dCQUFVRyxNQUFNSixJQUFJSyxRQUFRO29CQUFDO2dCQUNyRTtnQkFFQSxPQUFPTDtZQUNULEVBQUUsT0FBT00sT0FBTztnQkFDZEosUUFBUUksS0FBSyxDQUFDLHlCQUF5QkE7Z0JBQ3ZDLE1BQU1BO1lBQ1I7UUFDRjtRQUVBLG9DQUFvQztRQUNwQ2hDLEtBQUtpQyxFQUFFLENBQUMsU0FBUyxDQUFDQztZQUNoQk4sUUFBUUksS0FBSyxDQUFDLDhCQUE4QkU7UUFDNUMsOENBQThDO1FBQ2hEO1FBRUFOLFFBQVFDLEdBQUcsQ0FBQztJQUNkLEVBQUUsT0FBT0csT0FBTztRQUNkSixRQUFRSSxLQUFLLENBQUMseUNBQXlDQTtRQUV2RCxzREFBc0Q7UUFDdERoQyxPQUFPO1lBQ0xDLE9BQU87Z0JBQVEsTUFBTSxJQUFJa0MsTUFBTTtZQUFrQztZQUNqRUYsSUFBSSxLQUFPO1FBQ2I7UUFFQWhDLFFBQVE7WUFBYyxNQUFNLElBQUlrQyxNQUFNO1FBQTRDO0lBQ3BGO0FBQ0YsT0FBTyxFQVlOO0FBRUQsbURBQW1EO0FBQ25ELDJFQUEyRTtBQUNwRCIsInNvdXJjZXMiOlsiQzpcXHZpbm9kXFxwcm9qZWN0c1xcaW5udmVzdFxcUE9DXFxpbm52ZXN0YWlcXGxpYlxcZGIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL2RiLmpzXHJcblxyXG4vLyBJbml0aWFsaXplIHF1ZXJ5IGFuZCBwb29sIGFzIG51bGxcclxubGV0IHBvb2wgPSBudWxsO1xyXG5sZXQgcXVlcnkgPSBudWxsO1xyXG5cclxuLy8gT25seSBydW4gdGhpcyBjb2RlIG9uIHRoZSBzZXJ2ZXJcclxuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFNlcnZlci1zaWRlIGNvZGUgLSBpbXBvcnQgcGcgdXNpbmcgcmVxdWlyZSB0byBhdm9pZCB3ZWJwYWNrIGlzc3Vlc1xyXG4gICAgY29uc3QgeyBQb29sIH0gPSByZXF1aXJlKCdwZycpO1xyXG5cclxuICAgIC8vIENyZWF0ZSBhIGRhdGFiYXNlIGNvbm5lY3Rpb24gcG9vbFxyXG4gICAgcG9vbCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgXHJcbiAgICAgID8gbmV3IFBvb2woe1xyXG4gICAgICAgICAgY29ubmVjdGlvblN0cmluZzogcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMLFxyXG4gICAgICAgICAgc3NsOiB7XHJcbiAgICAgICAgICAgIHJlamVjdFVuYXV0aG9yaXplZDogZmFsc2VcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICA6IG5ldyBQb29sKHtcclxuICAgICAgICAgIHVzZXI6IHByb2Nlc3MuZW52LkRCX1VTRVIgfHwgJ3Bvc3RncmVzJyxcclxuICAgICAgICAgIGhvc3Q6IHByb2Nlc3MuZW52LkRCX0hPU1QgfHwgJ2xvY2FsaG9zdCcsXHJcbiAgICAgICAgICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuREJfTkFNRSB8fCAnaW5udmVzdGFpJywgLy8gVXNlIGJ1aWx0LWluIHBvc3RncmVzIGRhdGFiYXNlXHJcbiAgICAgICAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQgfHwgJ1RlbXBAMTIzJyxcclxuICAgICAgICAgIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52LkRCX1BPUlQgfHwgJzU0MzInKSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAvLyBEZWZpbmUgdGhlIHF1ZXJ5IGZ1bmN0aW9uXHJcbiAgICBxdWVyeSA9IGFzeW5jICh0ZXh0LCBwYXJhbXMpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XHJcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9vbC5xdWVyeSh0ZXh0LCBwYXJhbXMpO1xyXG4gICAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIExvZyBxdWVyeSBwZXJmb3JtYW5jZSBpbiBkZXZlbG9wbWVudFxyXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnRXhlY3V0ZWQgcXVlcnknLCB7IHRleHQsIGR1cmF0aW9uLCByb3dzOiByZXMucm93Q291bnQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgcXVlcnkgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFNldHVwIGV2ZW50IGhhbmRsZXJzIGZvciB0aGUgcG9vbFxyXG4gICAgcG9vbC5vbignZXJyb3InLCAoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgZGF0YWJhc2UgZXJyb3I6JywgZXJyKTtcclxuICAgICAgLy8gRG9uJ3QgY3Jhc2ggdGhlIHNlcnZlciBvbiBjb25uZWN0aW9uIGVycm9yc1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0RhdGFiYXNlIG1vZHVsZSBpbml0aWFsaXplZCBvbiBzZXJ2ZXInKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgZGF0YWJhc2UgbW9kdWxlOicsIGVycm9yKTtcclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIG5vbi1mdW5jdGlvbmFsIHN0dWJzIGlmIGluaXRpYWxpemF0aW9uIGZhaWxzXHJcbiAgICBwb29sID0ge1xyXG4gICAgICBxdWVyeTogKCkgPT4geyB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHBvb2wgbm90IGluaXRpYWxpemVkJyk7IH0sXHJcbiAgICAgIG9uOiAoKSA9PiB7fVxyXG4gICAgfTtcclxuXHJcbiAgICBxdWVyeSA9IGFzeW5jICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBxdWVyeSBmdW5jdGlvbiBub3QgaW5pdGlhbGl6ZWQnKTsgfTtcclxuICB9XHJcbn0gZWxzZSB7XHJcbiAgLy8gQ2xpZW50LXNpZGUgbW9jayBpbXBsZW1lbnRhdGlvblxyXG4gIHF1ZXJ5ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBxdWVyaWVzIGNhbm5vdCBiZSBleGVjdXRlZCBvbiB0aGUgY2xpZW50IHNpZGUnKTtcclxuICB9O1xyXG4gIFxyXG4gIHBvb2wgPSB7XHJcbiAgICBxdWVyeTogKCkgPT4ge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHF1ZXJpZXMgY2Fubm90IGJlIGV4ZWN1dGVkIG9uIHRoZSBjbGllbnQgc2lkZScpO1xyXG4gICAgfSxcclxuICAgIG9uOiAoKSA9PiB7fVxyXG4gIH07XHJcbn1cclxuXHJcbi8vIENob29zZSBvbmUgZXhwb3J0IHN0eWxlIGJhc2VkIG9uIHRoZSBlbnZpcm9ubWVudFxyXG4vLyBVc2UgRVMgbW9kdWxlcyBleHBvcnQgc3R5bGUgc2luY2UgdGhhdCdzIHdoYXQgdGhlIHJlc3Qgb2YgeW91ciBjb2RlIHVzZXNcclxuZXhwb3J0IHsgcXVlcnksIHBvb2wgfTsiXSwibmFtZXMiOlsicG9vbCIsInF1ZXJ5IiwiUG9vbCIsInJlcXVpcmUiLCJwcm9jZXNzIiwiY29ubmVjdGlvblN0cmluZyIsImVudiIsIkRBVEFCQVNFX1VSTCIsInNzbCIsInJlamVjdFVuYXV0aG9yaXplZCIsInVzZXIiLCJEQl9VU0VSIiwiaG9zdCIsIkRCX0hPU1QiLCJkYXRhYmFzZSIsIkRCX05BTUUiLCJwYXNzd29yZCIsIkRCX1BBU1NXT1JEIiwicG9ydCIsInBhcnNlSW50IiwiREJfUE9SVCIsInRleHQiLCJwYXJhbXMiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJyZXMiLCJkdXJhdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJyb3dzIiwicm93Q291bnQiLCJlcnJvciIsIm9uIiwiZXJyIiwiRXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./lib/db.js\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeals&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdeals%5Cindex.js&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeals&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdeals%5Cindex.js&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_deals_index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\deals\\index.js */ \"(api-node)/./pages/api/deals/index.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_deals_index_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_deals_index_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/deals\",\n        pathname: \"/api/deals\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_deals_index_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGZGVhbHMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2RlYWxzJTVDaW5kZXguanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ0U7QUFDMUQ7QUFDMEQ7QUFDMUQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHNEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxzREFBUTtBQUNwQztBQUNPLHdCQUF3Qix5R0FBbUI7QUFDbEQ7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxkZWFsc1xcXFxpbmRleC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZGVhbHNcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9kZWFsc1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeals&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdeals%5Cindex.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/deals/index.js":
/*!**********************************!*\
  !*** ./pages/api/deals/index.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/db */ \"(api-node)/./lib/db.js\");\n// pages/api/deals/index.js\n\nasync function handler(req, res) {\n    switch(req.method){\n        case 'GET':\n            try {\n                // Get all deals with optional filtering\n                const { limit = 10, offset = 0, sortBy = 'created_at', order = 'DESC' } = req.query;\n                // First, check the structure of the deals table\n                const tableInfoQuery = `\n          SELECT column_name \n          FROM information_schema.columns \n          WHERE table_schema = 'public' \n          AND table_name = 'deals';\n        `;\n                const tableInfo = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(tableInfoQuery);\n                const dealColumns = tableInfo.rows.map((row)=>row.column_name);\n                console.log('Deal table columns:', dealColumns);\n                // Get the deal ID column name (deal_id or id)\n                const dealIdColumn = dealColumns.find((col)=>col === 'deal_id' || col === 'id') || 'id';\n                // Check if property_id exists in deals\n                const hasPropertyId = dealColumns.includes('property_id');\n                // Get all deals\n                let dealsQuery;\n                if (hasPropertyId) {\n                    // Attempt a simple query first to see if it works\n                    dealsQuery = `\n            SELECT * FROM deals\n            ORDER BY ${dealColumns.includes('created_at') ? 'created_at' : dealIdColumn} ${order === 'ASC' ? 'ASC' : 'DESC'}\n            LIMIT $1 OFFSET $2\n          `;\n                } else {\n                    // If no property_id, just get deals without trying to join\n                    dealsQuery = `\n            SELECT * FROM deals\n            ORDER BY ${dealColumns.includes('created_at') ? 'created_at' : dealIdColumn} ${order === 'ASC' ? 'ASC' : 'DESC'}\n            LIMIT $1 OFFSET $2\n          `;\n                }\n                const countQuery = `SELECT COUNT(*) FROM deals`;\n                const [dealsResult, countResult] = await Promise.all([\n                    (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(dealsQuery, [\n                        limit,\n                        offset\n                    ]),\n                    (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(countQuery)\n                ]);\n                // If we have deals and property_id exists, try to get property details\n                const deals = [\n                    ...dealsResult.rows\n                ];\n                // This is just the part of the code that needs to be fixed in pages/api/deals/index.js\n                // When enhancing each deal with property info in the GET handler:\n                if (deals.length > 0 && hasPropertyId) {\n                    // Try to enhance deals with property info\n                    try {\n                        // First, check if dim_property table exists and get its structure\n                        const propertyInfoQuery = `\n      SELECT column_name \n      FROM information_schema.columns \n      WHERE table_schema = 'public' \n      AND table_name = 'dim_property';\n    `;\n                        const propertyInfo = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(propertyInfoQuery);\n                        if (propertyInfo.rows.length > 0) {\n                            // Enhance each deal with property info\n                            for(let i = 0; i < deals.length; i++){\n                                const deal = deals[i];\n                                if (deal.property_id) {\n                                    // Use property_key instead of property_id\n                                    const propertyQuery = `\n            SELECT p.*, h.hotel_type_name, m.market_name\n            FROM dim_property p\n            LEFT JOIN dim_hotel_type h ON p.hotel_type_key = h.hotel_type_key\n            LEFT JOIN dim_market m ON p.market_key = m.market_key\n            WHERE p.property_key = $1\n          `;\n                                    try {\n                                        const propertyResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(propertyQuery, [\n                                            deal.property_id\n                                        ]);\n                                        const property = propertyResult.rows[0];\n                                        if (property) {\n                                            deals[i] = {\n                                                ...deal,\n                                                property_name: property.property_name,\n                                                hotel_type_name: property.hotel_type_name,\n                                                market_name: property.market_name\n                                            };\n                                        }\n                                    } catch (propError) {\n                                        console.error('Error fetching property for deal:', propError);\n                                    // If property fetch fails, continue with original deal\n                                    }\n                                }\n                            }\n                        }\n                    } catch (enhanceError) {\n                        console.error('Error enhancing deals with property info:', enhanceError);\n                    // Continue with basic deal data\n                    }\n                }\n                res.status(200).json({\n                    deals,\n                    total: parseInt(countResult.rows[0].count),\n                    limit: parseInt(limit),\n                    offset: parseInt(offset)\n                });\n            } catch (error) {\n                console.error('Error executing query:', error);\n                res.status(500).json({\n                    error: 'Failed to retrieve deals',\n                    details: error.message\n                });\n            }\n            break;\n        // pages/api/deals/index.js (POST section updated)\n        case 'POST':\n            try {\n                // Extract form fields from the request\n                const requestBody = req.body;\n                console.log('Request body:', requestBody);\n                // Check the structure of the deals table\n                const tableInfoQuery = `\n      SELECT column_name \n      FROM information_schema.columns \n      WHERE table_schema = 'public' \n      AND table_name = 'deals';\n    `;\n                let tableInfo;\n                try {\n                    tableInfo = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(tableInfoQuery);\n                } catch (error) {\n                    console.log('Error getting table info, deals table might not exist');\n                    // Create a complete deals table with all required fields\n                    const createTableQuery = `\n        CREATE TABLE IF NOT EXISTS deals (\n          id SERIAL PRIMARY KEY,\n          property_id INTEGER,\n          deal_name VARCHAR(255) NOT NULL,\n          investment_amount DECIMAL(15, 2) NOT NULL DEFAULT 1000000,\n          expected_return DECIMAL(6, 2) NOT NULL DEFAULT 8.5,\n          start_date DATE NOT NULL DEFAULT CURRENT_DATE,\n          end_date DATE NOT NULL DEFAULT (CURRENT_DATE + INTERVAL '5 years'),\n          status VARCHAR(50) DEFAULT 'Draft',\n          created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n          updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        );\n      `;\n                    await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(createTableQuery);\n                    console.log('Created deals table with all required columns');\n                    // Get the columns again\n                    tableInfo = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(tableInfoQuery);\n                }\n                const dealColumns = tableInfo.rows.map((row)=>row.column_name);\n                console.log('Deal table columns after check:', dealColumns);\n                // Map property_id if it was sent from the client as property_key\n                let propertyId = requestBody.property_id;\n                // If property_id wasn't sent but property_key was, use that instead\n                if (propertyId === undefined && requestBody.property_key !== undefined) {\n                    propertyId = requestBody.property_key;\n                }\n                // Include the required fields with default values if not provided\n                const dataToInsert = {\n                    deal_name: requestBody.deal_name,\n                    property_id: propertyId || null,\n                    investment_amount: requestBody.investment_amount || 1000000,\n                    expected_return: requestBody.expected_return || 8.5,\n                    start_date: requestBody.start_date || new Date().toISOString().split('T')[0],\n                    end_date: requestBody.end_date || new Date(new Date().setFullYear(new Date().getFullYear() + 5)).toISOString().split('T')[0],\n                    status: requestBody.status || 'Draft'\n                };\n                // Generate the column list and placeholders\n                const columns = [];\n                const values = [];\n                let placeholders = [];\n                // Add fields that exist in the database\n                Object.keys(dataToInsert).forEach((key)=>{\n                    if (dealColumns.includes(key) && dataToInsert[key] !== undefined) {\n                        columns.push(key);\n                        values.push(dataToInsert[key]);\n                        placeholders.push(`$${values.length}`);\n                    }\n                });\n                // Add created_at if in columns\n                if (dealColumns.includes('created_at') && !columns.includes('created_at')) {\n                    columns.push('created_at');\n                    values.push(new Date());\n                    placeholders.push(`$${values.length}`);\n                }\n                console.log('Columns to insert:', columns);\n                console.log('Values to insert:', values);\n                if (columns.length === 0) {\n                    return res.status(400).json({\n                        error: 'No valid deal data provided'\n                    });\n                }\n                const insertQuery = `\n      INSERT INTO deals (${columns.join(', ')})\n      VALUES (${placeholders.join(', ')})\n      RETURNING *\n    `;\n                console.log('Insert query:', insertQuery);\n                const result = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.query)(insertQuery, values);\n                console.log('Insert result:', result.rows[0]);\n                res.status(201).json(result.rows[0]);\n            } catch (error) {\n                console.error('Error creating deal:', error);\n                res.status(500).json({\n                    error: 'Failed to create deal',\n                    details: error.message\n                });\n            }\n            break;\n        default:\n            res.setHeader('Allow', [\n                'GET',\n                'POST'\n            ]);\n            res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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b0JBQUVILE9BQU87b0JBQXlCTyxTQUFTUCxNQUFNUSxPQUFPO2dCQUFDO1lBQ2hGO1lBQ0E7UUFDRjtZQUNFaEQsSUFBSTZFLFNBQVMsQ0FBQyxTQUFTO2dCQUFDO2dCQUFPO2FBQU87WUFDdEM3RSxJQUFJMEMsTUFBTSxDQUFDLEtBQUtvQyxHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUUvRSxJQUFJRSxNQUFNLENBQUMsWUFBWSxDQUFDO0lBQzFEO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFx2aW5vZFxccHJvamVjdHNcXGlubnZlc3RcXFBPQ1xcaW5udmVzdGFpXFxwYWdlc1xcYXBpXFxkZWFsc1xcaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvYXBpL2RlYWxzL2luZGV4LmpzXHJcbmltcG9ydCB7IHF1ZXJ5IH0gZnJvbSAnLi4vLi4vLi4vbGliL2RiJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICBzd2l0Y2ggKHJlcS5tZXRob2QpIHtcclxuICAgIGNhc2UgJ0dFVCc6XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBkZWFscyB3aXRoIG9wdGlvbmFsIGZpbHRlcmluZ1xyXG4gICAgICAgIGNvbnN0IHsgbGltaXQgPSAxMCwgb2Zmc2V0ID0gMCwgc29ydEJ5ID0gJ2NyZWF0ZWRfYXQnLCBvcmRlciA9ICdERVNDJyB9ID0gcmVxLnF1ZXJ5O1xyXG5cclxuICAgICAgICAvLyBGaXJzdCwgY2hlY2sgdGhlIHN0cnVjdHVyZSBvZiB0aGUgZGVhbHMgdGFibGVcclxuICAgICAgICBjb25zdCB0YWJsZUluZm9RdWVyeSA9IGBcclxuICAgICAgICAgIFNFTEVDVCBjb2x1bW5fbmFtZSBcclxuICAgICAgICAgIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLmNvbHVtbnMgXHJcbiAgICAgICAgICBXSEVSRSB0YWJsZV9zY2hlbWEgPSAncHVibGljJyBcclxuICAgICAgICAgIEFORCB0YWJsZV9uYW1lID0gJ2RlYWxzJztcclxuICAgICAgICBgO1xyXG5cclxuICAgICAgICBjb25zdCB0YWJsZUluZm8gPSBhd2FpdCBxdWVyeSh0YWJsZUluZm9RdWVyeSk7XHJcbiAgICAgICAgY29uc3QgZGVhbENvbHVtbnMgPSB0YWJsZUluZm8ucm93cy5tYXAocm93ID0+IHJvdy5jb2x1bW5fbmFtZSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0RlYWwgdGFibGUgY29sdW1uczonLCBkZWFsQ29sdW1ucyk7XHJcblxyXG4gICAgICAgIC8vIEdldCB0aGUgZGVhbCBJRCBjb2x1bW4gbmFtZSAoZGVhbF9pZCBvciBpZClcclxuICAgICAgICBjb25zdCBkZWFsSWRDb2x1bW4gPSBkZWFsQ29sdW1ucy5maW5kKGNvbCA9PlxyXG4gICAgICAgICAgY29sID09PSAnZGVhbF9pZCcgfHwgY29sID09PSAnaWQnXHJcbiAgICAgICAgKSB8fCAnaWQnO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiBwcm9wZXJ0eV9pZCBleGlzdHMgaW4gZGVhbHNcclxuICAgICAgICBjb25zdCBoYXNQcm9wZXJ0eUlkID0gZGVhbENvbHVtbnMuaW5jbHVkZXMoJ3Byb3BlcnR5X2lkJyk7XHJcblxyXG4gICAgICAgIC8vIEdldCBhbGwgZGVhbHNcclxuICAgICAgICBsZXQgZGVhbHNRdWVyeTtcclxuXHJcbiAgICAgICAgaWYgKGhhc1Byb3BlcnR5SWQpIHtcclxuICAgICAgICAgIC8vIEF0dGVtcHQgYSBzaW1wbGUgcXVlcnkgZmlyc3QgdG8gc2VlIGlmIGl0IHdvcmtzXHJcbiAgICAgICAgICBkZWFsc1F1ZXJ5ID0gYFxyXG4gICAgICAgICAgICBTRUxFQ1QgKiBGUk9NIGRlYWxzXHJcbiAgICAgICAgICAgIE9SREVSIEJZICR7ZGVhbENvbHVtbnMuaW5jbHVkZXMoJ2NyZWF0ZWRfYXQnKSA/ICdjcmVhdGVkX2F0JyA6IGRlYWxJZENvbHVtbn0gJHtvcmRlciA9PT0gJ0FTQycgPyAnQVNDJyA6ICdERVNDJ31cclxuICAgICAgICAgICAgTElNSVQgJDEgT0ZGU0VUICQyXHJcbiAgICAgICAgICBgO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBJZiBubyBwcm9wZXJ0eV9pZCwganVzdCBnZXQgZGVhbHMgd2l0aG91dCB0cnlpbmcgdG8gam9pblxyXG4gICAgICAgICAgZGVhbHNRdWVyeSA9IGBcclxuICAgICAgICAgICAgU0VMRUNUICogRlJPTSBkZWFsc1xyXG4gICAgICAgICAgICBPUkRFUiBCWSAke2RlYWxDb2x1bW5zLmluY2x1ZGVzKCdjcmVhdGVkX2F0JykgPyAnY3JlYXRlZF9hdCcgOiBkZWFsSWRDb2x1bW59ICR7b3JkZXIgPT09ICdBU0MnID8gJ0FTQycgOiAnREVTQyd9XHJcbiAgICAgICAgICAgIExJTUlUICQxIE9GRlNFVCAkMlxyXG4gICAgICAgICAgYDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGNvdW50UXVlcnkgPSBgU0VMRUNUIENPVU5UKCopIEZST00gZGVhbHNgO1xyXG5cclxuICAgICAgICBjb25zdCBbZGVhbHNSZXN1bHQsIGNvdW50UmVzdWx0XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgICAgIHF1ZXJ5KGRlYWxzUXVlcnksIFtsaW1pdCwgb2Zmc2V0XSksXHJcbiAgICAgICAgICBxdWVyeShjb3VudFF1ZXJ5KVxyXG4gICAgICAgIF0pO1xyXG5cclxuICAgICAgICAvLyBJZiB3ZSBoYXZlIGRlYWxzIGFuZCBwcm9wZXJ0eV9pZCBleGlzdHMsIHRyeSB0byBnZXQgcHJvcGVydHkgZGV0YWlsc1xyXG4gICAgICAgIGNvbnN0IGRlYWxzID0gWy4uLmRlYWxzUmVzdWx0LnJvd3NdO1xyXG5cclxuICAgICAgICAvLyBUaGlzIGlzIGp1c3QgdGhlIHBhcnQgb2YgdGhlIGNvZGUgdGhhdCBuZWVkcyB0byBiZSBmaXhlZCBpbiBwYWdlcy9hcGkvZGVhbHMvaW5kZXguanNcclxuXHJcbiAgICAgICAgLy8gV2hlbiBlbmhhbmNpbmcgZWFjaCBkZWFsIHdpdGggcHJvcGVydHkgaW5mbyBpbiB0aGUgR0VUIGhhbmRsZXI6XHJcbiAgICAgICAgaWYgKGRlYWxzLmxlbmd0aCA+IDAgJiYgaGFzUHJvcGVydHlJZCkge1xyXG4gICAgICAgICAgLy8gVHJ5IHRvIGVuaGFuY2UgZGVhbHMgd2l0aCBwcm9wZXJ0eSBpbmZvXHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBGaXJzdCwgY2hlY2sgaWYgZGltX3Byb3BlcnR5IHRhYmxlIGV4aXN0cyBhbmQgZ2V0IGl0cyBzdHJ1Y3R1cmVcclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydHlJbmZvUXVlcnkgPSBgXHJcbiAgICAgIFNFTEVDVCBjb2x1bW5fbmFtZSBcclxuICAgICAgRlJPTSBpbmZvcm1hdGlvbl9zY2hlbWEuY29sdW1ucyBcclxuICAgICAgV0hFUkUgdGFibGVfc2NoZW1hID0gJ3B1YmxpYycgXHJcbiAgICAgIEFORCB0YWJsZV9uYW1lID0gJ2RpbV9wcm9wZXJ0eSc7XHJcbiAgICBgO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHJvcGVydHlJbmZvID0gYXdhaXQgcXVlcnkocHJvcGVydHlJbmZvUXVlcnkpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHByb3BlcnR5SW5mby5yb3dzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAvLyBFbmhhbmNlIGVhY2ggZGVhbCB3aXRoIHByb3BlcnR5IGluZm9cclxuICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlYWxzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZWFsID0gZGVhbHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZGVhbC5wcm9wZXJ0eV9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAvLyBVc2UgcHJvcGVydHlfa2V5IGluc3RlYWQgb2YgcHJvcGVydHlfaWRcclxuICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcGVydHlRdWVyeSA9IGBcclxuICAgICAgICAgICAgU0VMRUNUIHAuKiwgaC5ob3RlbF90eXBlX25hbWUsIG0ubWFya2V0X25hbWVcclxuICAgICAgICAgICAgRlJPTSBkaW1fcHJvcGVydHkgcFxyXG4gICAgICAgICAgICBMRUZUIEpPSU4gZGltX2hvdGVsX3R5cGUgaCBPTiBwLmhvdGVsX3R5cGVfa2V5ID0gaC5ob3RlbF90eXBlX2tleVxyXG4gICAgICAgICAgICBMRUZUIEpPSU4gZGltX21hcmtldCBtIE9OIHAubWFya2V0X2tleSA9IG0ubWFya2V0X2tleVxyXG4gICAgICAgICAgICBXSEVSRSBwLnByb3BlcnR5X2tleSA9ICQxXHJcbiAgICAgICAgICBgO1xyXG5cclxuICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0eVJlc3VsdCA9IGF3YWl0IHF1ZXJ5KHByb3BlcnR5UXVlcnksIFtkZWFsLnByb3BlcnR5X2lkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcGVydHkgPSBwcm9wZXJ0eVJlc3VsdC5yb3dzWzBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvcGVydHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGRlYWxzW2ldID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5kZWFsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eV9uYW1lOiBwcm9wZXJ0eS5wcm9wZXJ0eV9uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBob3RlbF90eXBlX25hbWU6IHByb3BlcnR5LmhvdGVsX3R5cGVfbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2V0X25hbWU6IHByb3BlcnR5Lm1hcmtldF9uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfSBjYXRjaCAocHJvcEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvcGVydHkgZm9yIGRlYWw6JywgcHJvcEVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBwcm9wZXJ0eSBmZXRjaCBmYWlscywgY29udGludWUgd2l0aCBvcmlnaW5hbCBkZWFsXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gY2F0Y2ggKGVuaGFuY2VFcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBlbmhhbmNpbmcgZGVhbHMgd2l0aCBwcm9wZXJ0eSBpbmZvOicsIGVuaGFuY2VFcnJvcik7XHJcbiAgICAgICAgICAgIC8vIENvbnRpbnVlIHdpdGggYmFzaWMgZGVhbCBkYXRhXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgICBkZWFscyxcclxuICAgICAgICAgIHRvdGFsOiBwYXJzZUludChjb3VudFJlc3VsdC5yb3dzWzBdLmNvdW50KSxcclxuICAgICAgICAgIGxpbWl0OiBwYXJzZUludChsaW1pdCksXHJcbiAgICAgICAgICBvZmZzZXQ6IHBhcnNlSW50KG9mZnNldClcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgcXVlcnk6JywgZXJyb3IpO1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gcmV0cmlldmUgZGVhbHMnLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIC8vIHBhZ2VzL2FwaS9kZWFscy9pbmRleC5qcyAoUE9TVCBzZWN0aW9uIHVwZGF0ZWQpXHJcbiAgICBjYXNlICdQT1NUJzpcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBFeHRyYWN0IGZvcm0gZmllbGRzIGZyb20gdGhlIHJlcXVlc3RcclxuICAgICAgICBjb25zdCByZXF1ZXN0Qm9keSA9IHJlcS5ib2R5O1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdSZXF1ZXN0IGJvZHk6JywgcmVxdWVzdEJvZHkpO1xyXG5cclxuICAgICAgICAvLyBDaGVjayB0aGUgc3RydWN0dXJlIG9mIHRoZSBkZWFscyB0YWJsZVxyXG4gICAgICAgIGNvbnN0IHRhYmxlSW5mb1F1ZXJ5ID0gYFxyXG4gICAgICBTRUxFQ1QgY29sdW1uX25hbWUgXHJcbiAgICAgIEZST00gaW5mb3JtYXRpb25fc2NoZW1hLmNvbHVtbnMgXHJcbiAgICAgIFdIRVJFIHRhYmxlX3NjaGVtYSA9ICdwdWJsaWMnIFxyXG4gICAgICBBTkQgdGFibGVfbmFtZSA9ICdkZWFscyc7XHJcbiAgICBgO1xyXG5cclxuICAgICAgICBsZXQgdGFibGVJbmZvO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICB0YWJsZUluZm8gPSBhd2FpdCBxdWVyeSh0YWJsZUluZm9RdWVyeSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBnZXR0aW5nIHRhYmxlIGluZm8sIGRlYWxzIHRhYmxlIG1pZ2h0IG5vdCBleGlzdCcpO1xyXG5cclxuICAgICAgICAgIC8vIENyZWF0ZSBhIGNvbXBsZXRlIGRlYWxzIHRhYmxlIHdpdGggYWxsIHJlcXVpcmVkIGZpZWxkc1xyXG4gICAgICAgICAgY29uc3QgY3JlYXRlVGFibGVRdWVyeSA9IGBcclxuICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBkZWFscyAoXHJcbiAgICAgICAgICBpZCBTRVJJQUwgUFJJTUFSWSBLRVksXHJcbiAgICAgICAgICBwcm9wZXJ0eV9pZCBJTlRFR0VSLFxyXG4gICAgICAgICAgZGVhbF9uYW1lIFZBUkNIQVIoMjU1KSBOT1QgTlVMTCxcclxuICAgICAgICAgIGludmVzdG1lbnRfYW1vdW50IERFQ0lNQUwoMTUsIDIpIE5PVCBOVUxMIERFRkFVTFQgMTAwMDAwMCxcclxuICAgICAgICAgIGV4cGVjdGVkX3JldHVybiBERUNJTUFMKDYsIDIpIE5PVCBOVUxMIERFRkFVTFQgOC41LFxyXG4gICAgICAgICAgc3RhcnRfZGF0ZSBEQVRFIE5PVCBOVUxMIERFRkFVTFQgQ1VSUkVOVF9EQVRFLFxyXG4gICAgICAgICAgZW5kX2RhdGUgREFURSBOT1QgTlVMTCBERUZBVUxUIChDVVJSRU5UX0RBVEUgKyBJTlRFUlZBTCAnNSB5ZWFycycpLFxyXG4gICAgICAgICAgc3RhdHVzIFZBUkNIQVIoNTApIERFRkFVTFQgJ0RyYWZ0JyxcclxuICAgICAgICAgIGNyZWF0ZWRfYXQgVElNRVNUQU1QIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsXHJcbiAgICAgICAgICB1cGRhdGVkX2F0IFRJTUVTVEFNUCBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QXHJcbiAgICAgICAgKTtcclxuICAgICAgYDtcclxuXHJcbiAgICAgICAgICBhd2FpdCBxdWVyeShjcmVhdGVUYWJsZVF1ZXJ5KTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIGRlYWxzIHRhYmxlIHdpdGggYWxsIHJlcXVpcmVkIGNvbHVtbnMnKTtcclxuXHJcbiAgICAgICAgICAvLyBHZXQgdGhlIGNvbHVtbnMgYWdhaW5cclxuICAgICAgICAgIHRhYmxlSW5mbyA9IGF3YWl0IHF1ZXJ5KHRhYmxlSW5mb1F1ZXJ5KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRlYWxDb2x1bW5zID0gdGFibGVJbmZvLnJvd3MubWFwKHJvdyA9PiByb3cuY29sdW1uX25hbWUpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdEZWFsIHRhYmxlIGNvbHVtbnMgYWZ0ZXIgY2hlY2s6JywgZGVhbENvbHVtbnMpO1xyXG5cclxuICAgICAgICAvLyBNYXAgcHJvcGVydHlfaWQgaWYgaXQgd2FzIHNlbnQgZnJvbSB0aGUgY2xpZW50IGFzIHByb3BlcnR5X2tleVxyXG4gICAgICAgIGxldCBwcm9wZXJ0eUlkID0gcmVxdWVzdEJvZHkucHJvcGVydHlfaWQ7XHJcblxyXG4gICAgICAgIC8vIElmIHByb3BlcnR5X2lkIHdhc24ndCBzZW50IGJ1dCBwcm9wZXJ0eV9rZXkgd2FzLCB1c2UgdGhhdCBpbnN0ZWFkXHJcbiAgICAgICAgaWYgKHByb3BlcnR5SWQgPT09IHVuZGVmaW5lZCAmJiByZXF1ZXN0Qm9keS5wcm9wZXJ0eV9rZXkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgcHJvcGVydHlJZCA9IHJlcXVlc3RCb2R5LnByb3BlcnR5X2tleTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEluY2x1ZGUgdGhlIHJlcXVpcmVkIGZpZWxkcyB3aXRoIGRlZmF1bHQgdmFsdWVzIGlmIG5vdCBwcm92aWRlZFxyXG4gICAgICAgIGNvbnN0IGRhdGFUb0luc2VydCA9IHtcclxuICAgICAgICAgIGRlYWxfbmFtZTogcmVxdWVzdEJvZHkuZGVhbF9uYW1lLFxyXG4gICAgICAgICAgcHJvcGVydHlfaWQ6IHByb3BlcnR5SWQgfHwgbnVsbCxcclxuICAgICAgICAgIGludmVzdG1lbnRfYW1vdW50OiByZXF1ZXN0Qm9keS5pbnZlc3RtZW50X2Ftb3VudCB8fCAxMDAwMDAwLFxyXG4gICAgICAgICAgZXhwZWN0ZWRfcmV0dXJuOiByZXF1ZXN0Qm9keS5leHBlY3RlZF9yZXR1cm4gfHwgOC41LFxyXG4gICAgICAgICAgc3RhcnRfZGF0ZTogcmVxdWVzdEJvZHkuc3RhcnRfZGF0ZSB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcclxuICAgICAgICAgIGVuZF9kYXRlOiByZXF1ZXN0Qm9keS5lbmRfZGF0ZSB8fCBuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldEZ1bGxZZWFyKG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSArIDUpKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sXHJcbiAgICAgICAgICBzdGF0dXM6IHJlcXVlc3RCb2R5LnN0YXR1cyB8fCAnRHJhZnQnXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gR2VuZXJhdGUgdGhlIGNvbHVtbiBsaXN0IGFuZCBwbGFjZWhvbGRlcnNcclxuICAgICAgICBjb25zdCBjb2x1bW5zID0gW107XHJcbiAgICAgICAgY29uc3QgdmFsdWVzID0gW107XHJcbiAgICAgICAgbGV0IHBsYWNlaG9sZGVycyA9IFtdO1xyXG5cclxuICAgICAgICAvLyBBZGQgZmllbGRzIHRoYXQgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXHJcbiAgICAgICAgT2JqZWN0LmtleXMoZGF0YVRvSW5zZXJ0KS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgICBpZiAoZGVhbENvbHVtbnMuaW5jbHVkZXMoa2V5KSAmJiBkYXRhVG9JbnNlcnRba2V5XSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGNvbHVtbnMucHVzaChrZXkpO1xyXG4gICAgICAgICAgICB2YWx1ZXMucHVzaChkYXRhVG9JbnNlcnRba2V5XSk7XHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVycy5wdXNoKGAkJHt2YWx1ZXMubGVuZ3RofWApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBBZGQgY3JlYXRlZF9hdCBpZiBpbiBjb2x1bW5zXHJcbiAgICAgICAgaWYgKGRlYWxDb2x1bW5zLmluY2x1ZGVzKCdjcmVhdGVkX2F0JykgJiYgIWNvbHVtbnMuaW5jbHVkZXMoJ2NyZWF0ZWRfYXQnKSkge1xyXG4gICAgICAgICAgY29sdW1ucy5wdXNoKCdjcmVhdGVkX2F0Jyk7XHJcbiAgICAgICAgICB2YWx1ZXMucHVzaChuZXcgRGF0ZSgpKTtcclxuICAgICAgICAgIHBsYWNlaG9sZGVycy5wdXNoKGAkJHt2YWx1ZXMubGVuZ3RofWApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ0NvbHVtbnMgdG8gaW5zZXJ0OicsIGNvbHVtbnMpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdWYWx1ZXMgdG8gaW5zZXJ0OicsIHZhbHVlcyk7XHJcblxyXG4gICAgICAgIGlmIChjb2x1bW5zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdObyB2YWxpZCBkZWFsIGRhdGEgcHJvdmlkZWQnIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaW5zZXJ0UXVlcnkgPSBgXHJcbiAgICAgIElOU0VSVCBJTlRPIGRlYWxzICgke2NvbHVtbnMuam9pbignLCAnKX0pXHJcbiAgICAgIFZBTFVFUyAoJHtwbGFjZWhvbGRlcnMuam9pbignLCAnKX0pXHJcbiAgICAgIFJFVFVSTklORyAqXHJcbiAgICBgO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnSW5zZXJ0IHF1ZXJ5OicsIGluc2VydFF1ZXJ5KTtcclxuXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoaW5zZXJ0UXVlcnksIHZhbHVlcyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0luc2VydCByZXN1bHQ6JywgcmVzdWx0LnJvd3NbMF0pO1xyXG5cclxuICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbihyZXN1bHQucm93c1swXSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZGVhbDonLCBlcnJvcik7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBjcmVhdGUgZGVhbCcsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICAgIH1cclxuICAgICAgYnJlYWs7XHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnR0VUJywgJ1BPU1QnXSk7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDA1KS5lbmQoYE1ldGhvZCAke3JlcS5tZXRob2R9IE5vdCBBbGxvd2VkYCk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbInF1ZXJ5IiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsImxpbWl0Iiwib2Zmc2V0Iiwic29ydEJ5Iiwib3JkZXIiLCJ0YWJsZUluZm9RdWVyeSIsInRhYmxlSW5mbyIsImRlYWxDb2x1bW5zIiwicm93cyIsIm1hcCIsInJvdyIsImNvbHVtbl9uYW1lIiwiY29uc29sZSIsImxvZyIsImRlYWxJZENvbHVtbiIsImZpbmQiLCJjb2wiLCJoYXNQcm9wZXJ0eUlkIiwiaW5jbHVkZXMiLCJkZWFsc1F1ZXJ5IiwiY291bnRRdWVyeSIsImRlYWxzUmVzdWx0IiwiY291bnRSZXN1bHQiLCJQcm9taXNlIiwiYWxsIiwiZGVhbHMiLCJsZW5ndGgiLCJwcm9wZXJ0eUluZm9RdWVyeSIsInByb3BlcnR5SW5mbyIsImkiLCJkZWFsIiwicHJvcGVydHlfaWQiLCJwcm9wZXJ0eVF1ZXJ5IiwicHJvcGVydHlSZXN1bHQiLCJwcm9wZXJ0eSIsInByb3BlcnR5X25hbWUiLCJob3RlbF90eXBlX25hbWUiLCJtYXJrZXRfbmFtZSIsInByb3BFcnJvciIsImVycm9yIiwiZW5oYW5jZUVycm9yIiwic3RhdHVzIiwianNvbiIsInRvdGFsIiwicGFyc2VJbnQiLCJjb3VudCIsImRldGFpbHMiLCJtZXNzYWdlIiwicmVxdWVzdEJvZHkiLCJib2R5IiwiY3JlYXRlVGFibGVRdWVyeSIsInByb3BlcnR5SWQiLCJ1bmRlZmluZWQiLCJwcm9wZXJ0eV9rZXkiLCJkYXRhVG9JbnNlcnQiLCJkZWFsX25hbWUiLCJpbnZlc3RtZW50X2Ftb3VudCIsImV4cGVjdGVkX3JldHVybiIsInN0YXJ0X2RhdGUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzcGxpdCIsImVuZF9kYXRlIiwic2V0RnVsbFllYXIiLCJnZXRGdWxsWWVhciIsImNvbHVtbnMiLCJ2YWx1ZXMiLCJwbGFjZWhvbGRlcnMiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsImtleSIsInB1c2giLCJpbnNlcnRRdWVyeSIsImpvaW4iLCJyZXN1bHQiLCJzZXRIZWFkZXIiLCJlbmQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/deals/index.js\n");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeals&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cdeals%5Cindex.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();